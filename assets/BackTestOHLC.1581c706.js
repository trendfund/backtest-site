var Tr=Object.defineProperty,Mr=Object.defineProperties;var Or=Object.getOwnPropertyDescriptors;var Ni=Object.getOwnPropertySymbols;var Dr=Object.prototype.hasOwnProperty,Lr=Object.prototype.propertyIsEnumerable;var Yi=(Q,K,z)=>K in Q?Tr(Q,K,{enumerable:!0,configurable:!0,writable:!0,value:z}):Q[K]=z,Wi=(Q,K)=>{for(var z in K||(K={}))Dr.call(K,z)&&Yi(Q,z,K[z]);if(Ni)for(var z of Ni(K))Lr.call(K,z)&&Yi(Q,z,K[z]);return Q},Xi=(Q,K)=>Mr(Q,Or(K));import{f7 as Rr,fj as Br,r as Fr,o as zr,a as Gi,e as Vr,b as Ui,c as Zi,w as Ki,f as jr,u as Hr,fw as Nr,fx as Yr,fn as Wr,fp as Xr}from"./index.61d617e2.js";import{c as Gr,o as Ur}from"./index.d0dbf300.js";var qi={exports:{}},Re={exports:{}};/**
 * @license
 * KLineChart v8.3.6
 * Copyright (c) 2019 lihu.
 * Licensed under Apache License 2.0 https://www.apache.org/licenses/LICENSE-2.0
 */(function(Q,K){(function(z,Et){Et(K)})(Rr,function(z){var Et={name:"BBI",shortName:"BBI",series:"price",precision:2,calcParams:[3,6,12,24],shouldCheckParamCount:!0,shouldOhlc:!0,plots:[{key:"bbi",title:"BBI: ",type:"line"}],calcTechnicalIndicator:function(r,t){var i=t.params,e=Math.max.apply(null,i),n=[],a=[];return r.map(function(o,c){var s={},h=o.close;if(i.forEach(function(u,f){n[f]=(n[f]||0)+h,u-1>c||(a[f]=n[f]/u,n[f]-=r[c-(u-1)].close)}),c>=e-1){var l=0;a.forEach(function(u){l+=u}),s.bbi=l/4}return s})}},xt={name:"DMA",shortName:"DMA",calcParams:[10,50,10],plots:[{key:"dma",title:"DMA: ",type:"line"},{key:"ama",title:"AMA: ",type:"line"}],calcTechnicalIndicator:function(r,t){var i=t.params,e=Math.max(i[0],i[1]),n=0,a=0,o=0,c=[];return r.forEach(function(s,h){var l,u,f={},d=s.close;if(n+=d,a+=d,i[0]-1>h||(l=n/i[0],n-=r[h-(i[0]-1)].close),i[1]-1>h||(u=a/i[1],a-=r[h-(i[1]-1)].close),h>=e-1){var v=l-u;f.dma=v,o+=v,e+i[2]-2>h||(f.ama=o/i[2],o-=c[h-(i[2]-1)].dma)}c.push(f)}),c}},Yt={name:"DMI",shortName:"DMI",calcParams:[14,6],plots:[{key:"pdi",title:"PDI: ",type:"line"},{key:"mdi",title:"MDI: ",type:"line"},{key:"adx",title:"ADX: ",type:"line"},{key:"adxr",title:"ADXR: ",type:"line"}],calcTechnicalIndicator:function(r,t){var i=t.params,e=0,n=0,a=0,o=0,c=0,s=0,h=0,l=0,u=[];return r.forEach(function(f,d){var v={},p=r[d-1]||f,_=p.close,m=f.high,y=f.low,g=m-y,k=Math.abs(m-_),P=Math.abs(_-y),M=m-p.high,R=p.low-y,X=Math.max(Math.max(g,k),P),mt=M>0&&M>R?M:0,nt=R>0&&R>M?R:0;if(e+=X,n+=mt,a+=nt,d>=i[0]-1){d>i[0]-1?(o=o-o/i[0]+X,c=c-c/i[0]+mt,s=s-s/i[0]+nt):(o=e,c=n,s=a);var Z=0,H=0;o!==0&&(Z=100*c/o,H=100*s/o),v.pdi=Z,v.mdi=H;var $=0;H+Z!==0&&($=Math.abs(H-Z)/(H+Z)*100),h+=$,2*i[0]-2>d||(v.adx=l=d>2*i[0]-2?(l*(i[0]-1)+$)/i[0]:h/i[0],2*i[0]+i[1]-3>d||(v.adxr=(u[d-(i[1]-1)].adx+l)/2))}u.push(v)}),u}},Lt={name:"MACD",shortName:"MACD",calcParams:[12,26,9],plots:[{key:"dif",title:"DIF: ",type:"line"},{key:"dea",title:"DEA: ",type:"line"},{key:"macd",title:"MACD: ",type:"bar",baseValue:0,color:function(r,t){var i=(r.current.technicalIndicatorData||{}).macd;return i>0?t.bar.upColor:0>i?t.bar.downColor:t.bar.noChangeColor},isStroke:function(r){return(r.current.technicalIndicatorData||{}).macd>(r.prev.technicalIndicatorData||{}).macd}}],calcTechnicalIndicator:function(r,t){var i,e,n=t.params,a=0,o=0,c=0,s=0,h=Math.max(n[0],n[1]);return r.map(function(l,u){var f={},d=l.close;return a+=d,n[0]-1>u||(i=u>n[0]-1?(2*d+(n[0]-1)*i)/(n[0]+1):a/n[0]),n[1]-1>u||(e=u>n[1]-1?(2*d+(n[1]-1)*e)/(n[1]+1):a/n[1]),h-1>u||(f.dif=o=i-e,c+=o,h+n[2]-2>u||(f.macd=2*(o-(s=u>h+n[2]-2?(2*o+s*(n[2]-1))/(n[2]+1):c/n[2])),f.dea=s)),f})}},Pt={name:"CR",shortName:"CR",calcParams:[26,10,20,40,60],plots:[{key:"cr",title:"CR: ",type:"line"},{key:"ma1",title:"MA1: ",type:"line"},{key:"ma2",title:"MA2: ",type:"line"},{key:"ma3",title:"MA3: ",type:"line"},{key:"ma4",title:"MA4: ",type:"line"}],calcTechnicalIndicator:function(r,t){var i=t.params,e=Math.ceil(i[1]/2.5+1),n=Math.ceil(i[2]/2.5+1),a=Math.ceil(i[3]/2.5+1),o=Math.ceil(i[4]/2.5+1),c=0,s=[],h=0,l=[],u=0,f=[],d=0,v=[],p=[];return r.forEach(function(_,m){var y={},g=r[m-1]||_,k=(g.high+g.close+g.low+g.open)/4,P=Math.max(0,_.high-k),M=Math.max(0,k-_.low);i[0]-1>m||(y.cr=M!==0?P/M*100:0,c+=y.cr,h+=y.cr,u+=y.cr,d+=y.cr,i[0]+i[1]-2>m||(s.push(c/i[1]),i[0]+i[1]+e-3>m||(y.ma1=s[s.length-1-e]),c-=p[m-(i[1]-1)].cr),i[0]+i[2]-2>m||(l.push(h/i[2]),i[0]+i[2]+n-3>m||(y.ma2=l[l.length-1-n]),h-=p[m-(i[2]-1)].cr),i[0]+i[3]-2>m||(f.push(u/i[3]),i[0]+i[3]+a-3>m||(y.ma3=f[f.length-1-a]),u-=p[m-(i[3]-1)].cr),i[0]+i[4]-2>m||(v.push(d/i[4]),i[0]+i[4]+o-3>m||(y.ma4=v[v.length-1-o]),d-=p[m-(i[4]-1)].cr)),p.push(y)}),p}},Be={name:"AO",shortName:"AO",calcParams:[5,34],shouldCheckParamCount:!0,plots:[{key:"ao",title:"AO: ",type:"bar",baseValue:0,color:function(r,t){return(r.current.technicalIndicatorData||{}).ao>(r.prev.technicalIndicatorData||{}).ao?t.bar.upColor:t.bar.downColor},isStroke:function(r){return(r.current.technicalIndicatorData||{}).ao>(r.prev.technicalIndicatorData||{}).ao}}],calcTechnicalIndicator:function(r,t){var i=t.params,e=Math.max(i[0],i[1]),n=0,a=0,o=0,c=0;return r.map(function(s,h){var l={},u=(s.low+s.high)/2;if(n+=u,a+=u,h>=i[0]-1){o=n/i[0];var f=r[h-(i[0]-1)];n-=(f.low+f.high)/2}if(h>=i[1]-1){c=a/i[1];var d=r[h-(i[1]-1)];a-=(d.low+d.high)/2}return e-1>h||(l.ao=o-c),l})}},he={name:"CCI",shortName:"CCI",calcParams:[20],plots:[{key:"cci",title:"CCI: ",type:"line"}],calcTechnicalIndicator:function(r,t){var i=t.params,e=i[0]-1,n=0,a=[];return r.map(function(o,c){var s={},h=(o.high+o.low+o.close)/3;if(n+=h,a.push(h),c>=e){var l=n/i[0],u=a.slice(c-e,c+1),f=0;u.forEach(function(v){f+=Math.abs(v-l)});var d=f/i[0];s.cci=d!==0?(h-l)/d/.015:0,n-=(r[c-e].high+r[c-e].low+r[c-e].close)/3}return s})}},le={name:"RSI",shortName:"RSI",calcParams:[6,12,24],shouldCheckParamCount:!1,plots:[{key:"rsi1",title:"RSI1: ",type:"line"},{key:"rsi2",title:"RSI2: ",type:"line"},{key:"rsi3",title:"RSI3: ",type:"line"}],regeneratePlots:function(r){return r.map(function(t,i){var e=i+1;return{key:"rsi".concat(e),title:"RSI".concat(e,": "),type:"line"}})},calcTechnicalIndicator:function(r,t){var i=t.params,e=t.plots,n=[],a=[];return r.map(function(o,c){var s={},h=o.close-(r[c-1]||o).close;return i.forEach(function(l,u){if(h>0?n[u]=(n[u]||0)+h:a[u]=(a[u]||0)+Math.abs(h),c>=l-1){s[e[u].key]=a[u]!==0?100-100/(1+n[u]/a[u]):0;var f=r[c-(l-1)],d=f.close-(r[c-l]||f).close;d>0?n[u]-=d:a[u]-=Math.abs(d)}}),s})}};function tt(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=Number.MIN_SAFE_INTEGER,i=Number.MAX_SAFE_INTEGER;return r.forEach(function(e){t=Math.max(e.high,t),i=Math.min(e.low,i)}),{hn:t,ln:i}}var yt={name:"KDJ",shortName:"KDJ",calcParams:[9,3,3],plots:[{key:"k",title:"K: ",type:"line"},{key:"d",title:"D: ",type:"line"},{key:"j",title:"J: ",type:"line"}],calcTechnicalIndicator:function(r,t){var i=t.params,e=[];return r.forEach(function(n,a){var o={},c=n.close;if(a>=i[0]-1){var s=tt(r.slice(a-(i[0]-1),a+1)),h=s.ln,l=s.hn-h;o.k=((i[1]-1)*(e[a-1].k||50)+(c-h)/(l===0?1:l)*100)/i[1],o.d=((i[2]-1)*(e[a-1].d||50)+o.k)/i[2],o.j=3*o.k-2*o.d}e.push(o)}),e}},$i={name:"WR",shortName:"WR",calcParams:[6,10,14],shouldCheckParamCount:!1,plots:[{key:"wr1",title:"WR1: ",type:"line"},{key:"wr2",title:"WR2: ",type:"line"},{key:"wr3",title:"WR3: ",type:"line"}],regeneratePlots:function(r){return r.map(function(t,i){return{key:"wr".concat(i+1),title:"WR".concat(i+1,": "),type:"line"}})},calcTechnicalIndicator:function(r,t){var i=t.params,e=t.plots;return r.map(function(n,a){var o={},c=n.close;return i.forEach(function(s,h){var l=s-1;if(a>=l){var u=tt(r.slice(a-l,a+1)),f=u.hn,d=f-u.ln;o[e[h].key]=d===0?0:(c-f)/d*100}}),o})}},Ji={name:"BOLL",shortName:"BOLL",calcParams:[20,{value:2,allowDecimal:!0}],precision:2,shouldOhlc:!0,plots:[{key:"up",title:"UP: ",type:"line"},{key:"mid",title:"MID: ",type:"line"},{key:"dn",title:"DN: ",type:"line"}],calcTechnicalIndicator:function(r,t){var i=t.params,e=i[0]-1,n=0;return r.map(function(a,o){var c={};if(n+=a.close,o>=e){c.mid=n/i[0];var s=function(h,l){var u=h.length,f=0;h.forEach(function(p){var _=p.close-l;f+=_*_});var d=f>0,v=Math.sqrt((f=Math.abs(f))/u);return d?v:-1*v}(r.slice(o-e,o+1),c.mid);c.up=c.mid+i[1]*s,c.dn=c.mid-i[1]*s,n-=r[o-e].close}return c})}},Qi={name:"SAR",shortName:"SAR",series:"price",calcParams:[2,2,20],precision:2,shouldOhlc:!0,plots:[{key:"sar",title:"SAR: ",type:"circle",color:function(r,t){var i=r.current,e=i.kLineData||{};return(e.high+e.low)/2>(i.technicalIndicatorData||{}).sar?t.circle.upColor:t.circle.downColor}}],calcTechnicalIndicator:function(r,t){var i=t.params,e=i[0]/100,n=i[1]/100,a=i[2]/100,o=e,c=-100,s=!1,h=0;return r.map(function(l,u){var f=h,d=l.high,v=l.low;if(s){(c===-100||d>c)&&(c=d,o=Math.min(o+n,a)),h=f+o*(c-f);var p=Math.min(r[Math.max(1,u)-1].low,v);h>l.low?(h=c,o=e,c=-100,s=!s):h>p&&(h=p)}else{(c===-100||c>v)&&(c=v,o=Math.min(o+n,a)),h=f+o*(c-f);var _=Math.max(r[Math.max(1,u)-1].high,d);l.high>h?(h=c,o=0,c=-100,s=!s):_>h&&(h=_)}return{sar:h}})}},Wt={technicalIndicatorExtensions:{},shapeExtensions:{},addTechnicalIndicatorTemplate:function(r){var t=this;r&&[].concat(r).forEach(function(i){i.name&&(t.technicalIndicatorExtensions[i.name]=i)})},addShapeTemplate:function(r){var t=this;r&&[].concat(r).forEach(function(i){i.name&&(t.shapeExtensions[i.name]=i)})}};function A(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function Fe(r,t){for(var i=0;t.length>i;i++){var e=t[i];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(r,e.key,e)}}function I(r,t,i){return t&&Fe(r.prototype,t),i&&Fe(r,i),Object.defineProperty(r,"prototype",{writable:!1}),r}function $t(r){return $t=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},$t(r)}function Rt(r,t){if(L(r)&&L(t)){for(var i in t)if(Object.prototype.hasOwnProperty.call(t,i)&&i in r){var e=r[i],n=t[i];L(n)&&L(e)&&!V(n)&&!V(e)?Rt(e,n):E(t[i])&&(r[i]=t[i])}}}function dt(r){if(!L(r))return r;var t;for(var i in t=V(r)?[]:{},r)if(Object.prototype.hasOwnProperty.call(r,i)){var e=r[i];t[i]=L(e)?dt(e):e}return t}function V(r){return Object.prototype.toString.call(r)==="[object Array]"}function W(r){return r&&typeof r=="function"}function L(r){return!!r&&$t(r)==="object"}function O(r){return typeof r=="number"&&!isNaN(r)}function E(r){return r!=null}function _t(r){return typeof r=="boolean"}function Xt(r){return typeof r=="string"}var ue="stroke",Jt="fill",et="dash",fe="solid",Bt="left",ze="right",Ve="normal",Ct="percentage",Ft="log",je="candle_solid",tn="candle_stroke",en="candle_up_stroke",nn="candle_down_stroke",rn="ohlc",He="area",de="always",an="follow_cross",Ne="rect",Qt="standard",Ye="circle",We="rect",Xe="triangle",ve="diamond",Ge="custom",Ue="point",pe="top",Ze="bottom",on={grid:{show:!0,horizontal:{show:!0,size:1,color:"#EDEDED",style:et,dashValue:[2,2]},vertical:{show:!0,size:1,color:"#EDEDED",style:et,dashValue:[2,2]}},candle:{margin:{top:.2,bottom:.1},type:je,bar:{upColor:"#26A69A",downColor:"#EF5350",noChangeColor:"#999999"},area:{lineSize:2,lineColor:"#2196F3",value:"close",backgroundColor:[{offset:0,color:"rgba(33, 150, 243, 0.01)"},{offset:1,color:"rgba(33, 150, 243, 0.2)"}]},priceMark:{show:!0,high:{show:!0,color:"#76808F",textMargin:5,textSize:10,textFamily:"Helvetica Neue",textWeight:"normal"},low:{show:!0,color:"#76808F",textMargin:5,textSize:10,textFamily:"Helvetica Neue",textWeight:"normal"},last:{show:!0,upColor:"#26A69A",downColor:"#EF5350",noChangeColor:"#888888",line:{show:!0,style:et,dashValue:[4,4],size:1},text:{show:!0,size:12,paddingLeft:2,paddingTop:2,paddingRight:2,paddingBottom:2,color:"#FFFFFF",family:"Helvetica Neue",weight:"normal",borderRadius:2}}},tooltip:{showRule:de,showType:Qt,labels:["\u65F6\u95F4: ","\u5F00: ","\u6536: ","\u9AD8: ","\u4F4E: ","\u6210\u4EA4\u91CF: "],values:null,defaultValue:"n/a",rect:{paddingLeft:0,paddingRight:0,paddingTop:0,paddingBottom:6,offsetLeft:8,offsetTop:8,offsetRight:8,borderRadius:4,borderSize:1,borderColor:"#F2F3F5",backgroundColor:"#FEFEFE"},text:{size:12,family:"Helvetica Neue",weight:"normal",color:"#76808F",marginLeft:8,marginTop:6,marginRight:8,marginBottom:0}}},technicalIndicator:{margin:{top:.2,bottom:.1},bar:{upColor:"rgba(38, 166, 154, .65)",downColor:"rgba(239, 83, 80, .65)",noChangeColor:"#888888"},line:{size:1,colors:["#FF9600","#9D65C9","#2196F3","#E11D74","#01C5C4"]},circle:{upColor:"rgba(38, 166, 154, .65)",downColor:"rgba(239, 83, 80, .65)",noChangeColor:"#888888"},lastValueMark:{show:!1,text:{show:!1,color:"#FFFFFF",size:12,family:"Helvetica Neue",weight:"normal",paddingLeft:3,paddingTop:2,paddingRight:3,paddingBottom:2,borderRadius:2}},tooltip:{showRule:de,showType:Qt,showName:!0,showParams:!0,defaultValue:"n/a",text:{size:12,family:"Helvetica Neue",weight:"normal",color:"#76808F",marginTop:6,marginRight:8,marginBottom:0,marginLeft:8}}},xAxis:{show:!0,height:null,axisLine:{show:!0,color:"#DDDDDD",size:1},tickText:{show:!0,color:"#76808F",size:12,family:"Helvetica Neue",weight:"normal",paddingTop:3,paddingBottom:6},tickLine:{show:!0,size:1,length:3,color:"#DDDDDD"}},yAxis:{show:!0,width:null,type:Ve,position:ze,inside:!1,axisLine:{show:!0,color:"#DDDDDD",size:1},tickText:{show:!0,color:"#76808F",size:12,family:"Helvetica Neue",weight:"normal",paddingLeft:3,paddingRight:6},tickLine:{show:!0,size:1,length:3,color:"#DDDDDD"}},separator:{size:1,color:"#DDDDDD",fill:!0,activeBackgroundColor:"rgba(33, 150, 243, 0.08)"},crosshair:{show:!0,horizontal:{show:!0,line:{show:!0,style:et,dashValue:[4,2],size:1,color:"#76808F"},text:{show:!0,color:"#FFFFFF",size:12,family:"Helvetica Neue",weight:"normal",paddingLeft:2,paddingRight:2,paddingTop:2,paddingBottom:2,borderSize:1,borderColor:"#686D76",borderRadius:2,backgroundColor:"#686D76"}},vertical:{show:!0,line:{show:!0,style:et,dashValue:[4,2],size:1,color:"#76808F"},text:{show:!0,color:"#FFFFFF",size:12,family:"Helvetica Neue",weight:"normal",paddingLeft:2,paddingRight:2,paddingTop:2,paddingBottom:2,borderSize:1,borderRadius:2,borderColor:"#686D76",backgroundColor:"#686D76"}}},shape:{point:{backgroundColor:"#2196F3",borderColor:"rgba(33, 150, 243, 0.35)",borderSize:1,radius:5,activeBackgroundColor:"#2196F3",activeBorderColor:"rgba(33, 150, 243, 0.35)",activeBorderSize:3,activeRadius:5},line:{style:fe,color:"#2196F3",size:1,dashValue:[2,2]},polygon:{style:ue,stroke:{style:fe,size:1,color:"#2196F3",dashValue:[2,2]},fill:{color:"#2196F3"}},arc:{style:ue,stroke:{style:fe,size:1,color:"#2196F3",dashValue:[2,2]},fill:{color:"#2196F3"}},text:{style:Jt,color:"#2196F3",size:12,family:"Helvetica Neue",weight:"normal",offset:[0,0]}},annotation:{position:pe,offset:[20,0],symbol:{type:ve,size:8,color:"#2196F3",activeSize:10,activeColor:"#FF9600"}},tag:{position:Ue,offset:0,line:{show:!0,style:et,dashValue:[4,2],size:1,color:"#2196F3"},text:{color:"#FFFFFF",backgroundColor:"#2196F3",size:12,family:"Helvetica Neue",weight:"normal",paddingLeft:2,paddingRight:2,paddingTop:2,paddingBottom:2,borderRadius:2,borderSize:1,borderColor:"#2196F3"},mark:{offset:0,color:"#FFFFFF",backgroundColor:"#2196F3",size:12,family:"Helvetica Neue",weight:"normal",paddingLeft:2,paddingRight:2,paddingTop:2,paddingBottom:2,borderRadius:2,borderSize:1,borderColor:"#2196F3"}}};function vt(r,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"--";if(L(r)){var e=r[t];if(E(e))return e}return i}function at(r,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"MM-DD hh:mm";if(O(t)){var e=r.format(new Date(t)),n=e.split(", "),a=n[0].split("/"),o={YYYY:a[2],MM:a[0],DD:a[1],"hh:mm":n[1].match(/^[\d]{2}/)[0]==="24"?n[1].replace(/^[\d]{2}/,"00"):n[1]};return i.replace(/YYYY|MM|DD|(hh:mm)/g,function(c){return o[c]})}return"--"}function pt(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2,i=+r;return(i||i===0)&&O(i)?i.toFixed(t):"".concat(i)}function At(r){return O(+r)?r>1e9?"".concat(+(r/1e9).toFixed(3),"B"):r>1e6?"".concat(+(r/1e6).toFixed(3),"M"):r>1e3?"".concat(+(r/1e3).toFixed(3),"K"):r:"--"}function _e(r,t){return t==null&&(t=10),+(r=(+r).toFixed(t=Math.min(Math.max(0,t),20)))}function Gt(r){return Math.log(r)/Math.log(10)}function It(r){return Math.pow(10,r)}var St={ZOOM:"zoom",SCROLL:"scroll",CROSSHAIR:"crosshair",TOOLTIP:"tooltip",PANE_DRAG:"pane_drag"};function Ke(r){return Object.values(St).indexOf(r)>-1}var sn=function(){function r(t){A(this,r),this._chartStore=t,this._dateTimeFormat=new Intl.DateTimeFormat("en",{hour12:!1,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),this._zoomEnabled=!0,this._scrollEnabled=!0,this._loading=!0,this._loadMoreCallback=null,this._more=!0,this._totalDataSpace=0,this._dataSpace=6,this._barSpace=this._calcBarSpace(),this._offsetRightSpace=50,this._offsetRightBarCount=this._offsetRightSpace/this._dataSpace,this._leftMinVisibleBarCount=2,this._rightMinVisibleBarCount=2,this._from=0,this._to=0,this._preOffsetRightBarCount=0}return I(r,[{key:"_calcBarSpace",value:function(){return Math.max(1,Math.min(Math.floor(.82*this._dataSpace),Math.floor(this._dataSpace)-1))}},{key:"adjustFromTo",value:function(){var t=this._chartStore.dataList().length,i=this._totalDataSpace/this._dataSpace,e=i-Math.min(this._leftMinVisibleBarCount,t);this._offsetRightBarCount>e&&(this._offsetRightBarCount=e);var n=-t+Math.min(this._rightMinVisibleBarCount,t);n>this._offsetRightBarCount&&(this._offsetRightBarCount=n),this._to=Math.round(this._offsetRightBarCount+t+.5),this._from=Math.round(this._to-i)-1,this._to>t&&(this._to=t),0>this._from&&(this._from=0),this._chartStore.adjustVisibleDataList(),this._from===0&&this._more&&!this._loading&&W(this._loadMoreCallback)&&(this._loading=!0,this._loadMoreCallback(vt(this._chartStore.dataList()[0],"timestamp")))}},{key:"setMore",value:function(t){this._more=t}},{key:"setLoading",value:function(t){this._loading=t}},{key:"dateTimeFormat",value:function(){return this._dateTimeFormat}},{key:"setTimezone",value:function(t){var i;try{i=new Intl.DateTimeFormat("en",{hour12:!1,timeZone:t,year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"})}catch{}i&&(this._dateTimeFormat=i)}},{key:"timezone",value:function(){return this._dateTimeFormat.resolvedOptions().timeZone}},{key:"dataSpace",value:function(){return this._dataSpace}},{key:"barSpace",value:function(){return this._barSpace}},{key:"halfBarSpace",value:function(){return this._barSpace/2}},{key:"setDataSpace",value:function(t,i){1>t||t>50||this._dataSpace===t||(this._dataSpace=t,this._barSpace=this._calcBarSpace(),i&&i(),this.adjustFromTo(),this._chartStore.crosshairStore().recalculate(!0),this._chartStore.invalidate())}},{key:"setTotalDataSpace",value:function(t){this._totalDataSpace!==t&&(this._totalDataSpace=t,this.adjustFromTo(),this._chartStore.crosshairStore().recalculate(!0))}},{key:"setOffsetRightSpace",value:function(t,i){this._offsetRightSpace=t,this._offsetRightBarCount=t/this._dataSpace,i&&(this.adjustFromTo(),this._chartStore.crosshairStore().recalculate(!0),this._chartStore.invalidate())}},{key:"resetOffsetRightSpace",value:function(){this.setOffsetRightSpace(this._offsetRightSpace)}},{key:"offsetRightSpace",value:function(){return this._offsetRightSpace}},{key:"offsetRightBarCount",value:function(){return this._offsetRightBarCount}},{key:"setOffsetRightBarCount",value:function(t){this._offsetRightBarCount=t}},{key:"setLeftMinVisibleBarCount",value:function(t){this._leftMinVisibleBarCount=t}},{key:"setRightMinVisibleBarCount",value:function(t){this._rightMinVisibleBarCount=t}},{key:"from",value:function(){return this._from}},{key:"to",value:function(){return this._to}},{key:"startScroll",value:function(){this._preOffsetRightBarCount=this._offsetRightBarCount}},{key:"scroll",value:function(t,i){if(this._scrollEnabled){var e=t/this._dataSpace;this._chartStore.actionStore().execute(St.SCROLL,{barCount:e,distance:t}),this._offsetRightBarCount=this._preOffsetRightBarCount-e,this.adjustFromTo();var n=i||this._chartStore.crosshairStore().get();this._chartStore.crosshairStore().set(n,!0),this._chartStore.invalidate()}}},{key:"getDataByDataIndex",value:function(t){return this._chartStore.dataList()[t]}},{key:"coordinateToFloatIndex",value:function(t){var i=this._chartStore.dataList().length;return Math.round(1e6*(i+this._offsetRightBarCount-(this._totalDataSpace-t)/this._dataSpace))/1e6}},{key:"dataIndexToTimestamp",value:function(t){var i=this.getDataByDataIndex(t);if(i)return i.timestamp}},{key:"timestampToDataIndex",value:function(t){return this._chartStore.dataList().length===0?0:function(i,e,n){var a=0,o=0;for(o=i.length-1;a!==o;){var c=Math.floor((o+a)/2),s=o-a,h=i[c][e];if(n===i[a][e])return a;if(n===i[o][e])return o;if(n===h)return c;if(n>h?a=c:o=c,2>=s)break}return a}(this._chartStore.dataList(),"timestamp",t)}},{key:"dataIndexToCoordinate",value:function(t){var i=this._chartStore.dataList().length;return this._totalDataSpace-(i+this._offsetRightBarCount-t-.5)*this._dataSpace}},{key:"coordinateToDataIndex",value:function(t){return Math.ceil(this.coordinateToFloatIndex(t))-1}},{key:"zoom",value:function(t,i){var e=this;if(this._zoomEnabled){if(!i||!E(i.x)){var n=this._chartStore.crosshairStore().get();i={x:E(n.x)?n.x:this._totalDataSpace/2}}this._chartStore.actionStore().execute(St.ZOOM,{coordinate:i,scale:t});var a=this.coordinateToFloatIndex(i.x);this.setDataSpace(this._dataSpace+t*(this._dataSpace/10),function(){e._offsetRightBarCount+=a-e.coordinateToFloatIndex(i.x)})}}},{key:"setZoomEnabled",value:function(t){this._zoomEnabled=t}},{key:"zoomEnabled",value:function(){return this._zoomEnabled}},{key:"setScrollEnabled",value:function(t){this._scrollEnabled=t}},{key:"scrollEnabled",value:function(){return this._scrollEnabled}},{key:"setLoadMoreCallback",value:function(t){this._loadMoreCallback=t}},{key:"clear",value:function(){this._more=!0,this._loading=!0,this._from=0,this._to=0}}]),r}();function me(r,t){return me=Object.setPrototypeOf||function(i,e){return i.__proto__=e,i},me(r,t)}function B(r,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),t&&me(r,t)}function F(r,t){if(t&&($t(t)==="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return function(i){if(i===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return i}(r)}function w(r){return w=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)},w(r)}function qe(r,t,i,e,n,a,o){try{var c=r[a](o),s=c.value}catch(h){return void i(h)}c.done?t(s):Promise.resolve(s).then(e,n)}var $e={exports:{}};(function(r){var t=function(i){var e,n=Object.prototype,a=n.hasOwnProperty,o=typeof Symbol=="function"?Symbol:{},c=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",h=o.toStringTag||"@@toStringTag";function l(S,x,C){return Object.defineProperty(S,x,{value:C,enumerable:!0,configurable:!0,writable:!0}),S[x]}try{l({},"")}catch{l=function(x,C,T){return x[C]=T}}function u(S,x,C,T){var b=Object.create((x&&x.prototype instanceof y?x:y).prototype),N=new G(T||[]);return b._invoke=function(Y,ot,D){var J=d;return function(U,j){if(J===p)throw Error("Generator is already running");if(J===_){if(U==="throw")throw j;return qt()}for(D.method=U,D.arg=j;;){var ft=D.delegate;if(ft){var st=Z(ft,D);if(st){if(st===m)continue;return st}}if(D.method==="next")D.sent=D._sent=D.arg;else if(D.method==="throw"){if(J===d)throw J=_,D.arg;D.dispatchException(D.arg)}else D.method==="return"&&D.abrupt("return",D.arg);J=p;var rt=f(Y,ot,D);if(rt.type==="normal"){if(J=D.done?_:v,rt.arg===m)continue;return{value:rt.arg,done:D.done}}rt.type==="throw"&&(J=_,D.method="throw",D.arg=rt.arg)}}}(S,C,N),b}function f(S,x,C){try{return{type:"normal",arg:S.call(x,C)}}catch(T){return{type:"throw",arg:T}}}i.wrap=u;var d="suspendedStart",v="suspendedYield",p="executing",_="completed",m={};function y(){}function g(){}function k(){}var P={};l(P,c,function(){return this});var M=Object.getPrototypeOf,R=M&&M(M(bt([])));R&&R!==n&&a.call(R,c)&&(P=R);var X=k.prototype=y.prototype=Object.create(P);function mt(S){["next","throw","return"].forEach(function(x){l(S,x,function(C){return this._invoke(x,C)})})}function nt(S,x){function C(b,N,Y,ot){var D=f(S[b],S,N);if(D.type!=="throw"){var J=D.arg,U=J.value;return U&&typeof U=="object"&&a.call(U,"__await")?x.resolve(U.__await).then(function(j){C("next",j,Y,ot)},function(j){C("throw",j,Y,ot)}):x.resolve(U).then(function(j){J.value=j,Y(J)},function(j){return C("throw",j,Y,ot)})}ot(D.arg)}var T;this._invoke=function(b,N){function Y(){return new x(function(ot,D){C(b,N,ot,D)})}return T=T?T.then(Y,Y):Y()}}function Z(S,x){var C=S.iterator[x.method];if(C===e){if(x.delegate=null,x.method==="throw"){if(S.iterator.return&&(x.method="return",x.arg=e,Z(S,x),x.method==="throw"))return m;x.method="throw",x.arg=new TypeError("The iterator does not provide a 'throw' method")}return m}var T=f(C,S.iterator,x.arg);if(T.type==="throw")return x.method="throw",x.arg=T.arg,x.delegate=null,m;var b=T.arg;return b?b.done?(x[S.resultName]=b.value,x.next=S.nextLoc,x.method!=="return"&&(x.method="next",x.arg=e),x.delegate=null,m):b:(x.method="throw",x.arg=new TypeError("iterator result is not an object"),x.delegate=null,m)}function H(S){var x={tryLoc:S[0]};1 in S&&(x.catchLoc=S[1]),2 in S&&(x.finallyLoc=S[2],x.afterLoc=S[3]),this.tryEntries.push(x)}function $(S){var x=S.completion||{};x.type="normal",delete x.arg,S.completion=x}function G(S){this.tryEntries=[{tryLoc:"root"}],S.forEach(H,this),this.reset(!0)}function bt(S){if(S){var x=S[c];if(x)return x.call(S);if(typeof S.next=="function")return S;if(!isNaN(S.length)){var C=-1,T=function b(){for(;++C<S.length;)if(a.call(S,C))return b.value=S[C],b.done=!1,b;return b.value=e,b.done=!0,b};return T.next=T}}return{next:qt}}function qt(){return{value:e,done:!0}}return g.prototype=k,l(X,"constructor",k),l(k,"constructor",g),g.displayName=l(k,h,"GeneratorFunction"),i.isGeneratorFunction=function(S){var x=typeof S=="function"&&S.constructor;return!!x&&(x===g||(x.displayName||x.name)==="GeneratorFunction")},i.mark=function(S){return Object.setPrototypeOf?Object.setPrototypeOf(S,k):(S.__proto__=k,l(S,h,"GeneratorFunction")),S.prototype=Object.create(X),S},i.awrap=function(S){return{__await:S}},mt(nt.prototype),l(nt.prototype,s,function(){return this}),i.AsyncIterator=nt,i.async=function(S,x,C,T,b){b===void 0&&(b=Promise);var N=new nt(u(S,x,C,T),b);return i.isGeneratorFunction(x)?N:N.next().then(function(Y){return Y.done?Y.value:N.next()})},mt(X),l(X,h,"Generator"),l(X,c,function(){return this}),l(X,"toString",function(){return"[object Generator]"}),i.keys=function(S){var x=[];for(var C in S)x.push(C);return x.reverse(),function T(){for(;x.length;){var b=x.pop();if(b in S)return T.value=b,T.done=!1,T}return T.done=!0,T}},i.values=bt,G.prototype={constructor:G,reset:function(S){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach($),!S)for(var x in this)x.charAt(0)==="t"&&a.call(this,x)&&!isNaN(+x.slice(1))&&(this[x]=e)},stop:function(){this.done=!0;var S=this.tryEntries[0].completion;if(S.type==="throw")throw S.arg;return this.rval},dispatchException:function(S){if(this.done)throw S;var x=this;function C(D,J){return N.type="throw",N.arg=S,x.next=D,J&&(x.method="next",x.arg=e),!!J}for(var T=this.tryEntries.length-1;T>=0;--T){var b=this.tryEntries[T],N=b.completion;if(b.tryLoc==="root")return C("end");if(this.prev>=b.tryLoc){var Y=a.call(b,"catchLoc"),ot=a.call(b,"finallyLoc");if(Y&&ot){if(b.catchLoc>this.prev)return C(b.catchLoc,!0);if(b.finallyLoc>this.prev)return C(b.finallyLoc)}else if(Y){if(b.catchLoc>this.prev)return C(b.catchLoc,!0)}else{if(!ot)throw Error("try statement without catch or finally");if(b.finallyLoc>this.prev)return C(b.finallyLoc)}}}},abrupt:function(S,x){for(var C=this.tryEntries.length-1;C>=0;--C){var T=this.tryEntries[C];if(this.prev>=T.tryLoc&&a.call(T,"finallyLoc")&&T.finallyLoc>this.prev){var b=T;break}}!b||S!=="break"&&S!=="continue"||b.tryLoc>x||x>b.finallyLoc||(b=null);var N=b?b.completion:{};return N.type=S,N.arg=x,b?(this.method="next",this.next=b.finallyLoc,m):this.complete(N)},complete:function(S,x){if(S.type==="throw")throw S.arg;return S.type==="break"||S.type==="continue"?this.next=S.arg:S.type==="return"?(this.rval=this.arg=S.arg,this.method="return",this.next="end"):S.type==="normal"&&x&&(this.next=x),m},finish:function(S){for(var x=this.tryEntries.length-1;x>=0;--x){var C=this.tryEntries[x];if(C.finallyLoc===S)return this.complete(C.completion,C.afterLoc),$(C),m}},catch:function(S){for(var x=this.tryEntries.length-1;x>=0;--x){var C=this.tryEntries[x];if(C.tryLoc===S){var T=C.completion;if(T.type==="throw"){var b=T.arg;$(C)}return b}}throw Error("illegal catch attempt")},delegateYield:function(S,x,C){return this.delegate={iterator:bt(S),resultName:x,nextLoc:C},this.method==="next"&&(this.arg=e),m}},i}(r.exports);try{regeneratorRuntime=t}catch{typeof globalThis=="object"?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}})($e);var Je=$e.exports,ye="line",ge="bar",xe="circle",te={PRICE:"price",VOLUME:"volume",NORMAL:"normal"};function ee(r,t,i,e,n,a){var o=a.color,c=a.isStroke,s={prev:{kLineData:r[i-1],technicalIndicatorData:t[i-1]},current:{kLineData:r[i],technicalIndicatorData:t[i]},next:{kLineData:r[i+1],technicalIndicatorData:t[i+1]}};return E(e.color)&&(o=W(e.color)?e.color(s,n)||a.color:e.color||a.color),E(e.isStroke)&&(c=W(e.isStroke)?e.isStroke(s):e.isStroke),{color:o,isStroke:c}}var cn=function(){function r(e){var n=e.name,a=e.shortName,o=e.series,c=e.calcParams,s=e.plots,h=e.precision,l=e.shouldCheckParamCount,u=e.shouldOhlc,f=e.shouldFormatBigNumber,d=e.minValue,v=e.maxValue,p=e.styles;A(this,r),this.name=n||"",this.shortName=E(a)?a:n,this.series=Object.values(te).indexOf(o)!==-1?o:te.NORMAL,this.precision=O(h)&&h>=0?h:4,this._precisionFlag=!1,this.calcParams=V(c)?c:[],this.plots=V(s)?s:[],this.shouldCheckParamCount=!_t(l)||l,this.shouldOhlc=!!_t(u)&&u,this.shouldFormatBigNumber=!!_t(f)&&f,this.minValue=d,this.maxValue=v,this.styles=p,this.result=[]}var t,i;return I(r,[{key:"_createParams",value:function(e){return e.map(function(n){return L(n)?n.value:n})}},{key:"setShortName",value:function(e){return!(!E(e)||this.shortName===e)&&(this.shortName=e,!0)}},{key:"setPrecision",value:function(e,n){return!(!O(e)||0>e||n&&(!n||this._precisionFlag))&&(this.precision=parseInt(e,10),n||(this._precisionFlag=!0),!0)}},{key:"setCalcParams",value:function(e){if(!V(e)||this.shouldCheckParamCount&&e.length!==this.calcParams.length)return!1;for(var n=[],a=0;e.length>a;a++){var o=e[a],c=void 0,s=void 0;L(o)?(c=o.value,s=o.allowDecimal):(c=o,s=!1);var h=this.calcParams[a];if(L(h)&&_t(h.allowDecimal)&&(s=h.allowDecimal),!O(c)||!s&&parseInt(c,10)!==c)return!1;n.push({allowDecimal:s,value:c})}this.calcParams=n;var l=this.regeneratePlots(this._createParams(n));return l&&V(l)&&(this.plots=l),!0}},{key:"setShouldOhlc",value:function(e){return!(!_t(e)||this.shouldOhlc===e)&&(this.shouldOhlc=e,!0)}},{key:"setShouldFormatBigNumber",value:function(e){return!(!_t(e)||this.shouldFormatBigNumber===e)&&(this.shouldFormatBigNumber=e,!0)}},{key:"setStyles",value:function(e,n){return!!L(e)&&(this.styles||(this.styles={margin:dt(n.margin),bar:dt(n.bar),line:dt(n.line),circle:dt(n.circle)}),Rt(this.styles,e),!0)}},{key:"calc",value:(t=Je.mark(function e(n){return Je.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,this.calcTechnicalIndicator(n,{params:this._createParams(this.calcParams),plots:this.plots});case 2:if(a.t0=a.sent,a.t0){a.next=5;break}a.t0=[];case 5:this.result=a.t0;case 6:case"end":return a.stop()}},e,this)}),i=function(){var e=this,n=arguments;return new Promise(function(a,o){var c=t.apply(e,n);function s(l){qe(c,a,o,s,h,"next",l)}function h(l){qe(c,a,o,s,h,"throw",l)}s(void 0)})},function(e){return i.apply(this,arguments)})},{key:"calcTechnicalIndicator",value:function(e,n){}},{key:"regeneratePlots",value:function(e){}}]),r}();function hn(r,t){var i=typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(!i){if(Array.isArray(r)||(i=function(s,h){if(!!s){if(typeof s=="string")return Qe(s,h);var l=Object.prototype.toString.call(s).slice(8,-1);if(l==="Object"&&s.constructor&&(l=s.constructor.name),l==="Map"||l==="Set")return Array.from(s);if(l==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(l))return Qe(s,h)}}(r))||t&&r&&typeof r.length=="number"){i&&(r=i);var e=0,n=function(){};return{s:n,n:function(){return r.length>e?{done:!1,value:r[e++]}:{done:!0}},e:function(s){throw s},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a,o=!0,c=!1;return{s:function(){i=i.call(r)},n:function(){var s=i.next();return o=s.done,s},e:function(s){c=!0,a=s},f:function(){try{o||i.return==null||i.return()}finally{if(c)throw a}}}}function Qe(r,t){(t==null||t>r.length)&&(t=r.length);for(var i=0,e=Array(t);t>i;i++)e[i]=r[i];return e}function ln(r){var t=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var i,e=w(r);if(t){var n=w(this).constructor;i=Reflect.construct(e,arguments,n)}else i=e.apply(this,arguments);return F(this,i)}}var un=function(){function r(t){A(this,r),this._chartStore=t,this._templates=this._createTemplates(),this._instances=new Map}return I(r,[{key:"_createTechInfo",value:function(t){return{name:t.name,shortName:t.shortName,series:t.series,calcParams:t.calcParams,shouldCheckParamCount:t.shouldCheckParamCount,shouldOhlc:t.shouldOhlc,shouldFormatBigNumber:t.shouldFormatBigNumber,precision:t.precision,styles:t.styles,plots:t.plots,result:t.result||[]}}},{key:"_createTemplates",value:function(){var t={},i=Wt.technicalIndicatorExtensions;for(var e in i){var n=this._createTemplateInstance(i[e]);n&&(t[e]=n)}return t}},{key:"_createTemplateInstance",value:function(t){var i=t.name,e=t.shortName,n=t.series,a=t.calcParams,o=t.plots,c=t.precision,s=t.shouldCheckParamCount,h=t.shouldOhlc,l=t.shouldFormatBigNumber,u=t.minValue,f=t.maxValue,d=t.styles,v=t.calcTechnicalIndicator,p=t.regeneratePlots,_=t.createToolTipDataSource,m=t.render;if(!i||!W(v))return null;var y=function(g){B(P,g);var k=ln(P);function P(){return A(this,P),k.call(this,{name:i,shortName:e,series:n,calcParams:a,plots:o,precision:c,shouldCheckParamCount:s,shouldOhlc:h,shouldFormatBigNumber:l,minValue:u,maxValue:f,styles:d})}return I(P)}(cn);return y.prototype.calcTechnicalIndicator=v,W(p)&&(y.prototype.regeneratePlots=p),W(_)&&(y.prototype.createToolTipDataSource=_),W(m)&&(y.prototype.render=m),new y}},{key:"addTemplate",value:function(t){var i=this;t.forEach(function(e){var n=i._createTemplateInstance(e||{});n&&(i._templates[n.name]=n)})}},{key:"hasTemplate",value:function(t){return!!this._templates[t]}},{key:"getTemplateInfo",value:function(t){if(!E(t)){var i={};for(var e in this._templates)i[e]=this._createTechInfo(this._templates[e]);return i}var n=this._templates[t];return n?this._createTechInfo(n):{}}},{key:"addInstance",value:function(t,i,e){var n=i.name,a=i.calcParams,o=i.precision,c=i.shouldOhlc,s=i.shouldFormatBigNumber,h=i.styles,l=this._instances.get(t);if(!l||!l.has(n)){l||(l=new Map,this._instances.set(t,l));var u=this._templates[n],f=Object.create(Object.getPrototypeOf(u));for(var d in u)Object.prototype.hasOwnProperty.call(u,d)&&(f[d]=u[d]);return f.setCalcParams(a),f.setPrecision(o),f.setShouldOhlc(c),f.setShouldFormatBigNumber(s),f.setStyles(h,this._chartStore.styleOptions().technicalIndicator),e||l.clear(),l.set(n,f),f.calc(this._chartStore.dataList())}}},{key:"instances",value:function(t){return this._instances.get(t)||new Map}},{key:"removeInstance",value:function(t,i){var e=!1;if(this._instances.has(t)){var n=this._instances.get(t);E(i)?n.has(i)&&(n.delete(i),e=!0):(n.clear(),e=!0),n.size===0&&this._instances.delete(t)}return e}},{key:"hasInstance",value:function(t){return this._instances.has(t)}},{key:"calcInstance",value:function(t,i){var e=this,n=[];if(E(t))if(E(i)){var a=this._instances.get(i);a&&a.has(t)&&n.push(a.get(t).calc(this._chartStore.dataList()))}else this._instances.forEach(function(o){o.has(t)&&n.push(o.get(t).calc(e._chartStore.dataList()))});else this._instances.forEach(function(o){o.forEach(function(c){n.push(c.calc(e._chartStore.dataList()))})});return Promise.all(n)}},{key:"getInstanceInfo",value:function(t,i){var e=this,n=function(o){var c,s=[],h=hn(o);try{for(h.s();!(c=h.n()).done;){var l=c.value[1];if(l){var u=e._createTechInfo(l);if(l.name===i)return u;s.push(u)}}}catch(f){h.e(f)}finally{h.f()}return s};if(!E(t)){var a={};return this._instances.forEach(function(o,c){a[c]=n(o)}),a}return this._instances.has(t)?n(this._instances.get(t)):{}}},{key:"setSeriesPrecision",value:function(t,i){var e=function(a){a.series===te.PRICE&&a.setPrecision(t,!0),a.series===te.VOLUME&&a.setPrecision(i,!0)};for(var n in this._templates)e(this._templates[n]);this._instances.forEach(function(a){a.forEach(function(o){e(o)})})}},{key:"override",value:function(t,i){var e=this,n=t.name,a=t.shortName,o=t.calcParams,c=t.precision,s=t.shouldOhlc,h=t.shouldFormatBigNumber,l=t.styles,u=this._chartStore.styleOptions().technicalIndicator,f=new Map;if(E(i))this._instances.has(i)&&f.set(i,this._instances.get(i));else{f=this._instances;var d=this._templates[n];d&&(d.setCalcParams(o),d.setShortName(a),d.setPrecision(c),d.setShouldOhlc(s),d.setShouldFormatBigNumber(h),d.setStyles(l,u))}var v=!1,p=[];if(f.forEach(function(_){if(_.has(n)){var m=_.get(n),y=m.setShortName(a),g=m.setCalcParams(o),k=m.setPrecision(c),P=m.setShouldOhlc(s),M=m.setShouldFormatBigNumber(h),R=m.setStyles(l,u);(y||g||k||P||M||R)&&(v=!0),g&&p.push(m.calc(e._chartStore.dataList()))}}),v)return Promise.all(p)}}]),r}();function Tt(r,t,i){return t in r?Object.defineProperty(r,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):r[t]=i,r}function ti(r,t){t.forEach(function(i){var e=i.key,n=i.fn;W(n)&&(r[e]=n)})}var Se=function(){function r(t){var i=t.id,e=t.chartStore,n=t.xAxis,a=t.yAxis;A(this,r),this._id=i,this._chartStore=e,this._xAxis=n,this._yAxis=a,this._styles=null}return I(r,[{key:"draw",value:function(t){}},{key:"setStyles",value:function(t,i){return!!L(t)&&(this._styles||(this._styles=dt(i)),Rt(this._styles,t),!0)}},{key:"id",value:function(){return this._id}},{key:"styles",value:function(){return this._styles}},{key:"setYAxis",value:function(t){t&&(this._yAxis=t)}},{key:"checkEventCoordinateOn",value:function(t){}},{key:"onClick",value:function(t){}},{key:"onRightClick",value:function(t){}},{key:"onMouseEnter",value:function(t){}},{key:"onMouseLeave",value:function(t){}}]),r}();function ke(r,t,i,e){r.fillStyle=t,r.beginPath(),r.arc(i.x,i.y,e,0,2*Math.PI),r.closePath(),r.fill()}function ie(r,t,i){var e=Math.abs(t.x-r.x),n=Math.abs(t.y-r.y),a=Math.abs(i.x-r.x);return Math.abs(e*Math.abs(i.y-r.y)-a*n)/2}function we(r,t){var i=r.x-t.x;if(i!==0){var e=(r.y-t.y)/i;return{k:e,b:r.y-e*r.x}}}function ne(r,t,i){return ei(we(r,t),i)}function ei(r,t){return r?t.x*r.k+r.b:t.y}function kt(r,t,i){if(!i||!r||!t)return!1;if(r.x===t.x)return 2>Math.abs(i.x-r.x);var e=we(r,t),n=ei(e,i),a=Math.abs(n-i.y);return 4>a*a/(e.k*e.k+1)}function re(r,t,i){return!!kt(r,t,i)&&(r.x===t.x?t.y>r.y?2>r.y-i.y:2>i.y-r.y:t.x>r.x?2>r.x-i.x:2>i.x-r.x)}function be(r,t,i){return!!kt(r,t,i)&&(r.x===t.x?4>Math.abs(r.y-i.y)+Math.abs(t.y-i.y)-Math.abs(r.y-t.y):4>Math.abs(r.x-i.x)+Math.abs(t.x-i.x)-Math.abs(r.x-t.x))}function ii(r,t,i){if(!i)return!1;var e=i.x-r.x,n=i.y-r.y;return!(e*e+n*n>t*t)}function ni(r,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:0,e=[];if(r.length>1)if(r[0].x===r[1].x){var n=0,a=t.y;if(e.push([{x:r[0].x,y:n},{x:r[0].x,y:a}]),r.length>2){e.push([{x:r[2].x,y:n},{x:r[2].x,y:a}]);for(var o=r[0].x-r[2].x,c=0;i>c;c++){var s=o*(c+1);e.push([{x:r[0].x+s,y:n},{x:r[0].x+s,y:a}])}}}else{var h=0,l=t.x,u=we(r[0],r[1]),f=u.k,d=u.b;if(e.push([{x:h,y:h*f+d},{x:l,y:l*f+d}]),r.length>2){var v=r[2].y-f*r[2].x;e.push([{x:h,y:h*f+v},{x:l,y:l*f+v}]);for(var p=d-v,_=0;i>_;_++){var m=d+p*(_+1);e.push([{x:h,y:h*f+m},{x:l,y:l*f+m}])}}}return e}function Ee(r,t,i){r.save(),r.lineWidth%2&&r.translate(.5,.5),r.beginPath();var e=!0;t.forEach(function(n){n&&(e?(r.moveTo(n.x,n.y),e=!1):r.lineTo(n.x,n.y))}),i(),r.restore()}function fn(r,t){Ee(r,t,function(){r.closePath(),r.stroke()})}function ri(r,t){Ee(r,t,function(){r.closePath(),r.fill()})}function Mt(r,t,i,e){r.beginPath();var n=r.lineWidth%2?.5:0;r.moveTo(i,t+n),r.lineTo(e,t+n),r.stroke(),r.closePath()}function Ut(r,t,i,e){r.beginPath();var n=r.lineWidth%2?.5:0;r.moveTo(t+n,i),r.lineTo(t+n,e),r.stroke(),r.closePath()}function zt(r,t){Ee(r,t,function(){r.stroke(),r.closePath()})}function Vt(r){return r.ownerDocument&&r.ownerDocument.defaultView&&r.ownerDocument.defaultView.devicePixelRatio||2}function ct(r,t){return Math.round(r.measureText(t).width)}function q(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:12,t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"normal",i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"Helvetica Neue";return"".concat(t," ").concat(r,"px ").concat(i)}function Ot(r,t,i){r.font=q(i.size,i.weight,i.family);var e=ct(r,t);return i.paddingLeft+i.paddingRight+e+2*(i.borderSize||0)}function ae(r){return r.paddingTop+r.paddingBottom+r.size+2*(r.borderSize||0)}function dn(r,t){var i=typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(!i){if(Array.isArray(r)||(i=function(s,h){if(!!s){if(typeof s=="string")return ai(s,h);var l=Object.prototype.toString.call(s).slice(8,-1);if(l==="Object"&&s.constructor&&(l=s.constructor.name),l==="Map"||l==="Set")return Array.from(s);if(l==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(l))return ai(s,h)}}(r))||t&&r&&typeof r.length=="number"){i&&(r=i);var e=0,n=function(){};return{s:n,n:function(){return r.length>e?{done:!1,value:r[e++]}:{done:!0}},e:function(s){throw s},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a,o=!0,c=!1;return{s:function(){i=i.call(r)},n:function(){var s=i.next();return o=s.done,s},e:function(s){c=!0,a=s},f:function(){try{o||i.return==null||i.return()}finally{if(c)throw a}}}}function ai(r,t){(t==null||t>r.length)&&(t=r.length);for(var i=0,e=Array(t);t>i;i++)e[i]=r[i];return e}function vn(r){var t=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var i,e=w(r);if(t){var n=w(this).constructor;i=Reflect.construct(e,arguments,n)}else i=e.apply(this,arguments);return F(this,i)}}var oi="other",gt="point",wt="none",pn="line",_n="text",mn="continuous_line",yn="polygon",gn="arc",si=0,ci=1,hi=2,Zt={NORMAL:"normal",WEAK_MAGNET:"weak_magnet",STRONG_MAGNET:"strong_magnet"},xn=function(r){B(i,r);var t=vn(i);function i(e){var n,a=e.id,o=e.name,c=e.totalStep,s=e.chartStore,h=e.xAxis,l=e.yAxis,u=e.points,f=e.styles,d=e.lock,v=e.mode,p=e.data;return A(this,i),(n=t.call(this,{id:a,chartStore:s,xAxis:h,yAxis:l}))._name=o,n._totalStep=c,n._lock=d,n._mode=Zt.NORMAL,n.setMode(v),n._data=p,n._drawStep=1,n._points=[],n.setPoints(u),n.setStyles(f,s.styleOptions().shape),n._prevPressPoint=null,n._prevPoints=null,n._coordinates=[],n}return I(i,[{key:"setPoints",value:function(e){if(V(e)&&e.length>0){var n;this._totalStep-1>e.length?(this._drawStep=e.length+1,this._points=dt(e),n=e.length):(this._drawStep=-1,this._points=e.slice(0,this._totalStep-1),n=this._totalStep-1);for(var a=0;n>a;a++)this.performEventMoveForDrawing({step:a+2,mode:this._mode,points:this._points,movePoint:this._points[a],xAxis:this._xAxis,yAxis:this._yAxis});this._drawStep===-1&&this.performEventPressedMove({mode:this._mode,points:this._points,pressPointIndex:this._points.length-1,pressPoint:this._points[this._points.length-1],xAxis:this._xAxis,yAxis:this._yAxis})}}},{key:"_timestampOrDataIndexToCoordinateX",value:function(e){var n=e.timestamp,a=e.dataIndex;return n&&(a=this._chartStore.timeScaleStore().timestampToDataIndex(n)),this._xAxis.convertToPixel(a)}},{key:"_drawLines",value:function(e,n,a,o){e.save(),e.strokeStyle=a.color||o.color,e.lineWidth=a.size||o.size,a.style===et&&e.setLineDash(a.dashValue||o.dashValue),n.forEach(function(c){var s,h;if(c.length>1)switch((s=c[0]).x===(h=c[1]).x?hi:s.y===h.y?ci:si){case si:zt(e,c);break;case ci:Mt(e,c[0].y,c[0].x,c[1].x);break;case hi:Ut(e,c[0].x,c[0].y,c[1].y)}}),e.restore()}},{key:"_drawContinuousLines",value:function(e,n,a,o){e.save(),e.strokeStyle=a.color||o.color,e.lineWidth=a.size||o.size,a.style===et&&e.setLineDash(a.dashValue||o.dashValue),n.forEach(function(c){c.length>0&&zt(e,c)}),e.restore()}},{key:"_drawPolygons",value:function(e,n,a,o){var c;if(e.save(),a.style===Jt)e.fillStyle=(a.fill||o.fill).color,c=ri;else{var s=a.stroke||o.stroke;s.style===et&&e.setLineDash(s.dashValue),e.lineWidth=s.size,e.strokeStyle=s.color,c=fn}n.forEach(function(h){h.length>0&&c(e,h)}),e.restore()}},{key:"_drawArcs",value:function(e,n,a,o){if(e.save(),a.style===Jt)e.fillStyle=(a.fill||o.fill).color;else{var c=a.stroke||o.stroke;c.style===et&&e.setLineDash(c.dashValue),e.lineWidth=c.size,e.strokeStyle=c.color}n.forEach(function(s){var h=s.x,l=s.y,u=s.radius,f=s.startAngle,d=s.endAngle;e.beginPath(),e.arc(h,l,u,f,d),a.style===Jt?(e.closePath(),e.fill()):(e.stroke(),e.closePath())}),e.restore()}},{key:"_drawText",value:function(e,n,a,o){var c;e.save(),a.style===ue?(e.strokeStyle=a.color||o.color,c=e.strokeText):(e.fillStyle=a.color||o.color,c=e.fillText),e.font=q(a.size||o.size,a.family||o.family,a.weight||o.weight);var s=a.offset||o.offset||[0,0];n.forEach(function(h){c.call(e,h.text,h.x+s[1],h.y+s[0])}),e.restore()}},{key:"draw",value:function(e){var n=this;this._coordinates=this._points.map(function(h){var l=h.value;return{x:n._timestampOrDataIndexToCoordinateX({timestamp:h.timestamp,dataIndex:h.dataIndex}),y:n._yAxis.convertToPixel(l)}});var a=this._styles||this._chartStore.styleOptions().shape;if(this._drawStep!==1&&this._coordinates.length>0){var o={width:this._xAxis.width(),height:this._yAxis.height()},c={price:this._chartStore.pricePrecision(),volume:this._chartStore.volumePrecision()};this._shapeDataSources=this.createShapeDataSource({step:this._drawStep,mode:this._mode,points:this._points,coordinates:this._coordinates,viewport:{width:this._xAxis.width(),height:this._yAxis.height()},precision:{price:this._chartStore.pricePrecision(),volume:this._chartStore.volumePrecision()},styles:a,xAxis:this._xAxis,yAxis:this._yAxis,data:this._data})||[],this._shapeDataSources.forEach(function(h){var l=h.styles,u=h.dataSource,f=u===void 0?[]:u;if(h.isDraw)switch(h.type){case pn:n._drawLines(e,f,l||a.line,a.line);break;case mn:n._drawContinuousLines(e,f,l||a.line,a.line);break;case yn:n._drawPolygons(e,f,l||a.polygon,a.polygon);break;case gn:n._drawArcs(e,f,l||a.arc,a.arc);break;case _n:n._drawText(e,f,l||a.text,a.text)}}),this.drawExtend&&(e.save(),this.drawExtend({ctx:e,dataSource:this._shapeDataSources,styles:a,viewport:o,precision:c,mode:this._mode,xAxis:this._xAxis,yAxis:this._yAxis,data:this._data}),e.restore())}var s=this._chartStore.shapeStore().eventOperate();(s.hover.id===this._id&&s.hover.element!==wt||s.click.id===this._id&&s.click.element!==wt||this.isDrawing())&&this._coordinates.forEach(function(h,l){var u=h.x,f=h.y,d=a.point.radius,v=a.point.backgroundColor,p=a.point.borderColor,_=a.point.borderSize;s.hover.id===n._id&&s.hover.element===gt&&l===s.hover.elementIndex&&(d=a.point.activeRadius,v=a.point.activeBackgroundColor,p=a.point.activeBorderColor,_=a.point.activeBorderSize),ke(e,p,{x:u,y:f},d+_),ke(e,v,{x:u,y:f},d)})}},{key:"setLock",value:function(e){this._lock=e}},{key:"name",value:function(){return this._name}},{key:"lock",value:function(){return this._lock}},{key:"totalStep",value:function(){return this._totalStep}},{key:"mode",value:function(){return this._mode}},{key:"setMode",value:function(e){Object.values(Zt).indexOf(e)>-1&&(this._mode=e)}},{key:"setData",value:function(e){return e!==this._data&&(this._data=e,!0)}},{key:"data",value:function(){return this._data}},{key:"points",value:function(){return this._points}},{key:"isDrawing",value:function(){return this._drawStep!==-1}},{key:"isStart",value:function(){return this._drawStep===1}},{key:"checkEventCoordinateOn",value:function(e){for(var n=this._styles||this._chartStore.styleOptions().shape,a=this._coordinates.length-1;a>-1;a--)if(ii(this._coordinates[a],n.point.radius,e))return{id:this._id,element:gt,elementIndex:a,instance:this};if(this._shapeDataSources){var o,c=dn(this._shapeDataSources);try{for(c.s();!(o=c.n()).done;){var s=o.value,h=s.key,l=s.type,u=s.dataSource,f=u===void 0?[]:u;if(s.isCheck){for(var d=0;f.length>d;d++)if(this.checkEventCoordinateOnShape({key:h,type:l,dataSource:f[d],eventCoordinate:e}))return{id:this._id,element:oi,elementIndex:d,instance:this}}}}catch(v){c.e(v)}finally{c.f()}}}},{key:"_performValue",value:function(e,n,a){var o=this._yAxis.convertFromPixel(e);if(this._mode===Zt.NORMAL||a!=="candle_pane")return o;var c=this._chartStore.timeScaleStore().getDataByDataIndex(n);if(!c)return o;if(o>c.high){if(this._mode===Zt.WEAK_MAGNET){var s=this._yAxis.convertToPixel(c.high);return this._yAxis.convertFromPixel(s-8)>o?c.high:o}return c.high}if(c.low>o){if(this._mode===Zt.WEAK_MAGNET){var h=this._yAxis.convertToPixel(c.low);return o>this._yAxis.convertFromPixel(h-8)?c.low:o}return c.low}var l=Math.max(c.open,c.close);if(o>l)return c.high-o>o-l?l:c.high;var u=Math.min(c.open,c.close);return u>o?u-o>o-c.low?c.low:u:o-u>l-o?l:u}},{key:"mouseMoveForDrawing",value:function(e,n){var a=this._xAxis.convertFromPixel(e.x),o=this._chartStore.timeScaleStore().dataIndexToTimestamp(a),c=this._performValue(e.y,a,n.paneId);this._points[this._drawStep-1]={timestamp:o,value:c,dataIndex:a},this.performEventMoveForDrawing({step:this._drawStep,mode:this._mode,points:this._points,movePoint:{timestamp:o,value:c,dataIndex:a},xAxis:this._xAxis,yAxis:this._yAxis}),this.onDrawing({id:this._id,step:this._drawStep,points:this._points})}},{key:"mouseLeftButtonDownForDrawing",value:function(){this._drawStep===this._totalStep-1?(this._drawStep=-1,this._chartStore.shapeStore().progressInstanceComplete(),this.onDrawEnd({id:this._id,points:this._points})):this._drawStep++}},{key:"mousePressedPointMove",value:function(e,n){var a=this._chartStore.shapeStore().eventOperate(),o=a.click.elementIndex;if(!this._lock&&a.click.id===this._id&&a.click.element===gt&&o!==-1){var c=this._xAxis.convertFromPixel(e.x),s=this._chartStore.timeScaleStore().dataIndexToTimestamp(c),h=this._performValue(e.y,c,n.paneId);this._points[o].timestamp=s,this._points[o].dataIndex=c,this._points[o].value=h,this.performEventPressedMove({points:this._points,mode:this._mode,pressPointIndex:o,pressPoint:{dataIndex:c,timestamp:s,value:h},xAxis:this._xAxis,yAxis:this._yAxis}),this.onPressedMove({id:this._id,element:gt,points:this._points,event:n})}}},{key:"startPressedOtherMove",value:function(e){var n=this._xAxis.convertFromPixel(e.x),a=this._yAxis.convertFromPixel(e.y);this._prevPressPoint={dataIndex:n,value:a},this._prevPoints=dt(this._points)}},{key:"mousePressedOtherMove",value:function(e,n){var a=this;if(!this._lock&&this._prevPressPoint){var o=this._xAxis.convertFromPixel(e.x),c=this._yAxis.convertFromPixel(e.y),s=o-this._prevPressPoint.dataIndex,h=c-this._prevPressPoint.value;this._points=this._prevPoints.map(function(l){E(l.dataIndex)||(l.dataIndex=a._chartStore.timeScaleStore().timestampToDataIndex(l.timestamp));var u=l.dataIndex+s;return{dataIndex:u,value:l.value+h,timestamp:a._chartStore.timeScaleStore().dataIndexToTimestamp(u)}}),this.onPressedMove({id:this._id,element:oi,points:this._points,event:n})}}},{key:"onDrawStart",value:function(e){}},{key:"onDrawing",value:function(e){}},{key:"onDrawEnd",value:function(e){}},{key:"onPressedMove",value:function(e){}},{key:"onRemove",value:function(e){}},{key:"checkEventCoordinateOnShape",value:function(e){}},{key:"createShapeDataSource",value:function(e){}},{key:"performEventMoveForDrawing",value:function(e){}},{key:"performEventPressedMove",value:function(e){}}]),i}(Se),ht=1,Sn=2,Pe=3;function li(r,t){var i=Object.keys(r);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(r);t&&(e=e.filter(function(n){return Object.getOwnPropertyDescriptor(r,n).enumerable})),i.push.apply(i,e)}return i}function ui(r){for(var t=1;arguments.length>t;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?li(Object(i),!0).forEach(function(e){Tt(r,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):li(Object(i)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(i,e))})}return r}function fi(r,t){var i=typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(!i){if(Array.isArray(r)||(i=function(s,h){if(!!s){if(typeof s=="string")return di(s,h);var l=Object.prototype.toString.call(s).slice(8,-1);if(l==="Object"&&s.constructor&&(l=s.constructor.name),l==="Map"||l==="Set")return Array.from(s);if(l==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(l))return di(s,h)}}(r))||t&&r&&typeof r.length=="number"){i&&(r=i);var e=0,n=function(){};return{s:n,n:function(){return r.length>e?{done:!1,value:r[e++]}:{done:!0}},e:function(s){throw s},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a,o=!0,c=!1;return{s:function(){i=i.call(r)},n:function(){var s=i.next();return o=s.done,s},e:function(s){c=!0,a=s},f:function(){try{o||i.return==null||i.return()}finally{if(c)throw a}}}}function di(r,t){(t==null||t>r.length)&&(t=r.length);for(var i=0,e=Array(t);t>i;i++)e[i]=r[i];return e}function kn(r){var t=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var i,e=w(r);if(t){var n=w(this).constructor;i=Reflect.construct(e,arguments,n)}else i=e.apply(this,arguments);return F(this,i)}}var wn=function(){function r(t){A(this,r),this._chartStore=t,this._templates=this._createTemplates(),this._eventOperate={click:{id:"",element:wt,elementIndex:-1},hover:{id:"",element:wt,elementIndex:-1}},this._progressInstance=null,this._pressedInstance=null,this._instances=new Map}return I(r,[{key:"_createTemplates",value:function(){var t={},i=Wt.shapeExtensions;for(var e in i){var n=this._createTemplateClass(i[e]);n&&(t[e]=n)}return t}},{key:"_createTemplateClass",value:function(t){var i=t.name,e=t.totalStep,n=t.checkEventCoordinateOnShape,a=t.createShapeDataSource,o=t.performEventPressedMove,c=t.performEventMoveForDrawing,s=t.drawExtend;if(!(i&&O(e)&&W(n)&&W(a)))return null;var h=function(l){B(f,l);var u=kn(f);function f(d){var v=d.id,p=d.chartStore,_=d.xAxis,m=d.yAxis,y=d.points,g=d.styles,k=d.lock,P=d.mode,M=d.data;return A(this,f),u.call(this,{id:v,name:i,totalStep:e,chartStore:p,xAxis:_,yAxis:m,points:y,styles:g,lock:k,mode:P,data:M})}return I(f)}(xn);return h.prototype.checkEventCoordinateOnShape=n,h.prototype.createShapeDataSource=a,W(o)&&(h.prototype.performEventPressedMove=o),W(c)&&(h.prototype.performEventMoveForDrawing=c),W(s)&&(h.prototype.drawExtend=s),h}},{key:"addTemplate",value:function(t){var i=this;t.forEach(function(e){var n=i._createTemplateClass(e);n&&(i._templates[e.name]=n)})}},{key:"getTemplate",value:function(t){return this._templates[t]}},{key:"getInstance",value:function(t){var i,e=fi(this._instances);try{for(e.s();!(i=e.n()).done;){var n=(i.value[1]||[]).find(function(a){return a.id()===t});if(n)return n}}catch(a){e.e(a)}finally{e.f()}return null}},{key:"hasInstance",value:function(t){return!!this.getInstance(t)}},{key:"addInstance",value:function(t,i){t.isDrawing()?this._progressInstance={paneId:i,instance:t,fixed:E(i)}:(this._instances.has(i)||this._instances.set(i,[]),this._instances.get(i).push(t)),this._chartStore.invalidate(ht)}},{key:"progressInstance",value:function(){return this._progressInstance||{}}},{key:"progressInstanceComplete",value:function(){var t=this.progressInstance(),i=t.instance,e=t.paneId;i&&!i.isDrawing()&&(this._instances.has(e)||this._instances.set(e,[]),this._instances.get(e).push(i),this._progressInstance=null)}},{key:"updateProgressInstance",value:function(t,i){var e=this.progressInstance(),n=e.instance;n&&!e.fixed&&(n.setYAxis(t),this._progressInstance.paneId=i)}},{key:"pressedInstance",value:function(){return this._pressedInstance||{}}},{key:"updatePressedInstance",value:function(t,i,e){this._pressedInstance=t?{instance:t,paneId:i,element:e}:null}},{key:"instances",value:function(t){return this._instances.get(t)||[]}},{key:"setInstanceOptions",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},i=t.id,e=t.styles,n=t.lock,a=t.mode,o=t.data,c=this._chartStore.styleOptions().shape,s=!1;if(E(i)){var h=this.getInstance(i);h&&(h.setLock(n),h.setMode(a),(h.setStyles(e,c)||h.setData(o))&&(s=!0))}else this._instances.forEach(function(l){l.forEach(function(u){u.setLock(n),u.setMode(a),(u.setStyles(e,c)||u.setData(o))&&(s=!0)})});s&&this._chartStore.invalidate(ht)}},{key:"getInstanceInfo",value:function(t){var i=function(o){return{name:o.name(),id:o.id(),totalStep:o.totalStep(),lock:o.lock(),mode:o.mode(),points:o.points(),styles:o.styles(),data:o.data()}},e=this.progressInstance();if(!E(t)){var n={};return this._instances.forEach(function(o,c){n[c]=o.map(function(s){return i(s)}),e.paneId===c&&e.instance&&n[c].push(i(e.instance))}),n}if(e.instance&&e.instance.id()===t)return i(e.instance);var a=this.getInstance(t);return a?i(a):null}},{key:"removeInstance",value:function(t){var i=!1,e=this.progressInstance().instance;if(!e||E(t)&&e.id()!==t||(e.onRemove({id:e.id()}),this._progressInstance=null,i=!0),E(t)){var n,a=fi(this._instances);try{for(a.s();!(n=a.n()).done;){var o=n.value,c=o[1]||[],s=c.findIndex(function(h){return h.id()===t});if(s>-1){c[s].onRemove({id:c[s].id()}),c.splice(s,1),c.length===0&&this._instances.delete(o[0]),i=!0;break}}}catch(h){a.e(h)}finally{a.f()}}else this._instances.forEach(function(h){h.length>0&&h.forEach(function(l){l.onRemove({id:l.id()})})}),this._instances.clear(),i=!0;i&&this._chartStore.invalidate(ht)}},{key:"eventOperate",value:function(){return this._eventOperate}},{key:"setEventOperate",value:function(t){var i,e,n=this._eventOperate,a=n.hover,o=n.click;return!t.hover||a.id===t.hover.id&&a.element===t.hover.element&&a.elementIndex===t.hover.elementIndex||(this._eventOperate.hover=ui({},t.hover),i=!0),!t.click||o.id===t.click.id&&o.element===t.click.element&&o.elementIndex===t.click.elementIndex||(this._eventOperate.click=ui({},t.click),e=!0),i||e}},{key:"isEmpty",value:function(){return this._instances.size===0&&!this.progressInstance().instance}},{key:"isDrawing",value:function(){var t=this.progressInstance().instance;return t&&t.isDrawing()}},{key:"isPressed",value:function(){return!!this.pressedInstance().instance}}]),r}();function bn(r,t){var i=typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(!i){if(Array.isArray(r)||(i=function(s,h){if(!!s){if(typeof s=="string")return vi(s,h);var l=Object.prototype.toString.call(s).slice(8,-1);if(l==="Object"&&s.constructor&&(l=s.constructor.name),l==="Map"||l==="Set")return Array.from(s);if(l==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(l))return vi(s,h)}}(r))||t&&r&&typeof r.length=="number"){i&&(r=i);var e=0,n=function(){};return{s:n,n:function(){return r.length>e?{done:!1,value:r[e++]}:{done:!0}},e:function(s){throw s},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a,o=!0,c=!1;return{s:function(){i=i.call(r)},n:function(){var s=i.next();return o=s.done,s},e:function(s){c=!0,a=s},f:function(){try{o||i.return==null||i.return()}finally{if(c)throw a}}}}function vi(r,t){(t==null||t>r.length)&&(t=r.length);for(var i=0,e=Array(t);t>i;i++)e[i]=r[i];return e}function pi(r,t){var i=Object.keys(r);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(r);t&&(e=e.filter(function(n){return Object.getOwnPropertyDescriptor(r,n).enumerable})),i.push.apply(i,e)}return i}var En=function(){function r(t){A(this,r),this._chartStore=t,this._annotations=new Map,this._visibleAnnotations=new Map,this._eventOperate={id:""}}return I(r,[{key:"eventOperate",value:function(){return this._eventOperate}},{key:"setEventOperate",value:function(t){t&&this._eventOperate.id!==t.id&&(this._eventOperate=function(i){for(var e=1;arguments.length>e;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?pi(Object(n),!0).forEach(function(a){Tt(i,a,n[a])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):pi(Object(n)).forEach(function(a){Object.defineProperty(i,a,Object.getOwnPropertyDescriptor(n,a))})}return i}({},t))}},{key:"createVisibleAnnotations",value:function(){var t=this;this._visibleAnnotations.clear(),this._annotations.size>0&&this._chartStore.visibleDataList().forEach(function(i){var e=i.data,n=i.x;t._annotations.forEach(function(a,o){if(a.size>0){var c=a.get(e.timestamp)||[];if(c.length>0){var s,h=bn(c);try{for(h.s();!(s=h.n()).done;){var l=s.value;l.createSymbolCoordinate(n),t._visibleAnnotations.has(o)?t._visibleAnnotations.get(o).push(l):t._visibleAnnotations.set(o,[l])}}catch(u){h.e(u)}finally{h.f()}}}})})}},{key:"add",value:function(t,i){var e=this;this._annotations.has(i)||this._annotations.set(i,new Map),t.forEach(function(n){var a=e._annotations.get(i);a.has(n.id())?a.get(n.id()).push(n):a.set(n.id(),[n])}),this.createVisibleAnnotations(),this._chartStore.invalidate(ht)}},{key:"get",value:function(t){return this._visibleAnnotations.get(t)}},{key:"remove",value:function(t,i){var e=!1;if(E(t)){if(this._annotations.has(t))if(E(i)){var n=this._annotations.get(t);[].concat(i).forEach(function(a){var o=a.timestamp;n.has(o)&&(e=!0,n.delete(o))}),n.size===0&&this._annotations.delete(t),e&&this.createVisibleAnnotations()}else e=!0,this._annotations.delete(t),this._visibleAnnotations.delete(t)}else e=!0,this._annotations.clear(),this._visibleAnnotations.clear();e&&this._chartStore.invalidate(ht)}},{key:"isEmpty",value:function(){return this._visibleAnnotations.size===0}}]),r}(),Pn=function(){function r(t){A(this,r),this._chartStore=t,this._tags=new Map}return I(r,[{key:"_getById",value:function(t,i){var e=this.get(i);return e?e.get(t):null}},{key:"has",value:function(t,i){return!!this._getById(t,i)}},{key:"update",value:function(t,i,e){var n=this._getById(t,i);return!!n&&n.update(e)}},{key:"get",value:function(t){return this._tags.get(t)}},{key:"add",value:function(t,i){this._tags.has(i)||this._tags.set(i,new Map);var e=this._tags.get(i);t.forEach(function(n){e.set(n.id(),n)}),this._chartStore.invalidate(ht)}},{key:"remove",value:function(t,i){var e=!1;if(E(t)){if(this._tags.has(t))if(E(i)){var n=this._tags.get(t);[].concat(i).forEach(function(a){n.has(a)&&(e=!0,n.delete(a))}),n.size===0&&this._tags.delete(t)}else e=!0,this._tags.delete(t)}else e=!0,this._tags.clear();e&&this._chartStore.invalidate(ht)}}]),r}();function _i(r,t){var i=Object.keys(r);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(r);t&&(e=e.filter(function(n){return Object.getOwnPropertyDescriptor(r,n).enumerable})),i.push.apply(i,e)}return i}function mi(r){for(var t=1;arguments.length>t;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?_i(Object(i),!0).forEach(function(e){Tt(r,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):_i(Object(i)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(i,e))})}return r}var Cn=function(){function r(t){A(this,r),this._chartStore=t,this._crosshair={}}return I(r,[{key:"set",value:function(t,i){var e,n,a=this._chartStore.dataList(),o=t||{},c=a[n=E(o.x)?0>(e=this._chartStore.timeScaleStore().coordinateToDataIndex(o.x))?0:e>a.length-1?a.length-1:e:e=a.length-1],s=this._chartStore.timeScaleStore().dataIndexToCoordinate(e),h=this._crosshair.x,l=this._crosshair.y,u=this._crosshair.paneId;this._crosshair=mi(mi({},o),{},{realX:s,kLineData:c,realDataIndex:e,dataIndex:n}),c&&this._chartStore.crosshairChange(this._crosshair),h===o.x&&l===o.y&&u===o.paneId||i||this._chartStore.invalidate(ht)}},{key:"recalculate",value:function(t){this.set(this._crosshair,t)}},{key:"get",value:function(){return this._crosshair}}]),r}(),An=function(){function r(){A(this,r),this._observers=[]}return I(r,[{key:"subscribe",value:function(t){0>this._observers.indexOf(t)&&this._observers.push(t)}},{key:"unsubscribe",value:function(t){var i=this._observers.indexOf(t);i>-1?this._observers.splice(i,1):this._observers=[]}},{key:"execute",value:function(t){this._observers.forEach(function(i){i(t)})}},{key:"hasObservers",value:function(){return this._observers.length>0}}]),r}(),In=function(){function r(){A(this,r),this._delegates=new Map}return I(r,[{key:"execute",value:function(t,i){this.has(t)&&this._delegates.get(t).execute(i)}},{key:"has",value:function(t){return this._delegates.has(t)&&this._delegates.get(t).hasObservers()}},{key:"subscribe",value:function(t,i){return!!Ke(t)&&(this._delegates.has(t)||this._delegates.set(t,new An),this._delegates.get(t).subscribe(i),!0)}},{key:"unsubscribe",value:function(t,i){if(Ke(t)){var e=this._delegates.get(t);return e.unsubscribe(i),e.hasObservers()||this._delegates.delete(t),!0}return!1}}]),r}(),Tn=function(){function r(t,i){A(this,r),this._handler=i,this._styleOptions=dt(on),Rt(this._styleOptions,t),this._pricePrecision=2,this._volumePrecision=0,this._dataList=[],this._visibleDataList=[],this._dragPaneFlag=!1,this._timeScaleStore=new sn(this),this._technicalIndicatorStore=new un(this),this._shapeStore=new wn(this),this._annotationStore=new En(this),this._tagStore=new Pn(this),this._crosshairStore=new Cn(this),this._actionStore=new In}return I(r,[{key:"adjustVisibleDataList",value:function(){this._visibleDataList=[];for(var t=this._timeScaleStore.from(),i=this._timeScaleStore.to(),e=t;i>e;e++){var n=this._dataList[e],a=this._timeScaleStore.dataIndexToCoordinate(e);this._visibleDataList.push({index:e,x:a,data:n})}this._annotationStore.createVisibleAnnotations()}},{key:"styleOptions",value:function(){return this._styleOptions}},{key:"applyStyleOptions",value:function(t){Rt(this._styleOptions,t)}},{key:"pricePrecision",value:function(){return this._pricePrecision}},{key:"volumePrecision",value:function(){return this._volumePrecision}},{key:"setPriceVolumePrecision",value:function(t,i){this._pricePrecision=t,this._volumePrecision=i,this._technicalIndicatorStore.setSeriesPrecision(t,i)}},{key:"dataList",value:function(){return this._dataList}},{key:"visibleDataList",value:function(){return this._visibleDataList}},{key:"addData",value:function(t,i,e){if(L(t)){if(V(t)){this._timeScaleStore.setLoading(!1),this._timeScaleStore.setMore(!_t(e)||e);var n=this._dataList.length===0;this._dataList=t.concat(this._dataList),n&&this._timeScaleStore.resetOffsetRightSpace(),this._timeScaleStore.adjustFromTo()}else if(i<this._dataList.length)this._dataList[i]=t,this.adjustVisibleDataList();else{this._dataList.push(t);var a=this._timeScaleStore.offsetRightBarCount();0>a&&this._timeScaleStore.setOffsetRightBarCount(--a),this._timeScaleStore.adjustFromTo()}this._crosshairStore.recalculate(!0)}}},{key:"clearDataList",value:function(){this._dataList=[],this._visibleDataList=[],this._timeScaleStore.clear()}},{key:"timeScaleStore",value:function(){return this._timeScaleStore}},{key:"technicalIndicatorStore",value:function(){return this._technicalIndicatorStore}},{key:"shapeStore",value:function(){return this._shapeStore}},{key:"annotationStore",value:function(){return this._annotationStore}},{key:"tagStore",value:function(){return this._tagStore}},{key:"crosshairStore",value:function(){return this._crosshairStore}},{key:"actionStore",value:function(){return this._actionStore}},{key:"invalidate",value:function(t){this._handler.invalidate(t)}},{key:"crosshairChange",value:function(t){this._handler.crosshair(t)}},{key:"dragPaneFlag",value:function(){return this._dragPaneFlag}},{key:"setDragPaneFlag",value:function(t){this._dragPaneFlag=t}}]),r}();function Mn(r,t){for(;!Object.prototype.hasOwnProperty.call(r,t)&&(r=w(r))!==null;);return r}function jt(){return jt=typeof Reflect!="undefined"&&Reflect.get?Reflect.get:function(r,t,i){var e=Mn(r,t);if(e){var n=Object.getOwnPropertyDescriptor(e,t);return n.get?n.get.call(3>arguments.length?r:i):n.value}},jt.apply(this,arguments)}function lt(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=document.createElement(r);for(var e in t)Object.prototype.hasOwnProperty.call(t,e)&&(i.style[e]=t[e]);return i}var yi=function(){function r(t){A(this,r),this._height=-1,this._container=t.container,this._chartStore=t.chartStore,this._initBefore(t),this._initElement(),this._mainWidget=this._createMainWidget(this._element,t),this._yAxisWidget=this._createYAxisWidget(this._element,t)}return I(r,[{key:"_initBefore",value:function(t){}},{key:"_initElement",value:function(){this._element=lt("div",{width:"100%",margin:"0",padding:"0",position:"relative",overflow:"hidden",boxSizing:"border-box"});var t=this._container.lastChild;t?this._container.insertBefore(this._element,t):this._container.appendChild(this._element)}},{key:"_createMainWidget",value:function(t,i){}},{key:"_createYAxisWidget",value:function(t,i){}},{key:"width",value:function(){return this._element.offsetWidth}},{key:"setWidth",value:function(t,i){this._mainWidget.setWidth(t),this._yAxisWidget&&this._yAxisWidget.setWidth(i)}},{key:"height",value:function(){return this._height}},{key:"setHeight",value:function(t){this._height=t,this._mainWidget.setHeight(t),this._yAxisWidget&&this._yAxisWidget.setHeight(t)}},{key:"setOffsetLeft",value:function(t,i){this._mainWidget.setOffsetLeft(t),this._yAxisWidget&&this._yAxisWidget.setOffsetLeft(i)}},{key:"layout",value:function(){this._element.offsetHeight!==this._height&&(this._element.style.height="".concat(this._height,"px")),this._mainWidget.layout(),this._yAxisWidget&&this._yAxisWidget.layout()}},{key:"invalidate",value:function(t){this._yAxisWidget&&this._yAxisWidget.invalidate(t),this._mainWidget.invalidate(t)}},{key:"createHtml",value:function(t){var i=t.id,e=t.content,n=t.style;return t.position==="yAxis"?this._yAxisWidget&&this._yAxisWidget.createHtml({id:i,content:e,style:n}):this._mainWidget.createHtml({id:i,content:e,style:n})}},{key:"removeHtml",value:function(t){this._yAxisWidget&&this._yAxisWidget.removeHtml(t),this._mainWidget.removeHtml(t)}},{key:"getImage",value:function(t){var i=this._element.offsetWidth,e=this._element.offsetHeight,n=lt("canvas",{width:"".concat(i,"px"),height:"".concat(e,"px"),boxSizing:"border-box"}),a=n.getContext("2d"),o=Vt(n);n.width=i*o,n.height=e*o,a.scale(o,o);var c=this._mainWidget.getElement(),s=c.offsetWidth,h=c.offsetHeight,l=parseInt(c.style.left,10);if(a.drawImage(this._mainWidget.getImage(t),l,0,s,h),this._yAxisWidget){var u=this._yAxisWidget.getElement(),f=u.offsetWidth,d=u.offsetHeight,v=parseInt(u.style.left,10);a.drawImage(this._yAxisWidget.getImage(t),v,0,f,d)}return n}},{key:"destroy",value:function(){this._container.removeChild(this._element)}}]),r}();function gi(r,t){var i=Object.keys(r);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(r);t&&(e=e.filter(function(n){return Object.getOwnPropertyDescriptor(r,n).enumerable})),i.push.apply(i,e)}return i}var Ce=function(){function r(t){A(this,r),this._width=0,this._height=0,this._initElement(t.container),this._mainView=this._createMainView(this._element,t),this._overlayView=this._createOverlayView(this._element,t),this._htmlBaseId=0,this._htmls=new Map}return I(r,[{key:"_initElement",value:function(t){this._element=lt("div",{margin:"0",padding:"0",position:"absolute",top:"0",overflow:"hidden",boxSizing:"border-box"}),t.appendChild(this._element)}},{key:"_createMainView",value:function(t,i){}},{key:"_createOverlayView",value:function(t,i){}},{key:"createHtml",value:function(t){var i=t.id,e=t.content,n=t.style,a=lt("div",function(s){for(var h=1;arguments.length>h;h++){var l=arguments[h]!=null?arguments[h]:{};h%2?gi(Object(l),!0).forEach(function(u){Tt(s,u,l[u])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(l)):gi(Object(l)).forEach(function(u){Object.defineProperty(s,u,Object.getOwnPropertyDescriptor(l,u))})}return s}({boxSizing:"border-box",position:"absolute",zIndex:12},n===void 0?{}:n));if(Xt(e)){var o=e.replace(/(^\s*)|(\s*$)/g,"");a.innerHTML=o}else a.appendChild(e);var c=i||"html_".concat(++this._htmlBaseId);return this._htmls.has(c)?this._element.replaceChild(a,this._htmls.get(c)):this._element.appendChild(a),this._htmls.set(c,a),c}},{key:"removeHtml",value:function(t){var i=this;t?[].concat(t).forEach(function(e){var n=i._htmls.get(e);n&&(i._element.removeChild(n),i._htmls.delete(e))}):(this._htmls.forEach(function(e){i._element.removeChild(e)}),this._htmls.clear())}},{key:"getElement",value:function(){return this._element}},{key:"setWidth",value:function(t){this._width=t,this._mainView.setWidth(t),this._overlayView.setWidth(t)}},{key:"setHeight",value:function(t){this._height=t,this._mainView.setHeight(t),this._overlayView.setHeight(t)}},{key:"setOffsetLeft",value:function(t){this._element.style.left="".concat(t,"px")}},{key:"layout",value:function(){this._element.offsetWidth!==this._width&&(this._element.style.width="".concat(this._width,"px")),this._element.offsetHeight!==this._height&&(this._element.style.height="".concat(this._height,"px")),this._mainView.layout(),this._overlayView.layout()}},{key:"invalidate",value:function(t){switch(t){case ht:this._overlayView.flush();break;case Sn:case Pe:this._mainView.flush(),this._overlayView.flush()}}},{key:"getImage",value:function(t){var i=lt("canvas",{width:"".concat(this._width,"px"),height:"".concat(this._height,"px"),boxSizing:"border-box"}),e=i.getContext("2d"),n=Vt(i);return i.width=this._width*n,i.height=this._height*n,e.scale(n,n),e.drawImage(this._mainView.getImage(),0,0,this._width,this._height),t&&this._overlayView&&e.drawImage(this._overlayView.getImage(),0,0,this._width,this._height),i}}]),r}();function Ae(r){return window.requestAnimationFrame?window.requestAnimationFrame(r):window.setTimeout(r,20)}var Ht=function(){function r(t,i){A(this,r),this._chartStore=i,this._initCanvas(t)}return I(r,[{key:"_initCanvas",value:function(t){this._canvas=lt("canvas",{position:"absolute",top:"0",left:"0",zIndex:"2",boxSizing:"border-box"}),this._ctx=this._canvas.getContext("2d"),t.appendChild(this._canvas)}},{key:"_redraw",value:function(t){this._ctx.clearRect(0,0,this._canvas.offsetWidth,this._canvas.offsetHeight),t&&t(),this._draw()}},{key:"_draw",value:function(){}},{key:"setWidth",value:function(t){this._width=t}},{key:"setHeight",value:function(t){this._height=t}},{key:"layout",value:function(){var t=this;this._height!==this._canvas.offsetHeight||this._width!==this._canvas.offsetWidth?this._redraw(function(){var i=Vt(t._canvas);t._canvas.style.width="".concat(t._width,"px"),t._canvas.style.height="".concat(t._height,"px"),t._canvas.width=Math.floor(t._width*i),t._canvas.height=Math.floor(t._height*i),t._ctx.scale(i,i)}):this.flush()}},{key:"flush",value:function(){var t,i=this;this.requestAnimationId&&(t=this.requestAnimationId,window.cancelAnimationFrame||clearTimeout(t),window.cancelAnimationFrame(t),this.requestAnimationId=null),this.requestAnimationId=Ae(function(){i._redraw()})}},{key:"getImage",value:function(){return this._canvas}}]),r}();function On(r){var t=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var i,e=w(r);if(t){var n=w(this).constructor;i=Reflect.construct(e,arguments,n)}else i=e.apply(this,arguments);return F(this,i)}}var xi=function(r){B(i,r);var t=On(i);function i(e,n,a,o,c){var s;return A(this,i),(s=t.call(this,e,n))._xAxis=a,s._yAxis=o,s._paneId=c,s}return I(i,[{key:"_draw",value:function(){this._ctx.globalCompositeOperation="destination-over",this._drawContent()}},{key:"_drawContent",value:function(){this._drawTechs(),this._drawGrid()}},{key:"_drawGrid",value:function(){var e=this,n=this._chartStore.styleOptions().grid;if(n.show){var a=n.horizontal;this._ctx.save(),a.show&&(this._ctx.strokeStyle=a.color,this._ctx.lineWidth=a.size,this._ctx.setLineDash(a.style===et?a.dashValue:[]),this._yAxis.ticks().forEach(function(c){Mt(e._ctx,c.y,0,e._width)}));var o=n.vertical;o.show&&(this._ctx.strokeStyle=o.color,this._ctx.lineWidth=o.size,this._ctx.setLineDash(o.style===et?o.dashValue:[]),this._xAxis.ticks().forEach(function(c){Ut(e._ctx,c.x,0,e._height)})),this._ctx.restore()}}},{key:"_drawTechs",value:function(){var e=this;this._ctx.globalCompositeOperation="source-over";var n=this._chartStore.styleOptions().technicalIndicator;this._chartStore.technicalIndicatorStore().instances(this._paneId).forEach(function(a){var o=a.plots,c=[],s=e._chartStore.dataList(),h=a.result,l=a.styles||n;a.render&&(e._ctx.save(),a.render({ctx:e._ctx,dataSource:{from:e._chartStore.timeScaleStore().from(),to:e._chartStore.timeScaleStore().to(),kLineDataList:e._chartStore.dataList(),technicalIndicatorDataList:h},viewport:{width:e._width,height:e._height,dataSpace:e._chartStore.timeScaleStore().dataSpace(),barSpace:e._chartStore.timeScaleStore().barSpace()},styles:l,xAxis:e._xAxis,yAxis:e._yAxis}),e._ctx.restore());var u=l.line.colors||[],f=u.length,d=e._yAxis.isCandleYAxis();e._ctx.lineWidth=1,e._drawGraphics(function(v,p,_,m,y){var g=h[p]||{},k=0;a.shouldOhlc&&!d&&e._drawCandleBar(v,m,y,p,_,l.bar,rn),o.forEach(function(P){var M=g[P.key],R=e._yAxis.convertToPixel(M);switch(P.type){case xe:if(E(M)){var X=ee(s,h,p,P,l,{color:l.circle.noChangeColor,isStroke:!0});e._drawCircle({x:v,y:R,radius:m,color:X.color,isStroke:X.isStroke})}break;case ge:if(E(M)){var mt;mt=E(P.baseValue)?P.baseValue:e._yAxis.min();var nt=e._yAxis.convertToPixel(mt),Z=Math.abs(nt-R),H={x:v-m,width:2*m,height:Math.max(1,Z)};H.y=R>nt?nt:1>Z?nt-1:R;var $=ee(s,h,p,P,l,{color:l.bar.noChangeColor});H.color=$.color,H.isStroke=$.isStroke,e._drawBar(H)}break;case ye:var G=null;if(E(M)&&(G={x:v,y:R}),c[k])c[k].coordinates.push(G);else{var bt=ee(s,h,p,P,l,{color:u[k%f]});c[k]={color:bt.color,coordinates:[G]}}k++}})},function(){e._drawLines(c,l)})}),this._ctx.globalCompositeOperation="destination-over"}},{key:"_drawGraphics",value:function(e,n){var a=this._chartStore.visibleDataList(),o=this._chartStore.timeScaleStore().barSpace(),c=this._chartStore.timeScaleStore().halfBarSpace();a.forEach(function(s,h){e(s.x,s.index,s.data,c,o,h)}),n&&n()}},{key:"_drawLines",value:function(e,n){var a=this;this._ctx.lineWidth=n.line.size,e.forEach(function(o){a._ctx.strokeStyle=o.color,zt(a._ctx,o.coordinates)})}},{key:"_drawBar",value:function(e){e.isStroke?(this._ctx.strokeStyle=e.color,this._ctx.strokeRect(e.x+.5,e.y,e.width-1,e.height)):(this._ctx.fillStyle=e.color,this._ctx.fillRect(e.x,e.y,e.width,e.height))}},{key:"_drawCircle",value:function(e){this._ctx.strokeStyle=e.color,this._ctx.fillStyle=e.color,this._ctx.beginPath(),this._ctx.arc(e.x,e.y,e.radius,2*Math.PI,0,!0),e.isStroke?this._ctx.stroke():this._ctx.fill(),this._ctx.closePath()}},{key:"_drawCandleBar",value:function(e,n,a,o,c,s,h){var l=c.open,u=c.close,f=c.high,d=c.low;u>l?(this._ctx.strokeStyle=s.upColor,this._ctx.fillStyle=s.upColor):l>u?(this._ctx.strokeStyle=s.downColor,this._ctx.fillStyle=s.downColor):(this._ctx.strokeStyle=s.noChangeColor,this._ctx.fillStyle=s.noChangeColor);var v=this._yAxis.convertToPixel(l),p=this._yAxis.convertToPixel(u),_=this._yAxis.convertToPixel(f),m=this._yAxis.convertToPixel(d),y=Math.min(v,p),g=Math.max(v,p);this._ctx.fillRect(e-.5,_,1,y-_),this._ctx.fillRect(e-.5,g,1,m-g);var k=Math.max(1,g-y);switch(h){case je:this._ctx.fillRect(e-n,y,a,k);break;case tn:this._ctx.strokeRect(e-n+.5,y,a-1,k);break;case en:u>l?this._ctx.strokeRect(e-n+.5,y,a-1,k):this._ctx.fillRect(e-n,y,a,k);break;case nn:u>l?this._ctx.fillRect(e-n,y,a,k):this._ctx.strokeRect(e-n+.5,y,a-1,k);break;default:this._ctx.fillRect(e-.5,_,1,m-_),this._ctx.fillRect(e-n,v-.5,n,1),this._ctx.fillRect(e,p-.5,n,1)}}}]),i}(Ht);function ut(r,t,i,e,n){r.fillStyle=t,r.fillText(n,i,e)}function Dn(r){var t=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var i,e=w(r);if(t){var n=w(this).constructor;i=Reflect.construct(e,arguments,n)}else i=e.apply(this,arguments);return F(this,i)}}var Si=function(r){B(i,r);var t=Dn(i);function i(e,n,a,o,c){var s;return A(this,i),(s=t.call(this,e,n))._xAxis=a,s._yAxis=o,s._paneId=c,s}return I(i,[{key:"_draw",value:function(){this._ctx.textBaseline="alphabetic",this._drawTag(),this._drawShape(),this._drawAnnotation();var e=this._chartStore.crosshairStore().get();if(e.kLineData){var n=this._chartStore.styleOptions().crosshair;e.paneId===this._paneId&&this._drawCrosshairLine(n,"horizontal",e.y,0,this._width,Mt),e.paneId&&this._drawCrosshairLine(n,"vertical",e.realX,0,this._height,Ut),this._drawTooltip(e,this._chartStore.technicalIndicatorStore().instances(this._paneId))}}},{key:"_drawAnnotation",value:function(){var e=this,n=this._chartStore.annotationStore().get(this._paneId);n&&n.forEach(function(a){a.draw(e._ctx)})}},{key:"_drawTag",value:function(){var e=this,n=this._chartStore.tagStore().get(this._paneId);n&&n.forEach(function(a){a.drawMarkLine(e._ctx)})}},{key:"_drawShape",value:function(){var e=this;this._chartStore.shapeStore().instances(this._paneId).forEach(function(a){a.draw(e._ctx)});var n=this._chartStore.shapeStore().progressInstance();n.paneId===this._paneId&&n.instance.draw(this._ctx)}},{key:"_drawTooltip",value:function(e,n){var a=this._chartStore.styleOptions().technicalIndicator;this._drawBatchTechToolTip(e,n,a,0,this._shouldDrawTooltip(e,a.tooltip))}},{key:"_drawCrosshairLine",value:function(e,n,a,o,c,s){var h=e[n],l=h.line;e.show&&h.show&&l.show&&(this._ctx.save(),this._ctx.lineWidth=l.size,this._ctx.strokeStyle=l.color,l.style===et&&this._ctx.setLineDash(l.dashValue),s(this._ctx,a,o,c),this._ctx.restore())}},{key:"_drawBatchTechToolTip",value:function(e,n,a){var o=this,c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=arguments.length>4?arguments[4]:void 0;if(s){var h=a.tooltip,l=c;n.forEach(function(u){o._drawTechTooltip(e,u,a,l),l+=h.text.marginTop+h.text.size+h.text.marginBottom})}}},{key:"_drawTechTooltip",value:function(e,n,a){var o=this,c=arguments.length>3&&arguments[3]!==void 0?arguments[3]:0,s=a.tooltip,h=s.text,l=h.marginLeft,u=h.marginRight,f=h.size,d=h.color,v=0,p=h.marginTop+c,_=this._getTechTooltipData(e,n,a);if(this._ctx.textBaseline="top",this._ctx.font=q(f,h.weight,h.family),s.showName){var m=_.name,y=ct(this._ctx,m);ut(this._ctx,d,v+=l,p,m),v+=y,s.showParams||(v+=u)}if(s.showParams){var g=_.calcParamText,k=ct(this._ctx,g);s.showName||(v+=l),ut(this._ctx,d,v,p,g),v+=k+u}_.values.forEach(function(P){v+=l;var M="".concat(P.title).concat(P.value),R=ct(o._ctx,M);ut(o._ctx,P.color||h.color,v,p,M),v+=R+u})}},{key:"_shouldDrawTooltip",value:function(e,n){var a=n.showRule;return a===de||a===an&&!!e.paneId}},{key:"_getTechTooltipData",value:function(e,n,a){var o=this._chartStore.dataList(),c=n.result,s="",h=n.calcParams;if(h.length>0){var l=h.map(function(g){return L(g)?g.value:g});s="(".concat(l.join(","),")")}var u=[];if(W(n.createToolTipDataSource))u=n.createToolTipDataSource({dataSource:{from:this._chartStore.timeScaleStore().from(),to:this._chartStore.timeScaleStore().to(),kLineDataList:this._chartStore.dataList(),technicalIndicatorDataList:c},viewport:{width:this._width,height:this._height,dataSpace:this._chartStore.timeScaleStore().dataSpace(),barSpace:this._chartStore.timeScaleStore().barSpace()},crosshair:e,technicalIndicator:n,xAxis:this._xAxis,yAxis:this._yAxis,defaultStyles:a})||[];else{var f=n.styles||a,d=c[e.dataIndex],v=n.precision,p=n.shouldFormatBigNumber,_=f.line.colors||[],m=_.length,y=0;n.plots.forEach(function(g){var k={};switch(g.type){case xe:k={color:f.circle.noChangeColor};break;case ge:k={color:f.bar.noChangeColor};break;case ye:k={color:_[y%m]||a.tooltip.text.color},y++}var P=ee(o,c,e.dataIndex,g,f,k),M={};if(E(g.title)){var R=(d||{})[g.key];E(R)&&(R=pt(R,v),p&&(R=At(R))),M.title=g.title,M.value=R||a.tooltip.defaultValue,M.color=P.color,u.push(M)}})}return{values:u,name:n.shortName,calcParamText:s}}}]),i}(Ht);function Ln(r){var t=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var i,e=w(r);if(t){var n=w(this).constructor;i=Reflect.construct(e,arguments,n)}else i=e.apply(this,arguments);return F(this,i)}}var ki=function(r){B(i,r);var t=Ln(i);function i(){return A(this,i),t.apply(this,arguments)}return I(i,[{key:"_createMainView",value:function(e,n){return new xi(e,n.chartStore,n.xAxis,n.yAxis,n.paneId)}},{key:"_createOverlayView",value:function(e,n){return new Si(e,n.chartStore,n.xAxis,n.yAxis,n.paneId)}}]),i}(Ce);function oe(r,t,i,e,n,a,o,c,s){Ie(r,t,n,a,o,c,s),wi(r,i,e,n,a,o,c,s)}function wi(r,t,i,e,n,a,o,c){r.lineWidth=i,r.strokeStyle=t,bi(r,e,n,a,o,c),r.stroke()}function Ie(r,t,i,e,n,a,o){r.fillStyle=t,bi(r,i,e,n,a,o),r.fill()}function bi(r,t,i,e,n,a){r.beginPath(),r.moveTo(t+a,i),r.arcTo(t+e,i,t+e,i+n,a),r.arcTo(t+e,i+n,t,i+n,a),r.arcTo(t,i+n,t,i,a),r.arcTo(t,i,t+e,i,a),r.closePath()}function Ei(r,t){var i=Object.keys(r);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(r);t&&(e=e.filter(function(n){return Object.getOwnPropertyDescriptor(r,n).enumerable})),i.push.apply(i,e)}return i}function se(r){for(var t=1;arguments.length>t;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?Ei(Object(i),!0).forEach(function(e){Tt(r,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):Ei(Object(i)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(i,e))})}return r}function Rn(r){var t=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var i,e=w(r);if(t){var n=w(this).constructor;i=Reflect.construct(e,arguments,n)}else i=e.apply(this,arguments);return F(this,i)}}var Bn=function(r){B(i,r);var t=Rn(i);function i(e,n,a,o){var c;return A(this,i),(c=t.call(this,e,n))._yAxis=a,c._paneId=o,c}return I(i,[{key:"_draw",value:function(){var e=this._chartStore.styleOptions().yAxis;e.show&&(this._drawAxisLine(e),this._drawTickLines(e),this._drawTickLabels(e),this._drawTechLastValue(),this._drawLastPriceLabel())}},{key:"_drawAxisLine",value:function(e){var n,a=e.axisLine;a.show&&(this._ctx.strokeStyle=a.color,this._ctx.lineWidth=a.size,n=this._yAxis.isFromYAxisZero()?0:this._width-1,Ut(this._ctx,n,0,this._height))}},{key:"_drawTickLines",value:function(e){var n=this,a=e.tickLine;if(a.show){this._ctx.lineWidth=a.size,this._ctx.strokeStyle=a.color;var o,c,s=a.length;this._yAxis.isFromYAxisZero()?(o=0,e.axisLine.show&&(o+=e.axisLine.size),c=o+s):(o=this._width,e.axisLine.show&&(o-=e.axisLine.size),c=o-s),this._yAxis.ticks().forEach(function(h){Mt(n._ctx,h.y,o,c)})}}},{key:"_drawTickLabels",value:function(e){var n=this,a=e.tickText;if(a.show){var o,c=e.tickLine,s=c.show,h=c.length;this._yAxis.isFromYAxisZero()?(o=a.paddingLeft,e.axisLine.show&&(o+=e.axisLine.size),s&&(o+=h),this._ctx.textAlign="left"):(o=this._width-a.paddingRight,e.axisLine.show&&(o-=e.axisLine.size),s&&(o-=h),this._ctx.textAlign="right"),this._ctx.textBaseline="middle",this._ctx.font=q(a.size,a.weight,a.family),this._ctx.fillStyle=a.color,this._yAxis.ticks().forEach(function(l){n._ctx.fillText(l.v,o,l.y)}),this._ctx.textAlign="left"}}},{key:"_drawTechLastValue",value:function(){var e=this,n=this._chartStore.styleOptions().technicalIndicator,a=n.lastValueMark;if(a.show&&a.text.show){var o=this._chartStore.technicalIndicatorStore().instances(this._paneId),c=this._chartStore.dataList();o.forEach(function(s){var h=s.result||[],l=h.length,u=h[l-1]||{},f={prev:{kLineData:c[l-2],technicalIndicatorData:h[l-2]},current:{kLineData:c[l-1],technicalIndicatorData:u},next:{kLineData:null,technicalIndicatorData:null}},d=s.precision,v=s.styles||n,p=v.line.colors||[],_=p.length,m=0;s.plots.forEach(function(y){var g,k=u[y.key];switch(y.type){case xe:g=y.color&&y.color(f,v)||v.circle.noChangeColor;break;case ge:g=y.color&&y.color(f,v)||v.bar.noChangeColor;break;case ye:g=p[m%_],m++}E(k)&&e._drawMarkLabel(k,d,s.shouldFormatBigNumber,se(se({},a.text),{},{backgroundColor:g}))})})}}},{key:"_drawLastPriceLabel",value:function(){if(this._yAxis.isCandleYAxis()){var e=this._chartStore.styleOptions().candle.priceMark,n=e.last;if(e.show&&n.show&&n.text.show){var a=this._chartStore.dataList(),o=a[a.length-1];if(o){var c,s=o.close,h=o.open;c=s>h?n.upColor:h>s?n.downColor:n.noChangeColor,this._drawMarkLabel(s,this._chartStore.pricePrecision(),!1,se(se({},n.text),{},{backgroundColor:c}))}}}}},{key:"_drawMarkLabel",value:function(e,n,a,o){var c,s=o.size,h=o.weight,l=o.family,u=o.color,f=o.backgroundColor,d=o.borderRadius,v=o.paddingLeft,p=o.paddingTop,_=o.paddingRight,m=o.paddingBottom,y=this._yAxis.convertToNicePixel(e);if(this._yAxis.yAxisType()===Ct){var g=((this._chartStore.visibleDataList()[0]||{}).data||{}).close;c="".concat(((e-g)/g*100).toFixed(2),"%")}else c=pt(e,n),a&&(c=At(c));this._ctx.font=q(s,h,l);var k,P=ct(this._ctx,c)+v+_,M=p+s+m;k=this._yAxis.isFromYAxisZero()?0:this._width-P,Ie(this._ctx,f,k,y-p-s/2,P,M,d),this._ctx.textBaseline="middle",ut(this._ctx,u,k+v,y,c)}}]),i}(Ht);function Fn(r){var t=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var i,e=w(r);if(t){var n=w(this).constructor;i=Reflect.construct(e,arguments,n)}else i=e.apply(this,arguments);return F(this,i)}}var zn=function(r){B(i,r);var t=Fn(i);function i(e,n,a,o){var c;return A(this,i),(c=t.call(this,e,n))._yAxis=a,c._paneId=o,c}return I(i,[{key:"_draw",value:function(){this._ctx.textBaseline="middle",this._drawTag(),this._drawCrossHairLabel()}},{key:"_drawTag",value:function(){var e=this,n=this._chartStore.tagStore().get(this._paneId);n&&n.forEach(function(a){a.drawText(e._ctx)})}},{key:"_drawCrossHairLabel",value:function(){var e=this._chartStore.crosshairStore().get();if(e.paneId===this._paneId&&this._chartStore.dataList().length!==0){var n=this._chartStore.styleOptions().crosshair,a=n.horizontal,o=a.text;if(n.show&&a.show&&o.show){var c,s,h=this._yAxis.convertFromPixel(e.y);if(this._yAxis.yAxisType()===Ct){var l=(this._chartStore.visibleDataList()[0]||{}).data||{};c="".concat(((h-l.close)/l.close*100).toFixed(2),"%")}else{var u=this._chartStore.technicalIndicatorStore().instances(this._paneId),f=0,d=!1;this._yAxis.isCandleYAxis()?f=this._chartStore.pricePrecision():u.forEach(function(m){f=Math.max(m.precision,f),d||(d=m.shouldFormatBigNumber)}),c=pt(h,f),d&&(c=At(c))}var v=o.borderSize,p=Ot(this._ctx,c,o),_=ae(o);s=this._yAxis.isFromYAxisZero()?0:this._width-p,oe(this._ctx,o.backgroundColor,o.borderColor,v,s,e.y-v-o.paddingTop-o.size/2,p,_,o.borderRadius),ut(this._ctx,o.color,s+v+o.paddingLeft,e.y,c)}}}}]),i}(Ht);function Vn(r){var t=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var i,e=w(r);if(t){var n=w(this).constructor;i=Reflect.construct(e,arguments,n)}else i=e.apply(this,arguments);return F(this,i)}}var jn=function(r){B(i,r);var t=Vn(i);function i(){return A(this,i),t.apply(this,arguments)}return I(i,[{key:"_createMainView",value:function(e,n){return new Bn(e,n.chartStore,n.yAxis,n.paneId)}},{key:"_createOverlayView",value:function(e,n){return new zn(e,n.chartStore,n.yAxis,n.paneId)}}]),i}(Ce),Pi=function(){function r(t){A(this,r),this._chartStore=t,this._width=0,this._height=0,this._cacheMinValue=0,this._cacheMaxValue=0,this._minValue=0,this._maxValue=0,this._range=0,this._ticks=[],this._initMeasureCanvas()}return I(r,[{key:"_initMeasureCanvas",value:function(){var t=lt("canvas"),i=Vt(t);this._measureCtx=t.getContext("2d"),this._measureCtx.scale(i,i)}},{key:"min",value:function(){return this._minValue}},{key:"max",value:function(){return this._maxValue}},{key:"width",value:function(){return this._width}},{key:"height",value:function(){return this._height}},{key:"setWidth",value:function(t){this._width=t}},{key:"setHeight",value:function(t){this._height=t}},{key:"ticks",value:function(){return this._ticks}},{key:"computeAxis",value:function(t){var i=this._optimalMinMax(this._computeMinMax());return this._minValue=i.min,this._maxValue=i.max,this._range=i.range,!(this._cacheMinValue===i.min&&this._cacheMaxValue===i.max&&!t)&&(this._cacheMinValue=i.min,this._cacheMaxValue=i.max,this._ticks=this._optimalTicks(this._computeTicks()),!0)}},{key:"_computeMinMax",value:function(){}},{key:"_optimalMinMax",value:function(t){}},{key:"_computeTicks",value:function(){var t=[];if(this._range>=0){var i=this._computeInterval(this._range),e=i.interval,n=i.precision,a=_e(Math.ceil(this._minValue/e)*e,n),o=_e(Math.floor(this._maxValue/e)*e,n),c=0,s=a;if(e!==0)for(;o>=s;)t[c]={v:s.toFixed(n)},++c,s+=e}return t}},{key:"_optimalTicks",value:function(t){}},{key:"_computeInterval",value:function(t){var i,e,n,a,o=(e=Math.floor(Gt(i=t/8)),n=It(e),i=(1.5>(a=i/n)?1:2.5>a?2:3.5>a?3:4.5>a?4:5.5>a?5:6.5>a?6:8)*n,-20>e?i:+i.toFixed(0>e?-e:0)),c=function(s){var h=""+s,l=h.indexOf("e");if(l>0){var u=+h.slice(l+1);return 0>u?-u:0}var f=h.indexOf(".");return 0>f?0:h.length-1-f}(o);return{interval:o,precision:c}}}]),r}();function Hn(r){var t=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var i,e=w(r);if(t){var n=w(this).constructor;i=Reflect.construct(e,arguments,n)}else i=e.apply(this,arguments);return F(this,i)}}var Ci=function(r){B(i,r);var t=Hn(i);function i(e,n,a){var o;return A(this,i),(o=t.call(this,e))._realRange=0,o._isCandleYAxis=n,o._paneId=a,o}return I(i,[{key:"_computeMinMax",value:function(){var e,n=this,a=[Number.MAX_SAFE_INTEGER,Number.MIN_SAFE_INTEGER],o=[],c=!1,s=Number.MAX_SAFE_INTEGER,h=Number.MIN_SAFE_INTEGER,l=Number.MAX_SAFE_INTEGER;this._chartStore.technicalIndicatorStore().instances(this._paneId).forEach(function(y){if(c||(c=y.shouldOhlc),l=Math.min(l,y.precision),O(y.minValue)&&(s=Math.min(s,y.minValue)),O(y.maxValue)&&(h=Math.max(h,y.maxValue)),y.styles){e||(e={top:0,bottom:0});var g=y.styles.margin;O(g.top)&&(e.top=Math.max(1>g.top?g.top:g.top/n._height,e.top)),O(g.bottom)&&(e.bottom=Math.max(1>g.bottom?g.bottom:g.bottom/n._height,e.bottom))}o.push({plots:y.plots,result:y.result})});var u=4;if(this._isCandleYAxis){var f=this._chartStore.pricePrecision();u=l!==Number.MAX_SAFE_INTEGER?Math.min(l,f):f}else l!==Number.MAX_SAFE_INTEGER&&(u=l);var d=this._chartStore.visibleDataList(),v=this._chartStore.styleOptions().candle,p=v.type===He,_=v.area.value,m=this._isCandleYAxis&&!p||!this._isCandleYAxis&&c;return d.forEach(function(y){var g=y.index,k=y.data;m&&(a[0]=Math.min(a[0],k.low),a[1]=Math.max(a[1],k.high)),n._isCandleYAxis&&p&&(a[0]=Math.min(a[0],k[_]),a[1]=Math.max(a[1],k[_])),o.forEach(function(P){var M=P.result[g]||{};P.plots.forEach(function(R){var X=M[R.key];E(X)&&(a[0]=Math.min(a[0],X),a[1]=Math.max(a[1],X))})})}),a[0]!==Number.MAX_SAFE_INTEGER&&a[1]!==Number.MIN_SAFE_INTEGER?(a[0]=Math.min(s,a[0]),a[1]=Math.max(h,a[1])):(a[0]=0,a[1]=10),{min:a[0],max:a[1],precision:u,specifyMin:s,specifyMax:h,techGap:e}}},{key:"_optimalMinMax",value:function(e){var n,a,o=e.precision,c=e.specifyMin,s=e.specifyMax,h=e.techGap,l=e.min,u=e.max,f=this.yAxisType();switch(f){case Ct:var d=(this._chartStore.visibleDataList()[0]||{}).data||{};O(d.close)&&(l=(l-d.close)/d.close*100,u=(u-d.close)/d.close*100),n=.01;break;case Ft:l=Gt(l),u=Gt(u),n=.05*It(-o);break;default:n=It(-o)}if(l===u||n>Math.abs(l-u)){var v=c===l,p=s===u;l=v?l:p?l-8*n:l-4*n,u=p?u:v?u+8*n:u+4*n}var _,m=.2;O((a=this._isCandleYAxis?this._chartStore.styleOptions().candle.margin:h?{top:0,bottom:0}:this._chartStore.styleOptions().technicalIndicator.margin).top)&&(_=1>a.top?a.top:a.top/this._height,m=h?Math.max(h.top,_):_);var y,g=.1;O(a.bottom)&&(y=1>a.bottom?a.bottom:a.bottom/this._height,g=h?Math.max(h.bottom,y):y);var k=Math.abs(u-l);return k=Math.abs((u+=k*m)-(l-=k*g)),this._realRange=f===Ft?Math.abs(It(u)-It(l)):k,{min:l,max:u,range:k}}},{key:"_optimalTicks",value:function(e){var n=this,a=[],o=this.yAxisType(),c=this._chartStore.technicalIndicatorStore().instances(this._paneId),s=0,h=!1;this._isCandleYAxis?s=this._chartStore.pricePrecision():c.forEach(function(d){s=Math.max(s,d.precision),h||(h=d.shouldFormatBigNumber)});var l,u,f=this._chartStore.styleOptions().xAxis.tickText.size;return o===Ft&&(l=this._computeInterval(this._realRange)),e.forEach(function(d){var v,p=d.v,_=n._innerConvertToPixel(+p);switch(o){case Ct:v="".concat(pt(p,2),"%");break;case Ft:v=_e(It(p),l.precision),_=n._innerConvertToPixel(Gt(v)),v=pt(v,s);break;default:v=pt(p,s),h&&(v=At(v))}_>f&&n._height-f>_&&(u&&u-_>2*f||!u)&&(a.push({v,y:_}),u=_)}),a}},{key:"_innerConvertToPixel",value:function(e){return Math.round((1-(e-this._minValue)/this._range)*this._height)}},{key:"isCandleYAxis",value:function(){return this._isCandleYAxis}},{key:"yAxisType",value:function(){return this._isCandleYAxis?this._chartStore.styleOptions().yAxis.type:Ve}},{key:"isFromYAxisZero",value:function(){var e=this._chartStore.styleOptions().yAxis;return e.position===Bt&&e.inside||e.position===ze&&!e.inside}},{key:"getSelfWidth",value:function(){var e=this,n=this._chartStore.styleOptions(),a=n.yAxis,o=a.width;if(O(o))return o;var c=0;if(a.show&&(a.axisLine.show&&(c+=a.axisLine.size),a.tickLine.show&&(c+=a.tickLine.length),a.tickText.show)){var s=0;this._measureCtx.font=q(a.tickText.size,a.tickText.weight,a.tickText.family),this._ticks.forEach(function(y){s=Math.max(s,ct(e._measureCtx,y.v))}),c+=a.tickText.paddingLeft+a.tickText.paddingRight+s}var h=n.crosshair,l=0;if(h.show&&h.horizontal.show&&h.horizontal.text.show){var u=this._chartStore.technicalIndicatorStore().instances(this._paneId),f=0,d=!1;u.forEach(function(y){f=Math.max(y.precision,f),d||(d=y.shouldFormatBigNumber)}),this._measureCtx.font=q(h.horizontal.text.size,h.horizontal.text.weight,h.horizontal.text.family);var v=2;if(this.yAxisType()!==Ct)if(this._isCandleYAxis){var p=this._chartStore.pricePrecision(),_=n.technicalIndicator.lastValueMark;v=_.show&&_.text.show?Math.max(f,p):p}else v=f;var m=pt(this._maxValue,v);d&&(m=At(m)),l+=h.horizontal.text.paddingLeft+h.horizontal.text.paddingRight+2*h.horizontal.text.borderSize+ct(this._measureCtx,m)}return Math.max(c,l)}},{key:"convertFromPixel",value:function(e){var n=(1-e/this._height)*this._range+this._minValue;switch(this.yAxisType()){case Ct:var a=(this._chartStore.visibleDataList()[0]||{}).data||{};if(O(a.close))return a.close*n/100+a.close;break;case Ft:return It(n);default:return n}}},{key:"convertToPixel",value:function(e){var n;switch(this.yAxisType()){case Ct:var a=(this._chartStore.visibleDataList()[0]||{}).data||{};O(a.close)&&(n=(e-a.close)/a.close*100);break;case Ft:n=Gt(e);break;default:n=e}return this._innerConvertToPixel(n)}},{key:"convertToNicePixel",value:function(e){var n=this.convertToPixel(e);return Math.round(Math.max(.05*this._height,Math.min(n,.98*this._height)))}}]),i}(Pi);function Nn(r){var t=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var i,e=w(r);if(t){var n=w(this).constructor;i=Reflect.construct(e,arguments,n)}else i=e.apply(this,arguments);return F(this,i)}}var Ai=function(r){B(i,r);var t=Nn(i);function i(e){var n;return A(this,i),n=t.call(this,e),"height"in e&&n.setHeight(e.height),n}return I(i,[{key:"_initBefore",value:function(e){this._id=e.id,this._yAxis=this._createYAxis(e)}},{key:"_createYAxis",value:function(e){return new Ci(e.chartStore,!1,e.id)}},{key:"_createMainWidget",value:function(e,n){return new ki({container:e,chartStore:n.chartStore,xAxis:n.xAxis,yAxis:this._yAxis,paneId:n.id})}},{key:"_createYAxisWidget",value:function(e,n){return new jn({container:e,chartStore:n.chartStore,yAxis:this._yAxis,paneId:n.id})}},{key:"setHeight",value:function(e){jt(w(i.prototype),"setHeight",this).call(this,e),this._yAxis.setHeight(e)}},{key:"setWidth",value:function(e,n){jt(w(i.prototype),"setWidth",this).call(this,e,n),this._yAxis.setWidth(n)}},{key:"id",value:function(){return this._id}},{key:"yAxis",value:function(){return this._yAxis}}]),i}(yi);function Yn(r){var t=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var i,e=w(r);if(t){var n=w(this).constructor;i=Reflect.construct(e,arguments,n)}else i=e.apply(this,arguments);return F(this,i)}}var Wn=function(r){B(i,r);var t=Yn(i);function i(){return A(this,i),t.apply(this,arguments)}return I(i,[{key:"_drawContent",value:function(){var e=this._chartStore.styleOptions().candle;this._drawLastPriceLine(e.priceMark),e.type===He?this._drawArea(e):(this._drawLowHighPrice(e.priceMark,"high","high",Number.MIN_SAFE_INTEGER,[-2,-5],function(n,a){if(n>a)return n}),this._drawLowHighPrice(e.priceMark,"low","low",Number.MAX_SAFE_INTEGER,[2,5],function(n,a){if(a>n)return n}),this._drawCandle(e)),this._drawTechs(),this._drawGrid()}},{key:"_drawArea",value:function(e){var n=this,a=[],o=[],c=Number.MAX_SAFE_INTEGER,s=e.area;this._drawGraphics(function(h,l,u,f,d,v){var p=u[s.value];if(O(p)){var _=n._yAxis.convertToPixel(p);if(v===0){var m=h-f;o.push({x:m,y:n._height}),o.push({x:m,y:_}),a.push({x:m,y:_})}a.push({x:h,y:_}),o.push({x:h,y:_}),c=Math.min(c,_)}},function(){var h=o.length;if(h>0){var l=o[h-1],u=n._chartStore.timeScaleStore().halfBarSpace(),f=l.x+u;a.push({x:f,y:l.y}),o.push({x:f,y:l.y}),o.push({x:f,y:n._height})}if(a.length>0&&(n._ctx.lineWidth=s.lineSize,n._ctx.strokeStyle=s.lineColor,zt(n._ctx,a)),o.length>0){var d=s.backgroundColor;if(V(d)){var v=n._ctx.createLinearGradient(0,n._height,0,c);try{d.forEach(function(p){v.addColorStop(p.offset,p.color)})}catch{}n._ctx.fillStyle=v}else n._ctx.fillStyle=d;ri(n._ctx,o)}})}},{key:"_drawCandle",value:function(e){var n=this;this._drawGraphics(function(a,o,c,s,h){n._drawCandleBar(a,s,h,o,c,e.bar,e.type)})}},{key:"_drawLowHighPrice",value:function(e,n,a,o,c,s){var h=e[n];if(e.show&&h.show){var l=this._chartStore.visibleDataList(),u=o,f=-1;l.forEach(function(g){var k=g.index,P=s(vt(g.data,a,o),u);P&&(u=P,f=k)});var d=this._chartStore.pricePrecision(),v=this._yAxis.convertToPixel(u),p=this._xAxis.convertToPixel(f),_=v+c[0];this._ctx.textAlign="left",this._ctx.lineWidth=1,this._ctx.strokeStyle=h.color,this._ctx.fillStyle=h.color,zt(this._ctx,[{x:p-2,y:_+c[0]},{x:p,y:_},{x:p+2,y:_+c[0]}]);var m=_+c[1];zt(this._ctx,[{x:p,y:_},{x:p,y:m},{x:p+5,y:m}]),this._ctx.font=q(h.textSize,h.textWeight,h.textFamily);var y=pt(u,d);this._ctx.textBaseline="middle",this._ctx.fillText(y,p+5+h.textMargin,m)}}},{key:"_drawLastPriceLine",value:function(e){var n=e.last;if(e.show&&n.show&&n.line.show){var a=this._chartStore.dataList(),o=a[a.length-1];if(o){var c,s=o.close,h=o.open,l=this._yAxis.convertToNicePixel(s);c=s>h?n.upColor:h>s?n.downColor:n.noChangeColor,this._ctx.save(),this._ctx.strokeStyle=c,this._ctx.lineWidth=n.line.size,n.line.style===et&&this._ctx.setLineDash(n.line.dashValue),Mt(this._ctx,l,0,this._width),this._ctx.restore()}}}}]),i}(xi);function Xn(r){var t=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var i,e=w(r);if(t){var n=w(this).constructor;i=Reflect.construct(e,arguments,n)}else i=e.apply(this,arguments);return F(this,i)}}var Gn=function(r){B(i,r);var t=Xn(i);function i(){return A(this,i),t.apply(this,arguments)}return I(i,[{key:"_drawTooltip",value:function(e,n){var a=this._chartStore.styleOptions(),o=a.candle,c=o.tooltip,s=a.technicalIndicator,h=s.tooltip,l=this._shouldDrawTooltip(e,c),u=this._shouldDrawTooltip(e,h);c.showType===Ne&&h.showType===Ne?this._drawCandleTooltipWithRect(e,n,o,l,s,u):c.showType===Qt?(this._drawCandleTooltipWithStandard(e.kLineData,o,l),h.showType===Qt?this._drawBatchTechToolTip(e,n,s,l?c.text.size+c.text.marginTop:0,u):this._drawCandleTooltipWithRect(e,n,o,!1,s,u)):(this._drawCandleTooltipWithRect(e,n,o,l,s,!1),this._drawBatchTechToolTip(e,n,s,0,u))}},{key:"_drawCandleTooltipWithStandard",value:function(e,n,a){var o=this;if(a){var c=this._getCandleTooltipData(e,n),s=n.tooltip,h=s.text.marginLeft,l=s.text.marginRight,u=s.text.size,f=s.text.color,d=s.labels;this._ctx.textBaseline="top",this._ctx.font=q(u,s.text.weight,s.text.family);var v=h,p=s.text.marginTop;d.forEach(function(_,m){var y=ct(o._ctx,_);ut(o._ctx,f,v,p,_),v+=y;var g,k,P=c[m]||s.defaultValue;L(P)?(g=P.value||s.defaultValue,k=P.color||f):(k=f,g=P);var M=ct(o._ctx,g);ut(o._ctx,k,v,p,g),v+=M+h+l})}}},{key:"_drawCandleTooltipWithRect",value:function(e,n,a,o,c,s){var h=this;if(o||s){var l=a.tooltip,u=l.labels,f=this._getCandleTooltipData(e.kLineData,a),d=l.text.marginLeft,v=l.text.marginRight,p=l.text.marginTop,_=l.text.marginBottom,m=l.text.size,y=l.text.color,g=l.rect,k=g.borderSize,P=g.paddingLeft,M=g.paddingRight,R=g.paddingTop,X=g.paddingBottom,mt=g.offsetLeft,nt=g.offsetRight,Z=0,H=0,$=0;this._ctx.save(),this._ctx.textBaseline="top",o&&(this._ctx.font=q(m,l.text.weight,l.text.family),u.forEach(function(U,j){var ft,st=f[j];ft=L(st)?st.value||l.defaultValue:st;var rt="".concat(U).concat(ft),Le=ct(h._ctx,rt)+d+v;Z=Math.max(Z,Le)}),$+=(_+p+m)*u.length);var G=c.tooltip,bt=G.text.marginLeft,qt=G.text.marginRight,S=G.text.marginTop,x=G.text.marginBottom,C=G.text.size,T=[];if(n.forEach(function(U){T.push(h._getTechTooltipData(e,U,c))}),s&&(this._ctx.font=q(C,G.text.weight,G.text.family),T.forEach(function(U){U.values.forEach(function(j){var ft=j.title,st=j.value;if(E(ft)){var rt="".concat(ft).concat(st),Le=ct(h._ctx,rt)+bt+qt;Z=Math.max(Z,Le),$+=S+x+C}})})),(H+=Z)!==0&&$!==0){var b;H+=2*k+P+M;var N=g.offsetTop,Y=g.borderRadius;Ie(this._ctx,g.backgroundColor,b=this._width/2>e.realX?this._width-nt-H:mt,N,H,$+=2*k+R+X,Y),wi(this._ctx,g.borderColor,k,b,N,H,$,Y);var ot=b+k+P+d,D=N+k+R;if(o&&(this._ctx.font=q(m,l.text.weight,l.text.family),u.forEach(function(U,j){D+=p,h._ctx.textAlign="left",ut(h._ctx,y,ot,D,U);var ft,st,rt=f[j];L(rt)?(st=rt.color||y,ft=rt.value||l.defaultValue):(st=y,ft=rt||l.defaultValue),h._ctx.textAlign="right",ut(h._ctx,st,b+H-k-v-M,D,ft),D+=m+_})),s){var J=b+k+P+bt;this._ctx.font=q(C,G.text.weight,G.text.family),T.forEach(function(U){U.values.forEach(function(j){D+=S,h._ctx.textAlign="left",h._ctx.fillStyle=j.color||G.text.color,h._ctx.fillText(j.title,J,D),h._ctx.textAlign="right",h._ctx.fillText(j.value,b+H-k-qt-M,D),D+=C+x})})}this._ctx.restore()}}}},{key:"_getCandleTooltipData",value:function(e,n){var a=this,o=n.tooltip.values,c=[];if(o)W(o)?c=o(e,n)||[]:V(o)&&(c=o);else{var s=this._chartStore.pricePrecision(),h=this._chartStore.volumePrecision();(c=[vt(e,"timestamp"),vt(e,"open"),vt(e,"close"),vt(e,"high"),vt(e,"low"),vt(e,"volume")]).forEach(function(l,u){switch(u){case 0:c[u]=at(a._chartStore.timeScaleStore().dateTimeFormat(),l,"YYYY-MM-DD hh:mm");break;case c.length-1:c[u]=At(pt(l,h));break;default:c[u]=pt(l,s)}})}return c}}]),i}(Si);function Un(r){var t=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var i,e=w(r);if(t){var n=w(this).constructor;i=Reflect.construct(e,arguments,n)}else i=e.apply(this,arguments);return F(this,i)}}var Zn=function(r){B(i,r);var t=Un(i);function i(){return A(this,i),t.apply(this,arguments)}return I(i,[{key:"_createMainView",value:function(e,n){return new Wn(e,n.chartStore,n.xAxis,n.yAxis,n.paneId)}},{key:"_createOverlayView",value:function(e,n){return new Gn(e,n.chartStore,n.xAxis,n.yAxis,n.paneId)}}]),i}(ki);function Kn(r){var t=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var i,e=w(r);if(t){var n=w(this).constructor;i=Reflect.construct(e,arguments,n)}else i=e.apply(this,arguments);return F(this,i)}}var qn=function(r){B(i,r);var t=Kn(i);function i(){return A(this,i),t.apply(this,arguments)}return I(i,[{key:"_createYAxis",value:function(e){return new Ci(e.chartStore,!0,e.id)}},{key:"_createMainWidget",value:function(e,n){return new Zn({container:e,chartStore:n.chartStore,xAxis:n.xAxis,yAxis:this._yAxis,paneId:n.id})}}]),i}(Ai);function $n(r){var t=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var i,e=w(r);if(t){var n=w(this).constructor;i=Reflect.construct(e,arguments,n)}else i=e.apply(this,arguments);return F(this,i)}}var Jn=function(r){B(i,r);var t=$n(i);function i(e,n,a){var o;return A(this,i),(o=t.call(this,e,n))._xAxis=a,o}return I(i,[{key:"_draw",value:function(){var e=this._chartStore.styleOptions().xAxis;e.show&&(this._drawAxisLine(e),this._drawTickLines(e),this._drawTickLabels(e))}},{key:"_drawAxisLine",value:function(e){var n=e.axisLine;n.show&&(this._ctx.strokeStyle=n.color,this._ctx.lineWidth=n.size,Mt(this._ctx,0,0,this._width))}},{key:"_drawTickLines",value:function(e){var n=this,a=e.tickLine;if(a.show){this._ctx.lineWidth=a.size,this._ctx.strokeStyle=a.color;var o=e.axisLine.show?e.axisLine.size:0,c=o+a.length;this._xAxis.ticks().forEach(function(s){Ut(n._ctx,s.x,o,c)})}}},{key:"_drawTickLabels",value:function(e){var n=e.tickText;if(n.show){var a=e.tickLine;this._ctx.textBaseline="top",this._ctx.font=q(n.size,n.weight,n.family),this._ctx.textAlign="center",this._ctx.fillStyle=n.color;var o=n.paddingTop;e.axisLine.show&&(o+=e.axisLine.size),a.show&&(o+=a.length);for(var c=this._xAxis.ticks(),s=c.length,h=0;s>h;h++)this._ctx.fillText(c[h].v,c[h].x,o)}}}]),i}(Ht);function Qn(r){var t=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var i,e=w(r);if(t){var n=w(this).constructor;i=Reflect.construct(e,arguments,n)}else i=e.apply(this,arguments);return F(this,i)}}var tr=function(r){B(i,r);var t=Qn(i);function i(e,n,a){var o;return A(this,i),(o=t.call(this,e,n))._xAxis=a,o}return I(i,[{key:"_draw",value:function(){this._drawCrosshairLabel()}},{key:"_drawCrosshairLabel",value:function(){var e=this._chartStore.crosshairStore().get();if(e.paneId){var n=this._chartStore.styleOptions().crosshair,a=n.vertical,o=a.text;if(n.show&&a.show&&o.show&&e.dataIndex===e.realDataIndex){var c=e.kLineData.timestamp,s=at(this._chartStore.timeScaleStore().dateTimeFormat(),c,"YYYY-MM-DD hh:mm"),h=o.paddingLeft,l=o.paddingRight,u=o.paddingTop,f=o.borderSize,d=Ot(this._ctx,s,o),v=ae(o),p=d-2*f-h-l,_=e.realX-p/2;h+f>_?_=h+f:_>this._width-p-f-l&&(_=this._width-p-f-l),oe(this._ctx,o.backgroundColor,o.borderColor,f,_-f-h,0,d,v,o.borderRadius),this._ctx.textBaseline="top",ut(this._ctx,o.color,_,f+u,s)}}}}]),i}(Ht);function er(r){var t=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var i,e=w(r);if(t){var n=w(this).constructor;i=Reflect.construct(e,arguments,n)}else i=e.apply(this,arguments);return F(this,i)}}var ir=function(r){B(i,r);var t=er(i);function i(){return A(this,i),t.apply(this,arguments)}return I(i,[{key:"_createMainView",value:function(e,n){return new Jn(e,n.chartStore,n.xAxis)}},{key:"_createOverlayView",value:function(e,n){return new tr(e,n.chartStore,n.xAxis)}}]),i}(Ce);function nr(r){var t=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var i,e=w(r);if(t){var n=w(this).constructor;i=Reflect.construct(e,arguments,n)}else i=e.apply(this,arguments);return F(this,i)}}var rr=function(r){B(i,r);var t=nr(i);function i(){return A(this,i),t.apply(this,arguments)}return I(i,[{key:"_computeMinMax",value:function(){return{min:this._chartStore.timeScaleStore().from(),max:this._chartStore.timeScaleStore().to()-1}}},{key:"_optimalMinMax",value:function(e){var n=e.min,a=e.max;return{min:n,max:a,range:a-n+1}}},{key:"_optimalTicks",value:function(e){var n=[],a=e.length,o=this._chartStore.dataList();if(a>0){var c=this._chartStore.timeScaleStore().dateTimeFormat(),s=this._chartStore.styleOptions().xAxis.tickText;this._measureCtx.font=q(s.size,s.weight,s.family);var h=ct(this._measureCtx,"00-00 00:00"),l=this.convertToPixel(parseInt(e[0].v,10)),u=1;if(a>1){var f=this.convertToPixel(parseInt(e[1].v,10)),d=Math.abs(f-l);h>d&&(u=Math.ceil(h/d))}for(var v=0;a>v;v+=u){var p=parseInt(e[v].v,10),_=o[p].timestamp,m=at(c,_,"hh:mm");v!==0&&(m=this._optimalTickLabel(c,_,o[parseInt(e[v-u].v,10)].timestamp)||m);var y=this.convertToPixel(p);n.push({v:m,x:y,oV:_})}if(n.length===1)n[0].v=at(c,n[0].oV,"YYYY-MM-DD hh:mm");else{var g=n[0].oV,k=n[1].oV;if(n[2]){var P=n[2].v;/^[0-9]{2}-[0-9]{2}$/.test(P)?n[0].v=at(c,g,"MM-DD"):/^[0-9]{4}-[0-9]{2}$/.test(P)?n[0].v=at(c,g,"YYYY-MM"):/^[0-9]{4}$/.test(P)&&(n[0].v=at(c,g,"YYYY"))}else n[0].v=this._optimalTickLabel(c,g,k)||n[0].v}}return n}},{key:"_optimalTickLabel",value:function(e,n,a){var o=at(e,n,"YYYY"),c=at(e,n,"YYYY-MM"),s=at(e,n,"MM-DD");return o!==at(e,a,"YYYY")?o:c!==at(e,a,"YYYY-MM")?c:s!==at(e,a,"MM-DD")?s:null}},{key:"getSelfHeight",value:function(){var e=this._chartStore.styleOptions(),n=e.xAxis,a=n.height;if(O(a))return a;var o=e.crosshair,c=0;n.show&&(n.axisLine.show&&(c+=n.axisLine.size),n.tickLine.show&&(c+=n.tickLine.length),n.tickText.show&&(c+=n.tickText.paddingTop+n.tickText.paddingBottom+n.tickText.size));var s=0;return o.show&&o.vertical.show&&o.vertical.text.show&&(s+=o.vertical.text.paddingTop+o.vertical.text.paddingBottom+2*o.vertical.text.borderSize+o.vertical.text.size),Math.max(c,s)}},{key:"convertFromPixel",value:function(e){return this._chartStore.timeScaleStore().coordinateToDataIndex(e)}},{key:"convertToPixel",value:function(e){return this._chartStore.timeScaleStore().dataIndexToCoordinate(e)}}]),i}(Pi);function ar(r){var t=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var i,e=w(r);if(t){var n=w(this).constructor;i=Reflect.construct(e,arguments,n)}else i=e.apply(this,arguments);return F(this,i)}}var or=function(r){B(i,r);var t=ar(i);function i(){return A(this,i),t.apply(this,arguments)}return I(i,[{key:"_initBefore",value:function(){this._xAxis=new rr(this._chartStore)}},{key:"_createMainWidget",value:function(e,n){return new ir({container:e,chartStore:n.chartStore,xAxis:this._xAxis})}},{key:"xAxis",value:function(){return this._xAxis}},{key:"setWidth",value:function(e,n){jt(w(i.prototype),"setWidth",this).call(this,e,n),this._xAxis.setWidth(e)}},{key:"setHeight",value:function(e){jt(w(i.prototype),"setHeight",this).call(this,e),this._xAxis.setHeight(e)}}]),i}(yi),Ii="mouse",Ti="touch";function Nt(r){return r.type===Ti}function Kt(r){return r.type===Ii}function Mi(r,t){var i=Object.keys(r);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(r);t&&(e=e.filter(function(n){return Object.getOwnPropertyDescriptor(r,n).enumerable})),i.push.apply(i,e)}return i}function Oi(r){for(var t=1;arguments.length>t;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?Mi(Object(i),!0).forEach(function(e){Tt(r,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):Mi(Object(i)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(i,e))})}return r}var Te=0,Di=2;function Li(r){return r.getBoundingClientRect()||{left:0,top:0}}function Dt(r){return!!r.touches}function Me(r){r.cancelable&&r.preventDefault()}function Ri(r,t){var i=r.clientX-t.clientX,e=r.clientY-t.clientY;return Math.sqrt(i*i+e*e)}var Bi=function(){function r(t,i,e){A(this,r),this._target=t,this._handler=i,this._options=e,this._clickCount=0,this._clickTimeoutId=null,this._longTapTimeoutId=null,this._longTapActive=!1,this._mouseMoveStartPosition=null,this._moveExceededManhattanDistance=!1,this._cancelClick=!1,this._unsubscribeOutsideEvents=null,this._unsubscribeMousemove=null,this._unsubscribeRoot=null,this._startPinchMiddleCoordinate=null,this._startPinchDistance=0,this._pinchPrevented=!1,this._preventDragProcess=!1,this._mousePressed=!1,this._init()}return I(r,[{key:"setOptions",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};this._options=Oi(Oi({},this.options),t)}},{key:"destroy",value:function(){this._unsubscribeOutsideEvents!==null&&(this._unsubscribeOutsideEvents(),this._unsubscribeOutsideEvents=null),this._unsubscribeMousemove!==null&&(this._unsubscribeMousemove(),this._unsubscribeMousemove=null),this._unsubscribeRoot!==null&&(this._unsubscribeRoot(),this._unsubscribeRoot=null),this._clearLongTapTimeout(),this._resetClickTimeout()}},{key:"_mouseEnterHandler",value:function(t){var i=this;this._unsubscribeMousemove&&this._unsubscribeMousemove();var e=this._mouseMoveHandler.bind(this),n=this._mouseWheelHandler.bind(this);this._unsubscribeMousemove=function(){i._target.removeEventListener("mousemove",e),i._target.removeEventListener("wheel",n)},this._target.addEventListener("mousemove",e),this._target.addEventListener("wheel",n,{passive:!1}),Dt(t)&&this._mouseMoveHandler(t);var a=this._makeCompatEvent(t);this._processEvent(a,this._handler.mouseEnterEvent)}},{key:"_resetClickTimeout",value:function(){this._clickTimeoutId!==null&&clearTimeout(this._clickTimeoutId),this._clickCount=0,this._clickTimeoutId=null}},{key:"_mouseMoveHandler",value:function(t){if(!this._mousePressed||Dt(t)){var i=this._makeCompatEvent(t);this._processEvent(i,this._handler.mouseMoveEvent)}}},{key:"_mouseWheelHandler",value:function(t){var i=this._makeCompatEvent(t);t.localX=i.localX,t.localY=i.localY,this._processEvent(t,this._handler.mouseWheelEvent)}},{key:"_mouseMoveWithDownHandler",value:function(t){if((!("button"in t)||t.button===Te)&&this._startPinchMiddleCoordinate===null){var i=Dt(t);if(!this._preventDragProcess||!i){this._pinchPrevented=!0;var e=this._makeCompatEvent(t),n=this._mouseMoveStartPosition,a=Math.abs(n.x-e.pageX),o=Math.abs(n.y-e.pageY),c=a+o>5;if(c||!i){if(c&&!this._moveExceededManhattanDistance&&i){var s=.5*a;o>=s&&!this._options.treatVertTouchDragAsPageScroll||s>o&&!this._options.treatHorzTouchDragAsPageScroll||(this._preventDragProcess=!0)}c&&(this._moveExceededManhattanDistance=!0,this._cancelClick=!0,i&&this._clearLongTapTimeout()),this._preventDragProcess||(this._processEvent(e,this._handler.pressedMouseMoveEvent),i&&Me(t))}}}}},{key:"_mouseUpHandler",value:function(t){if(!("button"in t)||t.button===Te){var i=this._makeCompatEvent(t);this._clearLongTapTimeout(),this._mouseMoveStartPosition=null,this._mousePressed=!1,this._unsubscribeRoot&&(this._unsubscribeRoot(),this._unsubscribeRoot=null),Dt(t)&&this._mouseLeaveHandler(t),this._processEvent(i,this._handler.mouseUpEvent),++this._clickCount,this._clickTimeoutId&&this._clickCount>1?(this._processEvent(i,this._handler.mouseDoubleClickEvent),this._resetClickTimeout()):this._cancelClick||this._processEvent(i,this._handler.mouseClickEvent),Dt(t)&&(Me(t),this._mouseLeaveHandler(t),t.touches.length===0&&(this._longTapActive=!1))}}},{key:"_clearLongTapTimeout",value:function(){this._longTapTimeoutId!==null&&(clearTimeout(this._longTapTimeoutId),this._longTapTimeoutId=null)}},{key:"_mouseDownHandler",value:function(t){if(!("button"in t)||t.button===Te||t.button===Di){var i=this._makeCompatEvent(t);if("button"in t&&t.button===Di)this._processEvent(i,this._handler.mouseRightDownEvent);else{this._cancelClick=!1,this._moveExceededManhattanDistance=!1,this._preventDragProcess=!1,Dt(t)&&this._mouseEnterHandler(t),this._mouseMoveStartPosition={x:i.pageX,y:i.pageY},this._unsubscribeRoot&&(this._unsubscribeRoot(),this._unsubscribeRoot=null);var e=this._mouseMoveWithDownHandler.bind(this),n=this._mouseUpHandler.bind(this),a=this._target.ownerDocument.documentElement;this._unsubscribeRoot=function(){a.removeEventListener("touchmove",e),a.removeEventListener("touchend",n),a.removeEventListener("mousemove",e),a.removeEventListener("mouseup",n)},a.addEventListener("touchmove",e,{passive:!1}),a.addEventListener("touchend",n,{passive:!1}),this._clearLongTapTimeout(),Dt(t)&&t.touches.length===1?this._longTapTimeoutId=setTimeout(this._longTapHandler.bind(this,t),600):(a.addEventListener("mousemove",e),a.addEventListener("mouseup",n)),this._mousePressed=!0,this._processEvent(i,this._handler.mouseDownEvent),this._clickTimeoutId||(this._clickCount=0,this._clickTimeoutId=setTimeout(this._resetClickTimeout.bind(this),500))}}}},{key:"_init",value:function(){var t=this;this._target.addEventListener("mouseenter",this._mouseEnterHandler.bind(this)),this._target.addEventListener("touchcancel",this._clearLongTapTimeout.bind(this));var i,e=this._target.ownerDocument,n=function(a){t._handler.mouseDownOutsideEvent&&(a.target&&t._target.contains(a.target)||t._handler.mouseDownOutsideEvent())};this._unsubscribeOutsideEvents=function(){e.removeEventListener("mousedown",n),e.removeEventListener("touchstart",n)},e.addEventListener("mousedown",n),e.addEventListener("touchstart",n,{passive:!0}),this._target.addEventListener("mouseleave",this._mouseLeaveHandler.bind(this)),this._target.addEventListener("touchstart",this._mouseDownHandler.bind(this),{passive:!0}),i="ontouchstart"in window||!!(window.DocumentTouch&&document instanceof window.DocumentTouch),"onorientationchange"in window&&(navigator.maxTouchPoints||navigator.msMaxTouchPoints||i)||this._target.addEventListener("mousedown",this._mouseDownHandler.bind(this)),this._initPinch(),this._target.addEventListener("touchmove",function(){},{passive:!1})}},{key:"_initPinch",value:function(){var t=this;this._handler.pinchStartEvent===void 0&&this._handler.pinchEvent===void 0&&this._handler.pinchEndEvent===void 0||(this._target.addEventListener("touchstart",function(i){return t._checkPinchState(i.touches)},{passive:!0}),this._target.addEventListener("touchmove",function(i){if(i.touches.length===2&&t._startPinchMiddleCoordinate!==null&&t._handler.pinchEvent!==void 0){var e=Ri(i.touches[0],i.touches[1]);t._handler.pinchEvent(t._startPinchMiddleCoordinate,e/t._startPinchDistance),Me(i)}},{passive:!1}),this._target.addEventListener("touchend",function(i){t._checkPinchState(i.touches)}))}},{key:"_checkPinchState",value:function(t){t.length===1&&(this._pinchPrevented=!1),t.length!==2||this._pinchPrevented||this._longTapActive?this._stopPinch():this._startPinch(t)}},{key:"_startPinch",value:function(t){var i=Li(this._target);this._startPinchMiddleCoordinate={x:(t[0].clientX-i.left+(t[1].clientX-i.left))/2,y:(t[0].clientY-i.top+(t[1].clientY-i.top))/2},this._startPinchDistance=Ri(t[0],t[1]),this._handler.pinchStartEvent!==void 0&&this._handler.pinchStartEvent(),this._clearLongTapTimeout()}},{key:"_stopPinch",value:function(){this._startPinchMiddleCoordinate!==null&&(this._startPinchMiddleCoordinate=null,this._handler.pinchEndEvent!==void 0&&this._handler.pinchEndEvent())}},{key:"_mouseLeaveHandler",value:function(t){this._unsubscribeMousemove&&this._unsubscribeMousemove();var i=this._makeCompatEvent(t);this._processEvent(i,this._handler.mouseLeaveEvent)}},{key:"_longTapHandler",value:function(t){var i=this._makeCompatEvent(t);this._processEvent(i,this._handler.longTapEvent),this._cancelClick=!0,this._longTapActive=!0}},{key:"_processEvent",value:function(t,i){i&&i.call(this._handler,t)}},{key:"_makeCompatEvent",value:function(t){var i;i="touches"in t&&t.touches.length?t.touches[0]:"changedTouches"in t&&t.changedTouches.length?t.changedTouches[0]:t;var e=Li(this._target);return{clientX:i.clientX,clientY:i.clientY,pageX:i.pageX,pageY:i.pageY,screenX:i.screenX,screenY:i.screenY,localX:i.clientX-e.left,localY:i.clientY-e.top,ctrlKey:t.ctrlKey,altKey:t.altKey,shiftKey:t.shiftKey,metaKey:t.metaKey,type:t.type.startsWith("mouse")?Ii:Ti,target:i.target,view:t.view}}}]),r}(),sr=function(){function r(t,i,e,n,a,o){A(this,r),this._chartStore=i,this._topPaneId=e,this._bottomPaneId=n,this._dragEnabled=a,this._width=0,this._offsetLeft=0,this._dragEventHandler=o,this._dragFlag=!1,this._initElement(t),this._initEvent(a)}return I(r,[{key:"_initElement",value:function(t){this._container=t,this._wrapper=lt("div",{margin:"0",padding:"0",position:"relative",boxSizing:"border-box"}),this._element=lt("div",{width:"100%",height:"7px",margin:"0",padding:"0",position:"absolute",top:"-3px",zIndex:"20",boxSizing:"border-box"}),this._wrapper.appendChild(this._element);var i=t.lastChild;i?t.insertBefore(this._wrapper,i):t.appendChild(this._wrapper)}},{key:"_initEvent",value:function(t){t&&(this._element.style.cursor="ns-resize",this._dragEvent=new Bi(this._element,{mouseDownEvent:this._mouseDownEvent.bind(this),mouseUpEvent:this._mouseUpEvent.bind(this),pressedMouseMoveEvent:this._pressedMouseMoveEvent.bind(this),mouseEnterEvent:this._mouseEnterEvent.bind(this),mouseLeaveEvent:this._mouseLeaveEvent.bind(this)},{treatVertTouchDragAsPageScroll:!1,treatHorzTouchDragAsPageScroll:!0}))}},{key:"_mouseDownEvent",value:function(t){this._dragFlag=!0,this._startY=t.pageY,this._dragEventHandler.startDrag(this._topPaneId,this._bottomPaneId)}},{key:"_mouseUpEvent",value:function(){this._dragFlag=!1,this._chartStore.setDragPaneFlag(!1)}},{key:"_pressedMouseMoveEvent",value:function(t){this._dragEventHandler.drag(t.pageY-this._startY,this._topPaneId,this._bottomPaneId),this._chartStore.setDragPaneFlag(!0),this._chartStore.crosshairStore().set()}},{key:"_mouseEnterEvent",value:function(){var t=this._chartStore.styleOptions().separator;this._element.style.background=t.activeBackgroundColor,this._chartStore.crosshairStore().set()}},{key:"_mouseLeaveEvent",value:function(){this._dragFlag||(this._element.style.background=null,this._chartStore.setDragPaneFlag(!1))}},{key:"height",value:function(){return this._wrapper.offsetHeight}},{key:"setSize",value:function(t,i){this._offsetLeft=t,this._width=i,this.invalidate()}},{key:"setDragEnabled",value:function(t){t!==this._dragEnabled&&(this._dragEnabled=t,t?!this._dragEvent&&this._initEvent(t):(this._element.style.cursor="default",this._dragEvent&&this._dragEvent.destroy(),this._dragEvent=null))}},{key:"topPaneId",value:function(){return this._topPaneId}},{key:"bottomPaneId",value:function(){return this._bottomPaneId}},{key:"updatePaneId",value:function(t,i){E(t)&&(this._topPaneId=t),E(i)&&(this._bottomPaneId=i)}},{key:"invalidate",value:function(){var t=this._chartStore.styleOptions().separator;this._element.style.top="".concat(-Math.floor((7-t.size)/2),"px"),this._wrapper.style.backgroundColor=t.color,this._wrapper.style.height="".concat(t.size,"px"),this._wrapper.style.marginLeft="".concat(t.fill?0:this._offsetLeft,"px"),this._wrapper.style.width=t.fill?"100%":"".concat(this._width,"px")}},{key:"getImage",value:function(){var t=this._chartStore.styleOptions().separator,i=this._wrapper.offsetWidth,e=t.size,n=lt("canvas",{width:"".concat(i,"px"),height:"".concat(e,"px"),boxSizing:"border-box"}),a=n.getContext("2d"),o=Vt(n);return n.width=i*o,n.height=e*o,a.scale(o,o),a.fillStyle=t.color,a.fillRect(this._offsetLeft,0,i,e),n}},{key:"destroy",value:function(){this._dragEvent&&this._dragEvent.destroy(),this._container.removeChild(this._wrapper)}}]),r}(),Oe=I(function r(t){A(this,r),this._chartStore=t});function cr(r){var t=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var i,e=w(r);if(t){var n=w(this).constructor;i=Reflect.construct(e,arguments,n)}else i=e.apply(this,arguments);return F(this,i)}}var hr=function(r){B(i,r);var t=cr(i);function i(e){var n;return A(this,i),(n=t.call(this,e))._startScrollCoordinate=null,n._touchCoordinate=null,n._touchCancelCrosshair=!1,n._touchZoomed=!1,n._pinchScale=1,n}return I(i,[{key:"pinchStartEvent",value:function(){this._pinchScale=1,this._touchZoomed=!0}},{key:"pinchEvent",value:function(e,n){var a=5*(n-this._pinchScale);this._pinchScale=n,this._chartStore.timeScaleStore().zoom(a,e)}},{key:"mouseUpEvent",value:function(){this._startScrollCoordinate=null}},{key:"mouseLeaveEvent",value:function(e){this._startScrollCoordinate=null,Kt(e)&&this._chartStore.crosshairStore().set()}},{key:"mouseMoveEvent",value:function(e){Kt(e)&&this._chartStore.crosshairStore().set({x:e.localX,y:e.paneY,paneId:e.paneId})}},{key:"mouseWheelEvent",value:function(e){if(Math.abs(e.deltaX)>Math.abs(e.deltaY)){if(e.cancelable&&e.preventDefault(),Math.abs(e.deltaX)===0)return;this._chartStore.timeScaleStore().startScroll(),this._chartStore.timeScaleStore().scroll(-e.deltaX)}else{var n=-e.deltaY/100;if(n===0)return;switch(e.cancelable&&e.preventDefault(),e.deltaMode){case e.DOM_DELTA_PAGE:n*=120;break;case e.DOM_DELTA_LINE:n*=32}if(n!==0){var a=Math.sign(n)*Math.min(1,Math.abs(n));this._chartStore.timeScaleStore().zoom(a,{x:e.localX,y:e.localY})}}}},{key:"mouseClickEvent",value:function(e){Nt(e)&&(this._touchCoordinate||this._touchCancelCrosshair||this._touchZoomed||(this._touchCoordinate={x:e.localX,y:e.localY},this._chartStore.crosshairStore().set({x:e.localX,y:e.paneY,paneId:e.paneId})))}},{key:"mouseDownEvent",value:function(e){if(this._startScrollCoordinate={x:e.localX,y:e.localY},this._chartStore.timeScaleStore().startScroll(),Nt(e))if(this._touchZoomed=!1,this._touchCoordinate){var n=e.localX-this._touchCoordinate.x,a=e.localY-this._touchCoordinate.y;10>Math.sqrt(n*n+a*a)?(this._touchCoordinate={x:e.localX,y:e.localY},this._chartStore.crosshairStore().set({x:e.localX,y:e.paneY,paneId:e.paneId})):(this._touchCancelCrosshair=!0,this._touchCoordinate=null,this._chartStore.crosshairStore().set())}else this._touchCancelCrosshair=!1}},{key:"pressedMouseMoveEvent",value:function(e){var n={x:e.localX,y:e.paneY,paneId:e.paneId};if(Nt(e)){if(this._touchCoordinate)return this._touchCoordinate={x:e.localX,y:e.localY},void this._chartStore.crosshairStore().set(n);n=null}if(this._startScrollCoordinate){var a=e.localX-this._startScrollCoordinate.x;this._chartStore.timeScaleStore().scroll(a,n)}}},{key:"longTapEvent",value:function(e){Nt(e)&&(this._touchCoordinate={x:e.localX,y:e.localY},this._chartStore.crosshairStore().set({x:e.localX,y:e.paneY,paneId:e.paneId}))}}]),i}(Oe);function Fi(r,t){var i=Object.keys(r);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(r);t&&(e=e.filter(function(n){return Object.getOwnPropertyDescriptor(r,n).enumerable})),i.push.apply(i,e)}return i}function lr(r){for(var t=1;arguments.length>t;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?Fi(Object(i),!0).forEach(function(e){Tt(r,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):Fi(Object(i)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(i,e))})}return r}function De(r,t){var i=typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(!i){if(Array.isArray(r)||(i=function(s,h){if(!!s){if(typeof s=="string")return zi(s,h);var l=Object.prototype.toString.call(s).slice(8,-1);if(l==="Object"&&s.constructor&&(l=s.constructor.name),l==="Map"||l==="Set")return Array.from(s);if(l==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(l))return zi(s,h)}}(r))||t&&r&&typeof r.length=="number"){i&&(r=i);var e=0,n=function(){};return{s:n,n:function(){return r.length>e?{done:!1,value:r[e++]}:{done:!0}},e:function(s){throw s},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a,o=!0,c=!1;return{s:function(){i=i.call(r)},n:function(){var s=i.next();return o=s.done,s},e:function(s){c=!0,a=s},f:function(){try{o||i.return==null||i.return()}finally{if(c)throw a}}}}function zi(r,t){(t==null||t>r.length)&&(t=r.length);for(var i=0,e=Array(t);t>i;i++)e[i]=r[i];return e}function ur(r){var t=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var i,e=w(r);if(t){var n=w(this).constructor;i=Reflect.construct(e,arguments,n)}else i=e.apply(this,arguments);return F(this,i)}}var fr=function(r){B(i,r);var t=ur(i);function i(e,n){var a;return A(this,i),(a=t.call(this,e))._yAxis=n,a}return I(i,[{key:"_performOverlayMouseHover",value:function(e,n,a,o){var c;if(e){var s,h=De(e);try{for(h.s();!(s=h.n()).done&&!(c=s.value.checkEventCoordinateOn(a)););}catch(l){h.e(l)}finally{h.f()}c&&n.id===c.id||(n.id&&n.instance&&Kt(o)&&n.instance.onMouseLeave({id:n.id,points:n.instance.points(),event:o}),c&&c.id!==n.id&&c.instance&&Kt(o)&&c.instance.onMouseEnter({id:c.id,points:c.instance.points(),event:o}))}return c}},{key:"mouseUpEvent",value:function(){this._chartStore.shapeStore().updatePressedInstance()}},{key:"mouseMoveEvent",value:function(e){if(Kt(e)){if(this._waitingForMouseMove)return!1;this._waitingForMouseMove=!0;var n,a,o,c={x:e.localX,y:e.paneY},s=this._chartStore.shapeStore().progressInstance(),h=s.instance,l=s.paneId;if(h&&h.isDrawing())e.paneId&&(h.isStart()&&this._chartStore.shapeStore().updateProgressInstance(this._yAxis(e.paneId),e.paneId),l===e.paneId&&h.mouseMoveForDrawing(c,e),n={id:h.id(),element:gt,elementIndex:h.points().length-1}),a={id:"",element:wt,elementIndex:-1};else{var u=this._chartStore.annotationStore().get(e.paneId),f=this._chartStore.shapeStore().instances(e.paneId),d=this._chartStore.shapeStore().eventOperate().hover,v=this._chartStore.annotationStore().eventOperate();n=this._performOverlayMouseHover(f,d,c,e),o=this._performOverlayMouseHover(u,v,c,e)}this._chartStore.shapeStore().setEventOperate({hover:n||{id:"",element:wt,elementIndex:-1},click:a}),this._chartStore.annotationStore().setEventOperate(o||{id:""}),this._waitingForMouseMove=!1}}},{key:"mouseDownEvent",value:function(e){var n,a={x:e.localX,y:e.paneY},o=this._chartStore.shapeStore().progressInstance(),c=o.instance,s={id:"",element:wt,elementIndex:-1},h=o.paneId;if(c&&c.isDrawing())Nt(e)&&(c.isStart()&&(this._chartStore.shapeStore().updateProgressInstance(this._yAxis(e.paneId),e.paneId),h=e.paneId),h===e.paneId&&c.mouseMoveForDrawing(a,e)),h===e.paneId&&(c.mouseLeftButtonDownForDrawing(),n={id:c.id(),element:gt,elementIndex:c.points().length-1},s={id:c.id(),element:gt,elementIndex:c.points().length-1});else{var l,u=De(this._chartStore.shapeStore().instances(e.paneId));try{for(u.s();!(l=u.n()).done;){var f=l.value;if(n=f.checkEventCoordinateOn(a)){this._chartStore.shapeStore().updatePressedInstance(f,e.paneId,n.element),n.element===gt?s=lr({},n):f.startPressedOtherMove(a),f.onClick({id:n.id,points:f.points(),event:e});break}}}catch(y){u.e(y)}finally{u.f()}var d=this._chartStore.annotationStore().get(e.paneId);if(d){var v,p=De(d);try{for(p.s();!(v=p.n()).done;){var _=v.value,m=_.checkEventCoordinateOn(a);if(m){_.onClick({id:m.id,points:_.points(),event:e});break}}}catch(y){p.e(y)}finally{p.f()}}}this._chartStore.shapeStore().setEventOperate({hover:s,click:n||{id:"",element:wt,elementIndex:-1}})&&this._chartStore.invalidate(ht)}},{key:"mouseRightDownEvent",value:function(e){var n,a=this._chartStore.shapeStore().progressInstance().instance;a?n=a:n=this._chartStore.shapeStore().instances(e.paneId).find(function(s){return s.checkEventCoordinateOn({x:e.localX,y:e.paneY})}),n&&!n.onRightClick({id:n.id(),points:n.points(),event:e})&&this._chartStore.shapeStore().removeInstance(n.id());var o=this._chartStore.annotationStore().get(e.paneId);if(o){var c=o.find(function(s){return s.checkEventCoordinateOn({x:e.localX,y:e.paneY})});c&&c.onRightClick({id:c.id(),points:c.points(),event:e})}}},{key:"pressedMouseMoveEvent",value:function(e){var n=this._chartStore.shapeStore().pressedInstance(),a=n.instance;if(a&&n.paneId===e.paneId){var o={x:e.localX,y:e.paneY};n.element===gt?a.mousePressedPointMove(o,e):a.mousePressedOtherMove(o,e),this._chartStore.crosshairStore().set({x:e.localX,y:e.paneY,paneId:e.paneId})}}}]),i}(Oe);function dr(r){var t=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var i,e=w(r);if(t){var n=w(this).constructor;i=Reflect.construct(e,arguments,n)}else i=e.apply(this,arguments);return F(this,i)}}var vr="Equal",pr="Minus",_r="ArrowLeft",mr="ArrowRight",yr=function(r){B(i,r);var t=dr(i);function i(){return A(this,i),t.apply(this,arguments)}return I(i,[{key:"keyBoardDownEvent",value:function(e){if(e.shiftKey)switch(e.code){case vr:this._chartStore.timeScaleStore().zoom(.5);break;case pr:this._chartStore.timeScaleStore().zoom(-.5);break;case _r:this._chartStore.timeScaleStore().startScroll(),this._chartStore.timeScaleStore().scroll(-3*this._chartStore.timeScaleStore().dataSpace());break;case mr:this._chartStore.timeScaleStore().startScroll(),this._chartStore.timeScaleStore().scroll(3*this._chartStore.timeScaleStore().dataSpace())}}}]),i}(Oe),gr=function(){function r(t,i,e){A(this,r),this._target=t,this._chartStore=i,this._chartContentLeftRight={},this._chartContentTopBottom={},this._paneContentSize={},this._event=new Bi(this._target,{pinchStartEvent:this._pinchStartEvent.bind(this),pinchEvent:this._pinchEvent.bind(this),mouseUpEvent:this._mouseUpEvent.bind(this),mouseClickEvent:this._mouseClickEvent.bind(this),mouseDownEvent:this._mouseDownEvent.bind(this),mouseRightDownEvent:this._mouseRightDownEvent.bind(this),mouseLeaveEvent:this._mouseLeaveEvent.bind(this),mouseMoveEvent:this._mouseMoveEvent.bind(this),mouseWheelEvent:this._mouseWheelEvent.bind(this),pressedMouseMoveEvent:this._pressedMouseMoveEvent.bind(this),longTapEvent:this._longTapEvent.bind(this)},{treatVertTouchDragAsPageScroll:!0,treatHorzTouchDragAsPageScroll:!1}),this._boundKeyBoardDownEvent=this._keyBoardDownEvent.bind(this),this._target.addEventListener("keydown",this._boundKeyBoardDownEvent),this._boundContextMenuEvent=function(n){n.preventDefault()},this._target.addEventListener("contextmenu",this._boundContextMenuEvent,!1),this._zoomScrollEventHandler=new hr(i),this._overlayEventHandler=new fr(i,e),this._keyBoardEventHandler=new yr(i)}return I(r,[{key:"_keyBoardDownEvent",value:function(t){this._keyBoardEventHandler.keyBoardDownEvent(t)}},{key:"_pinchStartEvent",value:function(){this._zoomScrollEventHandler.pinchStartEvent()}},{key:"_pinchEvent",value:function(t,i){this._zoomScrollEventHandler.pinchEvent(t,i)}},{key:"_mouseUpEvent",value:function(t){this._checkEventInChartContent(t)&&(this._target.style.cursor="crosshair"),this._zoomScrollEventHandler.mouseUpEvent(t),this._shouldPerformOverlayEvent()&&this._overlayEventHandler.mouseUpEvent(t)}},{key:"_mouseLeaveEvent",value:function(t){this._zoomScrollEventHandler.mouseLeaveEvent(t)}},{key:"_mouseMoveEvent",value:function(t){if(t.target instanceof HTMLCanvasElement)if(this._checkEventInChartContent(t)){this._target.style.cursor="crosshair";var i=this._compatChartEvent(t,!0);this._shouldPerformOverlayEvent()&&this._overlayEventHandler.mouseMoveEvent(i),this._chartStore.dragPaneFlag()||this._zoomScrollEventHandler.mouseMoveEvent(i)}else this._target.style.cursor="default",this._zoomScrollEventHandler.mouseLeaveEvent(t);else this._target.style.cursor="default",this._chartStore.crosshairStore().set()}},{key:"_mouseWheelEvent",value:function(t){this._checkZoomScroll()&&this._checkEventInChartContent(t)&&this._zoomScrollEventHandler.mouseWheelEvent(this._compatChartEvent(t))}},{key:"_mouseClickEvent",value:function(t){this._checkZoomScroll()&&this._checkEventInChartContent(t)&&(this._zoomScrollEventHandler.mouseClickEvent(this._compatChartEvent(t,!0)),this._modifyEventOptions(t))}},{key:"_mouseDownEvent",value:function(t){if(this._checkEventInChartContent(t)){this._target.style.cursor="pointer";var i=this._compatChartEvent(t,!0);this._shouldPerformOverlayEvent()&&this._overlayEventHandler.mouseDownEvent(i),this._checkZoomScroll()&&(this._zoomScrollEventHandler.mouseDownEvent(i),this._modifyEventOptions(t))}}},{key:"_mouseRightDownEvent",value:function(t){this._shouldPerformOverlayEvent()&&this._checkEventInChartContent(t)&&this._overlayEventHandler.mouseRightDownEvent(this._compatChartEvent(t,!0))}},{key:"_pressedMouseMoveEvent",value:function(t){if(this._checkEventInChartContent(t)){var i=this._compatChartEvent(t,!0);this._checkZoomScroll()?(this._zoomScrollEventHandler.pressedMouseMoveEvent(i),this._modifyEventOptions(t)):this._overlayEventHandler.pressedMouseMoveEvent(i)}}},{key:"_longTapEvent",value:function(t){this._checkZoomScroll()&&this._checkEventInChartContent(t)&&(this._zoomScrollEventHandler.longTapEvent(this._compatChartEvent(t,!0)),this._modifyEventOptions(t))}},{key:"_checkZoomScroll",value:function(){return!this._chartStore.dragPaneFlag()&&!this._chartStore.shapeStore().isPressed()&&!this._chartStore.shapeStore().isDrawing()}},{key:"_shouldPerformOverlayEvent",value:function(){return!this._chartStore.shapeStore().isEmpty()||!this._chartStore.annotationStore().isEmpty()}},{key:"_modifyEventOptions",value:function(t){Nt(t)&&this._chartStore.crosshairStore().get().paneId?this._event.setOptions({treatVertTouchDragAsPageScroll:!1}):this._event.setOptions({treatVertTouchDragAsPageScroll:!0})}},{key:"_compatChartEvent",value:function(t,i){if(i){for(var e in this._paneContentSize)if(Object.prototype.hasOwnProperty.call(this._paneContentSize,e)){var n=this._paneContentSize[e];if(t.localY>n.contentTop&&n.contentBottom>t.localY){t.paneY=t.localY-n.contentTop,t.paneId=e;break}}}return t.localX-=this._chartContentLeftRight.contentLeft,t}},{key:"_checkEventInChartContent",value:function(t){return t.localX>this._chartContentLeftRight.contentLeft&&this._chartContentLeftRight.contentRight>t.localX&&t.localY>this._chartContentTopBottom.contentTop&&this._chartContentTopBottom.contentBottom>t.localY}},{key:"setChartContentLeftRight",value:function(t){this._chartContentLeftRight=t}},{key:"setChartContentTopBottom",value:function(t){this._chartContentTopBottom=t}},{key:"setPaneContentSize",value:function(t){this._paneContentSize=t}},{key:"destroy",value:function(){this._event.destroy(),this._target.removeEventListener("keydown",this._boundKeyBoardDownEvent),this._target.removeEventListener("contextmenu",this._boundContextMenuEvent)}}]),r}();function xr(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:20,i=0;return function(){var e=Date.now(),n=this,a=arguments;e-i>t&&(r.apply(n,a),i=e)}}function Sr(r){var t=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var i,e=w(r);if(t){var n=w(this).constructor;i=Reflect.construct(e,arguments,n)}else i=e.apply(this,arguments);return F(this,i)}}var kr=function(r){B(i,r);var t=Sr(i);function i(e){var n,a=e.id,o=e.point,c=e.chartStore,s=e.xAxis,h=e.yAxis,l=e.styles;return A(this,i),(n=t.call(this,{id:a,chartStore:c,xAxis:s,yAxis:h}))._point=o,n._symbolCoordinate={},n.setStyles(l,c.styleOptions().annotation),n}return I(i,[{key:"_drawSymbol",value:function(e,n,a){var o=this._chartStore.timeScaleStore().barSpace(),c=a.symbol,s=c.size,h=c.activeSize,l=n?O(h)?h:o:O(s)?s:o,u=n?c.activeColor:c.color;switch(c.type){case Ye:ke(e,u,this._symbolCoordinate,l/2);break;case We:(function(f,d,v,p,_,m){f.fillStyle=d,f.fillRect(v,p,_,m)})(e,u,this._symbolCoordinate.x-l/2,this._symbolCoordinate.y-l/2,l,l);break;case ve:(function(f,d,v,p,_){f.fillStyle=d,f.beginPath(),f.moveTo(v.x-p/2,v.y),f.lineTo(v.x,v.y-_/2),f.lineTo(v.x+p/2,v.y),f.lineTo(v.x,v.y+_/2),f.closePath(),f.fill()})(e,u,this._symbolCoordinate,l,l);break;case Xe:(function(f,d,v,p,_){f.fillStyle=d,f.beginPath(),f.moveTo(v.x-p/2,v.y+_/2),f.lineTo(v.x,v.y-_/2),f.lineTo(v.x+p/2,v.y+_/2),f.closePath(),f.fill()})(e,u,this._symbolCoordinate,l,l);break;case Ge:e.save(),this.drawCustomSymbol({ctx:e,point:this._point,coordinate:this._symbolCoordinate,viewport:{width:this._xAxis.width(),height:this._yAxis.height(),barSpace:o},styles:c,isActive:n}),e.restore()}}},{key:"draw",value:function(e){var n=this._styles||this._chartStore.styleOptions().annotation,a=n.offset||[0,0],o=0;switch(n.position){case Ue:o=this._yAxis.convertToPixel(this._point.value);break;case pe:o=0;break;case Ze:o=this._yAxis.height()}this._symbolCoordinate.y=o+a[0];var c=this._id===this._chartStore.annotationStore().eventOperate().id;this._drawSymbol(e,c,n),this.drawExtend&&(e.save(),this.drawExtend({ctx:e,point:this._point,coordinate:this._symbolCoordinate,viewport:{width:this._xAxis.width(),height:this._yAxis.height()},styles:n,isActive:c}),e.restore())}},{key:"checkEventCoordinateOn",value:function(e){var n,a,o,c,s,h=this._chartStore.timeScaleStore().barSpace(),l=(this._styles||this._chartStore.styleOptions().annotation).symbol,u=O(l.size)?l.size:h;switch(l.type){case Ye:n=ii(this._symbolCoordinate,u/2,e);break;case We:n=function(f,d,v){return!(f.x>v.x||v.x>d.x||f.y>v.y||v.y>d.y)}({x:this._symbolCoordinate.x-u/2,y:this._symbolCoordinate.y-u/2},{x:this._symbolCoordinate.x+u/2,y:this._symbolCoordinate.y+u/2},e);break;case ve:n=(o=u)*(c=u)/2+2>Math.abs((a=this._symbolCoordinate).x-(s=e).x)*c+Math.abs(a.y-s.y)*o;break;case Xe:n=function(f,d){var v=ie(f[0],f[1],f[2]),p=ie(f[0],f[1],d)+ie(f[0],f[2],d)+ie(f[1],f[2],d);return 2>Math.abs(v-p)}([{x:this._symbolCoordinate.x-u/2,y:this._symbolCoordinate.y+u/2},{x:this._symbolCoordinate.x,y:this._symbolCoordinate.y-u/2},{x:this._symbolCoordinate.x+u/2,y:this._symbolCoordinate.y+u/2}],e);break;case Ge:n=this.checkEventCoordinateOnCustomSymbol({eventCoordinate:e,coordinate:this._symbolCoordinate,size:u})}if(n)return{id:this._id,instance:this}}},{key:"createSymbolCoordinate",value:function(e){var n=this._styles||this._chartStore.styleOptions().annotation;this._symbolCoordinate={x:e+(n.offset||[0,0])[1]}}},{key:"points",value:function(){return this._point}},{key:"checkEventCoordinateOnCustomSymbol",value:function(e){}},{key:"drawCustomSymbol",value:function(e){}}]),i}(Se);function wr(r){var t=function(){if(typeof Reflect=="undefined"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}();return function(){var i,e=w(r);if(t){var n=w(this).constructor;i=Reflect.construct(e,arguments,n)}else i=e.apply(this,arguments);return F(this,i)}}var br=function(r){B(i,r);var t=wr(i);function i(e){var n,a=e.id,o=e.point,c=e.text,s=e.mark,h=e.chartStore,l=e.xAxis,u=e.yAxis,f=e.styles;return A(this,i),(n=t.call(this,{id:a,chartStore:h,xAxis:l,yAxis:u}))._point=o||{},n._text=c,n._mark=s,n.setStyles(f,h.styleOptions().tag),n}return I(i,[{key:"update",value:function(e){var n=e.point,a=e.text,o=e.mark,c=e.styles,s=!1;return L(n)&&(this._point=n,s=!0),E(a)&&(this._text=a,s=!0),E(o)&&(this._mark=o,s=!0),this.setStyles(c,this._chartStore.styleOptions().tag)&&(s=!0),s}},{key:"drawMarkLine",value:function(e){var n=this._chartStore.styleOptions(),a=n.yAxis,o=this._styles||n.tag,c=this._getY(o);e.save(),this._drawLine(e,c,o,a),this._drawMark(e,c,o,a),e.restore()}},{key:"drawText",value:function(e){if(E(this._text)){var n=this._chartStore.styleOptions(),a=this._styles||n.tag,o=a.text;e.save();var c,s=Ot(e,this._text,o),h=ae(o);c=this._yAxis.isFromYAxisZero()?0:this._yAxis.width()-s;var l=this._getY(a);oe(e,o.backgroundColor,o.borderColor,o.borderSize,c,l-h/2,s,h,o.borderRadius),ut(e,o.color,c+o.paddingLeft,l,this._text),e.restore()}}},{key:"_drawLine",value:function(e,n,a,o){var c=a.line;if(c.show){e.save();var s=Ot(e,this._text,a.text),h=Ot(e,this._mark,a.mark);e.strokeStyle=c.color,e.lineWidth=c.size,c.style===et&&e.setLineDash(c.dashValue);var l=a.mark.offset,u=[],f=E(this._text),d=E(this._mark);o.inside?o.position===Bt?f&&d?l>0?(u.push([s,s+l]),u.push([s+l+h,this._xAxis.width()])):u.push(Math.min(s,h)>Math.abs(l)?[s+l+h,this._xAxis.width()]:[Math.max(s,h),this._xAxis.width()]):f?u.push([s,this._xAxis.width()]):d?l>0?(u.push([0,l]),u.push([l+h,this._xAxis.width()])):u.push(h>Math.abs(l)?[l+h,this._xAxis.width()]:[0,this._xAxis.width()]):u.push([0,this._xAxis.width()]):f&&d?0>l?(u.push([0,this._xAxis.width()-s+l-h]),u.push([this._xAxis.width()-s+l,this._xAxis.width()-s])):u.push(Math.min(s,h)>l?[0,this._xAxis.width()-s-h+l]:[0,this._xAxis.width()-Math.max(s,h)]):f?u.push([0,this._xAxis.width()-s]):d?0>l?(u.push([0,this._xAxis.width()+l-h]),u.push([this._xAxis.width()+l,this._xAxis.width()])):u.push(h>l?[0,this._xAxis.width()-h+l]:[0,this._xAxis.width()]):u.push([0,this._xAxis.width()]):o.position===Bt?d?l>0?(u.push([0,l]),u.push([l+h,this._xAxis.width()])):u.push(h>Math.abs(l)?[h+l,this._xAxis.width()]:[0,this._xAxis.width()]):u.push([0,this._xAxis.width()]):d?0>l?(u.push([0,this._xAxis.width()-h+l]),u.push([this._xAxis.width()+l,this._xAxis.width()])):u.push(h>l?[0,this._xAxis.width()-h+l]:[0,this._xAxis.width()]):u.push([0,this._xAxis.width()]),u.forEach(function(v){Mt(e,n,v[0],v[1])}),e.restore()}}},{key:"_drawMark",value:function(e,n,a,o){if(E(this._mark)){var c,s=a.mark,h=Ot(e,this._mark,s),l=ae(s);if(o.inside){var u=0;E(this._text)&&(u=Ot(e,this._text,a.text)),c=o.position===Bt?u:this._xAxis.width()-u-h}else c=o.position===Bt?0:this._xAxis.width()-h;oe(e,s.backgroundColor,s.borderColor,s.borderSize,c+=s.offset,n-l/2,h,l,s.borderRadius),e.textBaseline="middle",e.font=q(s.size,s.weight,s.family),ut(e,s.color,c+s.paddingLeft,n,this._mark)}}},{key:"_getY",value:function(e){var n=e.offset;switch(e.position){case pe:return n;case Ze:return this._yAxis.height()+n;default:return this._yAxis.convertToNicePixel(this._point.value)+n}}}]),i}(Se);function Vi(r,t){var i=typeof Symbol!="undefined"&&r[Symbol.iterator]||r["@@iterator"];if(!i){if(Array.isArray(r)||(i=function(s,h){if(!!s){if(typeof s=="string")return ji(s,h);var l=Object.prototype.toString.call(s).slice(8,-1);if(l==="Object"&&s.constructor&&(l=s.constructor.name),l==="Map"||l==="Set")return Array.from(s);if(l==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(l))return ji(s,h)}}(r))||t&&r&&typeof r.length=="number"){i&&(r=i);var e=0,n=function(){};return{s:n,n:function(){return r.length>e?{done:!1,value:r[e++]}:{done:!0}},e:function(s){throw s},f:n}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var a,o=!0,c=!1;return{s:function(){i=i.call(r)},n:function(){var s=i.next();return o=s.done,s},e:function(s){c=!0,a=s},f:function(){try{o||i.return==null||i.return()}finally{if(c)throw a}}}}function ji(r,t){(t==null||t>r.length)&&(t=r.length);for(var i=0,e=Array(t);t>i;i++)e[i]=r[i];return e}var Er="technical_indicator_pane_",it="candle_pane",Pr=function(){function r(t,i){var e=this;A(this,r),this._initChartContainer(t),this._shapeBaseId=0,this._paneBaseId=0,this._separatorDragStartTopPaneHeight=0,this._separatorDragStartBottomPaneHeight=0,this._chartStore=new Tn(i,{invalidate:this._invalidatePane.bind(this),crosshair:this._crosshairObserver.bind(this)}),this._xAxisPane=new or({id:"x_axis_pane",container:this._chartContainer,chartStore:this._chartStore}),this._panes=new Map([[it,new qn({container:this._chartContainer,chartStore:this._chartStore,xAxis:this._xAxisPane.xAxis(),id:it})]]),this._separators=new Map,this._chartWidth={},this._chartHeight={},this._chartEvent=new gr(this._chartContainer,this._chartStore,function(n){return e._panes.get(n).yAxis()}),this.adjustPaneViewport(!0,!0,!0)}return I(r,[{key:"_initChartContainer",value:function(t){this._container=t,this._chartContainer=lt("div",{userSelect:"none",webkitUserSelect:"none",msUserSelect:"none",MozUserSelect:"none",webkitTapHighlightColor:"transparent",position:"relative",outline:"none",borderStyle:"none",width:"100%",cursor:"crosshair",boxSizing:"border-box"}),this._chartContainer.tabIndex=1,t.appendChild(this._chartContainer)}},{key:"_crosshairObserver",value:function(t){var i=this,e=t.paneId,n=t.dataIndex,a=t.kLineData,o=t.x,c=t.y;if(this._chartStore.actionStore().has(St.CROSSHAIR)||this._chartStore.actionStore().has(St.TOOLTIP)){var s={};this._panes.forEach(function(h,l){var u={},f=[];i.chartStore().technicalIndicatorStore().instances(l).forEach(function(d){var v=d.result[n];u[d.name]=v,f.push({name:d.name,data:v})}),s[l]=u,i._chartStore.actionStore().execute(St.TOOLTIP,{paneId:l,dataIndex:n,kLineData:a,technicalIndicatorData:f})}),e&&this._chartStore.actionStore().execute(St.CROSSHAIR,{paneId:e,coordinate:{x:o,y:c},dataIndex:n,kLineData:a,technicalIndicatorData:s})}}},{key:"_separatorStartDrag",value:function(t,i){this._separatorDragStartTopPaneHeight=this._panes.get(t).height(),this._separatorDragStartBottomPaneHeight=this._panes.get(i).height()}},{key:"_separatorDrag",value:function(t,i,e){var n=this._separatorDragStartTopPaneHeight+t,a=this._separatorDragStartBottomPaneHeight-t;n>this._separatorDragStartTopPaneHeight+this._separatorDragStartBottomPaneHeight&&(n=this._separatorDragStartTopPaneHeight+this._separatorDragStartBottomPaneHeight,a=0),0>n&&(n=0,a=this._separatorDragStartTopPaneHeight+this._separatorDragStartBottomPaneHeight),this._panes.get(i).setHeight(n),this._panes.get(e).setHeight(a),this._chartStore.actionStore().execute(St.PANE_DRAG,{topPaneId:i,bottomPaneId:e,topPaneHeight:n,bottomPaneHeight:a}),this.adjustPaneViewport(!0,!0,!0,!0,!0)}},{key:"_invalidatePane",value:function(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:Pe;if(t===ht)this._xAxisPane.invalidate(t),this._panes.forEach(function(e){e.invalidate(t)});else{var i=!1;this._panes.forEach(function(e){var n=e.yAxis().computeAxis();n&&(i=n)}),this.adjustPaneViewport(!1,i,!0)}}},{key:"_measurePaneHeight",value:function(){var t=this,i=this._chartStore.styleOptions(),e=this._container.offsetHeight,n=i.separator.size,a=n*this._separators.size,o=this._xAxisPane.xAxis().getSelfHeight(),c=e-o-a,s=0;this._panes.forEach(function(d){if(d.id()!==it){var v=d.height();s+v>c?(d.setHeight(c-s),s=c):s+=v}});var h=c-s,l={};l.candle_pane={contentTop:0,contentBottom:h};var u=h,f=h;this._panes.get(it).setHeight(h),this._chartHeight.candle_pane=h,this._panes.forEach(function(d){if(d.id()!==it){var v=d.height();f+=v+n,l[d.id()]={contentTop:u,contentBottom:f},t._chartHeight[d.id()]=v,u=f}}),this._xAxisPane.setHeight(o),this._chartHeight.xAxis=o,this._chartHeight.total=e,this._chartEvent.setPaneContentSize(l),this._chartEvent.setChartContentTopBottom({contentTop:0,contentBottom:f})}},{key:"_measurePaneWidth",value:function(){var t,i,e,n=this,a=this._chartStore.styleOptions().yAxis,o=a.position===Bt,c=this._container.offsetWidth,s=Number.MIN_SAFE_INTEGER;a.inside?(t=c,s=c,i=0,e=0):(this._panes.forEach(function(h){s=Math.max(s,h.yAxis().getSelfWidth())}),t=c-s,o?(i=0,e=s):(e=0,i=c-s)),this._chartStore.timeScaleStore().setTotalDataSpace(t),this._panes.forEach(function(h,l){h.setWidth(t,s),h.setOffsetLeft(e,i);var u=n._separators.get(l);u&&u.setSize(e,t)}),this._chartWidth={content:t,yAxis:s,total:c},this._xAxisPane.setWidth(t,s),this._xAxisPane.setOffsetLeft(e,i),this._chartEvent.setChartContentLeftRight({contentLeft:e,contentRight:e+t})}},{key:"adjustPaneViewport",value:function(t,i,e,n,a){t&&this._measurePaneHeight();var o=!1;n&&this._panes.forEach(function(c){var s=c.yAxis().computeAxis(a);o||(o=s)}),(!n&&i||n&&o)&&this._measurePaneWidth(),e&&(this._xAxisPane.xAxis().computeAxis(!0),this._xAxisPane.layout(),this._panes.forEach(function(c){c.layout()}))}},{key:"hasPane",value:function(t){return this._panes.has(t)}},{key:"getPane",value:function(t){return this._panes.get(t)}},{key:"chartStore",value:function(){return this._chartStore}},{key:"removeTechnicalIndicator",value:function(t,i){var e=this;if(this._chartStore.technicalIndicatorStore().removeInstance(t,i)){var n=!1;if(t!==it&&!this._chartStore.technicalIndicatorStore().hasInstance(t)){n=!0,this._panes.get(t).destroy();var a=this._separators.get(t).topPaneId();this._separators.get(t).destroy(),this._panes.delete(t),this._separators.delete(t),this._separators.forEach(function(o){var c=o.topPaneId();e._separators.has(c)||o.updatePaneId(a)})}this.adjustPaneViewport(n,!0,!0,!0,!0)}}},{key:"createTechnicalIndicator",value:function(t,i){var e=this,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(this._panes.has(n.id)){var a=this._chartStore.technicalIndicatorStore().addInstance(n.id,t,i);return a&&a.finally(function(l){e.setPaneOptions(n,e._panes.get(n.id).yAxis().computeAxis(!0))}),n.id}var o=n.id||"".concat(Er).concat(++this._paneBaseId),c=!_t(n.dragEnabled)||n.dragEnabled;this._separators.set(o,new sr(this._chartContainer,this._chartStore,Array.from(this._panes.keys()).pop(),o,c,{startDrag:this._separatorStartDrag.bind(this),drag:xr(this._separatorDrag.bind(this),50)}));var s=new Ai({container:this._chartContainer,chartStore:this._chartStore,xAxis:this._xAxisPane.xAxis(),id:o,height:n.height||100});this._panes.set(o,s);var h=this._chartStore.technicalIndicatorStore().addInstance(o,t,i);return h&&h.finally(function(l){e.adjustPaneViewport(!0,!0,!0,!0,!0)}),o}},{key:"createShape",value:function(t,i,e){var n=i.points,a=i.styles,o=i.lock,c=i.mode,s=i.data,h=i.onDrawStart,l=i.onDrawing,u=i.onDrawEnd,f=i.onClick,d=i.onRightClick,v=i.onPressedMove,p=i.onMouseEnter,_=i.onMouseLeave,m=i.onRemove,y=i.id||"".concat("shape_").concat(++this._shapeBaseId);if(!this._chartStore.shapeStore().hasInstance(y)){var g=null;this.hasPane(e)?g=this._panes.get(e).yAxis():n&&n.length>0&&(e=it,g=this._panes.get(it).yAxis());var k=new t({id:y,chartStore:this._chartStore,xAxis:this._xAxisPane.xAxis(),yAxis:g,points:n,styles:a,lock:o,mode:c,data:s});return W(h)&&h({id:y}),ti(k,[{key:"onDrawing",fn:l},{key:"onDrawEnd",fn:u},{key:"onClick",fn:f},{key:"onRightClick",fn:d},{key:"onPressedMove",fn:v},{key:"onMouseEnter",fn:p},{key:"onMouseLeave",fn:_},{key:"onRemove",fn:m}]),this._chartStore.shapeStore().addInstance(k,e),y}return null}},{key:"createAnnotation",value:function(t,i){var e=this,n=[];t.forEach(function(a){var o=a.point,c=a.styles,s=a.checkEventCoordinateOnCustomSymbol,h=a.drawCustomSymbol,l=a.drawExtend,u=a.onClick,f=a.onRightClick,d=a.onMouseEnter,v=a.onMouseLeave;if(o&&o.timestamp){var p=new kr({id:o.timestamp,chartStore:e._chartStore,point:o,xAxis:e._xAxisPane.xAxis(),yAxis:e._panes.get(i).yAxis(),styles:c});ti(p,[{key:"drawExtend",fn:l},{key:"drawCustomSymbol",fn:h},{key:"checkEventCoordinateOnCustomSymbol",fn:s},{key:"onClick",fn:u},{key:"onRightClick",fn:f},{key:"onMouseEnter",fn:d},{key:"onMouseLeave",fn:v}]),n.push(p)}}),n.length>0&&this._chartStore.annotationStore().add(n,i)}},{key:"createTag",value:function(t,i){var e=this,n=[],a=!1,o=!1;t.forEach(function(c){var s=c.id,h=c.point,l=c.text,u=c.mark,f=c.styles;if(E(s))if(e._chartStore.tagStore().has(s,i)){var d=e._chartStore.tagStore().update(s,i,{point:h,text:l,mark:u,styles:f});a||(a=d)}else o=!0,n.push(new br({id:s,point:h,text:l,mark:u,styles:f,chartStore:e._chartStore,xAxis:e._xAxisPane.xAxis(),yAxis:e._panes.get(i).yAxis()}))}),o?this._chartStore.tagStore().add(n,i):a&&this._invalidatePane(ht)}},{key:"removeAllHtml",value:function(){this._panes.forEach(function(t){t.removeHtml()}),this._xAxisPane.removeHtml()}},{key:"setPaneOptions",value:function(t,i){var e=i,n=!1;if(t.id!==it){var a=this._panes.get(t.id);a&&(O(t.height)&&t.height>0&&a.height()!==t.height&&(e=!0,a.setHeight(t.height),n=!0),_t(t.dragEnabled)&&this._separators.get(t.id).setDragEnabled(t.dragEnabled))}e&&this.adjustPaneViewport(n,!0,!0,!0,!0)}},{key:"setTimezone",value:function(t){this._chartStore.timeScaleStore().setTimezone(t),this._xAxisPane.xAxis().computeAxis(!0),this._xAxisPane.invalidate(Pe)}},{key:"convertToPixel",value:function(t,i){var e,n=this,a=i.paneId,o=a===void 0?it:a,c=i.absoluteYAxis,s=[].concat(t),h=[],l=this._chartStore.styleOptions().separator.size,u=0,f=Vi(this._panes.values());try{var d=function(){var v=e.value;if(v.id()===o)return h=s.map(function(p){var _=p.timestamp,m=p.value,y={},g=p.dataIndex;if(E(_)&&(g=n._chartStore.timeScaleStore().timestampToDataIndex(_)),E(g)&&(y.x=n._xAxisPane.xAxis().convertToPixel(g)),E(m)){var k=v.yAxis().convertToPixel(m);y.y=c?u+k:k}return y}),"break";u+=v.height()+l};for(f.s();!(e=f.n()).done&&d()!=="break";);}catch(v){f.e(v)}finally{f.f()}return V(t)?h:h[0]||{}}},{key:"convertFromPixel",value:function(t,i){var e,n=this,a=i.paneId,o=a===void 0?it:a,c=i.absoluteYAxis,s=[].concat(t),h=[],l=this._chartStore.styleOptions().separator.size,u=0,f=Vi(this._panes.values());try{var d=function(){var v=e.value;if(v.id()===o)return h=s.map(function(p){var _=p.x,m=p.y,y={};if(E(_)&&(y.dataIndex=n._xAxisPane.xAxis().convertFromPixel(_),y.timestamp=n._chartStore.timeScaleStore().dataIndexToTimestamp(y.dataIndex)),E(m)){var g=c?m-u:m;y.value=v.yAxis().convertFromPixel(g)}return y}),"break";u+=v.height()+l};for(f.s();!(e=f.n()).done&&d()!=="break";);}catch(v){f.e(v)}finally{f.f()}return V(t)?h:h[0]||{}}},{key:"chartWidth",value:function(){return this._chartWidth}},{key:"chartHeight",value:function(){return this._chartHeight}},{key:"getConvertPictureUrl",value:function(t,i,e){var n=this,a=this._chartContainer.offsetWidth,o=this._chartContainer.offsetHeight,c=lt("canvas",{width:"".concat(a,"px"),height:"".concat(o,"px"),boxSizing:"border-box"}),s=c.getContext("2d"),h=Vt(c);c.width=a*h,c.height=o*h,s.scale(h,h),s.fillStyle=e,s.fillRect(0,0,a,o);var l=0;return this._panes.forEach(function(u,f){if(f!==it){var d=n._separators.get(f);s.drawImage(d.getImage(),0,l,a,d.height()),l+=d.height()}s.drawImage(u.getImage(t),0,l,a,u.height()),l+=u.height()}),s.drawImage(this._xAxisPane.getImage(t),0,l,a,this._xAxisPane.height()),c.toDataURL("image/".concat(i))}},{key:"destroy",value:function(){this._panes.forEach(function(t){t.destroy()}),this._separators.forEach(function(t){t.destroy()}),this._panes.clear(),this._separators.clear(),this._xAxisPane.destroy(),this._container.removeChild(this._chartContainer),this._chartEvent.destroy()}}]),r}(),Hi=function(){function r(t,i){A(this,r),this._chartPane=new Pr(t,i)}return I(r,[{key:"getWidth",value:function(){return this._chartPane.chartWidth()}},{key:"getHeight",value:function(){return this._chartPane.chartHeight()}},{key:"setStyleOptions",value:function(t){L(t)&&(this._chartPane.chartStore().applyStyleOptions(t),this._chartPane.adjustPaneViewport(!0,!0,!0,!0,!0))}},{key:"getStyleOptions",value:function(){return dt(this._chartPane.chartStore().styleOptions())}},{key:"setPriceVolumePrecision",value:function(t,i){O(t)&&t>=0&&O(i)&&i>=0&&this._chartPane.chartStore().setPriceVolumePrecision(t,i)}},{key:"setTimezone",value:function(t){this._chartPane.setTimezone(t)}},{key:"getTimezone",value:function(){return this._chartPane.chartStore().timeScaleStore().timezone()}},{key:"resize",value:function(){this._chartPane.adjustPaneViewport(!0,!0,!0,!0,!0)}},{key:"setOffsetRightSpace",value:function(t){O(t)&&this._chartPane.chartStore().timeScaleStore().setOffsetRightSpace(t,!0)}},{key:"setLeftMinVisibleBarCount",value:function(t){O(t)&&t>0&&this._chartPane.chartStore().timeScaleStore().setLeftMinVisibleBarCount(Math.ceil(t))}},{key:"setRightMinVisibleBarCount",value:function(t){O(t)&&t>0&&this._chartPane.chartStore().timeScaleStore().setRightMinVisibleBarCount(Math.ceil(t))}},{key:"setDataSpace",value:function(t){O(t)&&this._chartPane.chartStore().timeScaleStore().setDataSpace(t)}},{key:"getDataSpace",value:function(){return this._chartPane.chartStore().timeScaleStore().dataSpace()}},{key:"getBarSpace",value:function(){return this._chartPane.chartStore().timeScaleStore().barSpace()}},{key:"clearData",value:function(){this._chartPane.chartStore().clearDataList()}},{key:"getDataList",value:function(){return this._chartPane.chartStore().dataList()}},{key:"applyNewData",value:function(t,i){var e=this;if(V(t)){var n=this._chartPane.chartStore();n.clearDataList(),n.addData(t,0,i),n.technicalIndicatorStore().calcInstance().finally(function(a){e._chartPane.adjustPaneViewport(!1,!0,!0,!0)})}}},{key:"applyMoreData",value:function(t,i){var e=this;if(V(t)){var n=this._chartPane.chartStore();n.addData(t,0,i),n.technicalIndicatorStore().calcInstance().finally(function(a){e._chartPane.adjustPaneViewport(!1,!0,!0,!0)})}}},{key:"updateData",value:function(t){var i=this;if(L(t)&&!V(t)){var e=this._chartPane.chartStore(),n=e.dataList(),a=n.length,o=vt(t,"timestamp",0),c=vt(n[a-1],"timestamp",0);if(o>=c){var s=a;o===c&&(s=a-1),e.addData(t,s),e.technicalIndicatorStore().calcInstance().finally(function(h){i._chartPane.adjustPaneViewport(!1,!0,!0,!0)})}}}},{key:"loadMore",value:function(t){W(t)&&this._chartPane.chartStore().timeScaleStore().setLoadMoreCallback(t)}},{key:"createTechnicalIndicator",value:function(t,i,e){if(!E(t))return null;var n=L(t)&&!V(t)?t:{name:t};return this._chartPane.chartStore().technicalIndicatorStore().hasTemplate(n.name)?this._chartPane.createTechnicalIndicator(n,i,e):null}},{key:"addTechnicalIndicatorTemplate",value:function(t){if(L(t)){var i=[].concat(t);this._chartPane.chartStore().technicalIndicatorStore().addTemplate(i)}}},{key:"overrideTechnicalIndicator",value:function(t,i){var e=this;if(L(t)&&!V(t)){var n=this._chartPane.chartStore().technicalIndicatorStore().override(t,i);n&&n.then(function(a){e._chartPane.adjustPaneViewport(!1,!0,!0,!0)})}}},{key:"getTechnicalIndicatorTemplate",value:function(t){return this._chartPane.chartStore().technicalIndicatorStore().getTemplateInfo(t)}},{key:"getTechnicalIndicatorByPaneId",value:function(t,i){return this._chartPane.chartStore().technicalIndicatorStore().getInstanceInfo(t,i)}},{key:"removeTechnicalIndicator",value:function(t,i){this._chartPane.removeTechnicalIndicator(t,i)}},{key:"addShapeTemplate",value:function(t){if(L(t)){var i=[].concat(t);this._chartPane.chartStore().shapeStore().addTemplate(i)}}},{key:"createShape",value:function(t,i){if(!E(t))return null;var e=L(t)&&!V(t)?t:{name:t},n=this._chartPane.chartStore().shapeStore().getTemplate(e.name);return n?this._chartPane.createShape(n,e,i):null}},{key:"getShape",value:function(t){return this._chartPane.chartStore().shapeStore().getInstanceInfo(t)}},{key:"setShapeOptions",value:function(t){L(t)&&!V(t)&&this._chartPane.chartStore().shapeStore().setInstanceOptions(t)}},{key:"removeShape",value:function(t){this._chartPane.chartStore().shapeStore().removeInstance(t)}},{key:"createAnnotation",value:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:it;if(L(t)&&this._chartPane.hasPane(i)){var e=[].concat(t);this._chartPane.createAnnotation(e,i)}}},{key:"removeAnnotation",value:function(t,i){this._chartPane.chartStore().annotationStore().remove(t,i)}},{key:"createTag",value:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:it;if(L(t)&&this._chartPane.hasPane(i)){var e=[].concat(t);this._chartPane.createTag(e,i)}}},{key:"removeTag",value:function(t,i){this._chartPane.chartStore().tagStore().remove(t,i)}},{key:"createHtml",value:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:it;if(!L(t)||!(Xt(t.content)||t.content instanceof HTMLElement))return null;var e=this._chartPane.getPane(i);return e?e.createHtml(t):null}},{key:"removeHtml",value:function(t,i){if(t){var e=this._chartPane.getPane(t);e&&e.removeHtml(i)}else this._chartPane.removeAllHtml()}},{key:"setPaneOptions",value:function(t){L(t)&&this._chartPane.setPaneOptions(t,!1)}},{key:"setZoomEnabled",value:function(t){this._chartPane.chartStore().timeScaleStore().setZoomEnabled(t)}},{key:"isZoomEnabled",value:function(){return this._chartPane.chartStore().timeScaleStore().zoomEnabled()}},{key:"setScrollEnabled",value:function(t){this._chartPane.chartStore().timeScaleStore().setScrollEnabled(t)}},{key:"isScrollEnabled",value:function(){return this._chartPane.chartStore().timeScaleStore().scrollEnabled()}},{key:"scrollByDistance",value:function(t,i){var e=this;if(O(t))if(O(i)&&i>0){this._chartPane.chartStore().timeScaleStore().startScroll();var n=new Date().getTime();(function a(){var o=(new Date().getTime()-n)/i,c=o>=1,s=c?t:t*o;e._chartPane.chartStore().timeScaleStore().scroll(s),c||Ae(a)})()}else this._chartPane.chartStore().timeScaleStore().startScroll(),this._chartPane.chartStore().timeScaleStore().scroll(t)}},{key:"scrollToRealTime",value:function(t){var i=(this._chartPane.chartStore().timeScaleStore().offsetRightBarCount()-this._chartPane.chartStore().timeScaleStore().offsetRightSpace()/this._chartPane.chartStore().timeScaleStore().dataSpace())*this._chartPane.chartStore().timeScaleStore().dataSpace();this.scrollByDistance(i,t)}},{key:"scrollToDataIndex",value:function(t,i){if(O(t)){var e=(this._chartPane.chartStore().dataList().length-1-t)*this._chartPane.chartStore().timeScaleStore().dataSpace();this.scrollByDistance(e,i)}}},{key:"zoomAtCoordinate",value:function(t,i,e){var n=this;if(O(t))if(O(e)&&e>0){var a=this._chartPane.chartStore().timeScaleStore().dataSpace(),o=a*t-a,c=new Date().getTime();(function s(){var h=(new Date().getTime()-c)/e,l=h>=1,u=l?o:o*h;n._chartPane.chartStore().timeScaleStore().zoom(u/a,i),l||Ae(s)})()}else this._chartPane.chartStore().timeScaleStore().zoom(t,i)}},{key:"zoomAtDataIndex",value:function(t,i,e){if(O(t)&&O(i)){var n=this._chartPane.chartStore().timeScaleStore().dataIndexToCoordinate(i);this.zoomAtCoordinate(t,{x:n},e)}}},{key:"convertToPixel",value:function(t,i){return this._chartPane.convertToPixel(t,i)}},{key:"convertFromPixel",value:function(t,i){return this._chartPane.convertFromPixel(t,i)}},{key:"subscribeAction",value:function(t,i){this._chartPane.chartStore().actionStore().subscribe(t,i)}},{key:"unsubscribeAction",value:function(t,i){this._chartPane.chartStore().actionStore().unsubscribe(t,i)}},{key:"getConvertPictureUrl",value:function(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"jpeg",e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"#FFFFFF";if(i==="png"||i==="jpeg"||i==="bmp")return this._chartPane.getConvertPictureUrl(t,i,e)}},{key:"destroy",value:function(){this._chartPane.destroy()}}]),r}(),ce={},Cr=1,Ar="k_line_chart_",Ir={clone:dt,merge:Rt,isString:Xt,isNumber:O,isValid:E,isObject:L,isArray:V,isFunction:W,isBoolean:_t,formatValue:vt,formatPrecision:pt,formatBigNumber:At};Wt.addTechnicalIndicatorTemplate([{name:"AVP",shortName:"AVP",series:"price",precision:2,plots:[{key:"avp",title:"AVP: ",type:"line"}],calcTechnicalIndicator:function(r){var t=0,i=0;return r.map(function(e){var n={};return t+=e.turnover||0,(i+=e.volume||0)!==0&&(n.avp=t/i),n})}},Et,xt,Yt,{name:"EMV",shortName:"EMV",calcParams:[14,9],plots:[{key:"emv",title:"EMV: ",type:"line"},{key:"maEmv",title:"MAEMV: ",type:"line"}],calcTechnicalIndicator:function(r,t){var i=t.params,e=0,n=0,a=[],o=[];return r.forEach(function(c,s){var h={},l=r[s-1]||c,u=c.high,f=c.low,d=c.turnover||0,v=0;d!==0&&(v=((u+f)/2-(l.high+l.low)/2)*(u-f)/d),a.push(v),e+=v,i[0]-1>s||(h.emv=e,e-=a[s-(i[0]-1)],n+=h.emv,i[0]+i[1]-2>s||(h.maEmv=n/i[1],n-=o[s-(i[1]-1)].emv)),o.push(h)}),o}},{name:"EMA",shortName:"EMA",series:"price",calcParams:[6,12,20],precision:2,shouldCheckParamCount:!1,shouldOhlc:!0,plots:[{key:"ema6",title:"EMA6: ",type:"line"},{key:"ema12",title:"EMA12: ",type:"line"},{key:"ema20",title:"EMA20: ",type:"line"}],regeneratePlots:function(r){return r.map(function(t){return{key:"ema".concat(t),title:"EMA".concat(t,": "),type:"line"}})},calcTechnicalIndicator:function(r,t){var i=t.params,e=t.plots,n=0,a=[];return r.map(function(o,c){var s={},h=o.close;return n+=h,i.forEach(function(l,u){l-1>c||(a[u]=c>l-1?(2*h+(l-1)*a[u])/(l+1):n/l,s[e[u].key]=a[u])}),s})}},{name:"MA",shortName:"MA",series:"price",calcParams:[5,10,30,60],precision:2,shouldCheckParamCount:!1,shouldOhlc:!0,plots:[{key:"ma5",title:"MA5: ",type:"line"},{key:"ma10",title:"MA10: ",type:"line"},{key:"ma30",title:"MA30: ",type:"line"},{key:"ma60",title:"MA60: ",type:"line"}],regeneratePlots:function(r){return r.map(function(t){return{key:"ma".concat(t),title:"MA".concat(t,": "),type:"line"}})},calcTechnicalIndicator:function(r,t){var i=t.params,e=t.plots,n=[];return r.map(function(a,o){var c={},s=a.close;return i.forEach(function(h,l){n[l]=(n[l]||0)+s,h-1>o||(c[e[l].key]=n[l]/h,n[l]-=r[o-(h-1)].close)}),c})}},Lt,{name:"SMA",shortName:"SMA",series:"price",calcParams:[12,2],precision:2,plots:[{key:"sma",title:"SMA: ",type:"line"}],shouldCheckParamCount:!0,shouldOhlc:!0,calcTechnicalIndicator:function(r,t){var i=t.params,e=0,n=0;return r.map(function(a,o){var c={},s=a.close;return e+=s,i[0]-1>o||(c.sma=n=o>i[0]-1?(s*i[1]+n*(i[0]-i[1]+1))/(i[0]+1):e/i[0]),c})}},{name:"TRIX",shortName:"TRIX",calcParams:[12,9],plots:[{key:"trix",title:"TRIX: ",type:"line"},{key:"maTrix",title:"MATRIX: ",type:"line"}],calcTechnicalIndicator:function(r,t){var i,e,n,a=t.params,o=0,c=0,s=0,h=0,l=[];return r.forEach(function(u,f){var d={},v=u.close;if(o+=v,f>=a[0]-1&&(c+=i=f>a[0]-1?(2*v+(a[0]-1)*i)/(a[0]+1):o/a[0],f>=2*a[0]-2&&(s+=e=f>2*a[0]-2?(2*i+(a[0]-1)*e)/(a[0]+1):c/a[0],f>=3*a[0]-3))){var p,_=0;f>3*a[0]-3?_=((p=(2*e+(a[0]-1)*n)/(a[0]+1))-n)/n*100:p=s/a[0],n=p,d.trix=_,h+=_,3*a[0]+a[1]-4>f||(d.maTrix=h/a[1],h-=l[f-(a[1]-1)].trix)}l.push(d)}),l}},{name:"BRAR",shortName:"BRAR",calcParams:[26],plots:[{key:"br",title:"BR: ",type:"line"},{key:"ar",title:"AR: ",type:"line"}],calcTechnicalIndicator:function(r,t){var i=t.params,e=0,n=0,a=0,o=0;return r.map(function(c,s){var h={},l=c.high,u=c.low,f=c.open,d=(r[s-1]||c).close;if(a+=l-f,o+=f-u,e+=l-d,n+=d-u,s>=i[0]-1){h.ar=o!==0?a/o*100:0,h.br=n!==0?e/n*100:0;var v=r[s-(i[0]-1)],p=v.high,_=v.low,m=v.open,y=(r[s-i[0]]||r[s-(i[0]-1)]).close;e-=p-y,n-=y-_,a-=p-m,o-=m-_}return h})}},Pt,{name:"MTM",shortName:"MTM",calcParams:[12,6],plots:[{key:"mtm",title:"MTM: ",type:"line"},{key:"maMtm",title:"MAMTM: ",type:"line"}],calcTechnicalIndicator:function(r,t){var i=t.params,e=0,n=[];return r.forEach(function(a,o){var c={};o<i[0]||(c.mtm=a.close-r[o-i[0]].close,e+=c.mtm,i[0]+i[1]-1>o||(c.maMtm=e/i[1],e-=n[o-(i[1]-1)].mtm)),n.push(c)}),n}},{name:"PSY",shortName:"PSY",calcParams:[12,6],plots:[{key:"psy",title:"PSY: ",type:"line"},{key:"maPsy",title:"MAPSY: ",type:"line"}],calcTechnicalIndicator:function(r,t){var i=t.params,e=0,n=0,a=[],o=[];return r.forEach(function(c,s){var h={},l=c.close-(r[s-1]||c).close>0?1:0;a.push(l),e+=l,i[0]-1>s||(h.psy=e/i[0]*100,n+=h.psy,i[0]+i[1]-2>s||(h.maPsy=n/i[1],n-=o[s-(i[1]-1)].psy),e-=a[s-(i[0]-1)]),o.push(h)}),o}},{name:"ROC",shortName:"ROC",calcParams:[12,6],shouldCheckParamCount:!0,plots:[{key:"roc",title:"ROC: ",type:"line"},{key:"maRoc",title:"MAROC: ",type:"line"}],calcTechnicalIndicator:function(r,t){var i=t.params,e=[],n=0;return r.forEach(function(a,o){var c={};if(o>=i[0]-1){var s=(r[o-i[0]]||r[o-(i[0]-1)]).close;c.roc=s!==0?(a.close-s)/s*100:0,n+=c.roc,i[0]-1+i[1]-1>o||(c.maRoc=n/i[1],n-=e[o-(i[1]-1)].roc)}e.push(c)}),e}},{name:"VR",shortName:"VR",calcParams:[26,6],plots:[{key:"vr",title:"VR: ",type:"line"},{key:"maVr",title:"MAVR: ",type:"line"}],calcTechnicalIndicator:function(r,t){var i=t.params,e=0,n=0,a=0,o=0,c=[];return r.forEach(function(s,h){var l={},u=s.close,f=(r[h-1]||s).close,d=s.volume;if(u>f?e+=d:f>u?n+=d:a+=d,h>=i[0]-1){var v=a/2;l.vr=n+v===0?0:(e+v)/(n+v)*100,o+=l.vr,i[0]+i[1]-2>h||(l.maVr=o/i[1],o-=c[h-(i[1]-1)].vr);var p=r[h-(i[0]-1)],_=r[h-i[0]]||p,m=p.close,y=p.volume;m>_.close?e-=y:_.close>m?n-=y:a-=y}c.push(l)}),c}},Be,{name:"BIAS",shortName:"BIAS",calcParams:[6,12,24],shouldCheckParamCount:!1,plots:[{key:"bias6",title:"BIAS6: ",type:"line"},{key:"bias12",title:"BIAS12: ",type:"line"},{key:"bias24",title:"BIAS24: ",type:"line"}],regeneratePlots:function(r){return r.map(function(t){return{key:"bias".concat(t),title:"BIAS".concat(t,": "),type:"line"}})},calcTechnicalIndicator:function(r,t){var i=t.params,e=t.plots,n=[];return r.map(function(a,o){var c={},s=a.close;return i.forEach(function(h,l){if(n[l]=(n[l]||0)+s,o>=h-1){var u=n[l]/i[l];c[e[l].key]=(s-u)/u*100,n[l]-=r[o-(h-1)].close}}),c})}},he,le,yt,$i,Ji,Qi,{name:"OBV",shortName:"OBV",calcParams:[30],plots:[{key:"obv",title:"OBV: ",type:"line"},{key:"maObv",title:"MAOBV: ",type:"line"}],calcTechnicalIndicator:function(r,t){var i=t.params,e=0,n=0,a=[];return r.forEach(function(o,c){var s=r[c-1]||o;s.close>o.close?n-=o.volume:o.close>s.close&&(n+=o.volume);var h={obv:n};e+=n,i[0]-1>c||(h.maObv=e/i[0],e-=a[c-(i[0]-1)].obv),a.push(h)}),a}},{name:"PVT",shortName:"PVT",plots:[{key:"pvt",title:"PVT: ",type:"line"}],calcTechnicalIndicator:function(r){var t=0;return r.map(function(i,e){var n={},a=(r[e-1]||i).close,o=0;return a!==0&&(o=(i.close-a)/a*i.volume),n.pvt=t+=o,n})}},{name:"VOL",shortName:"VOL",series:"volume",calcParams:[5,10,20],shouldCheckParamCount:!1,shouldFormatBigNumber:!0,precision:0,minValue:0,plots:[{key:"ma5",title:"MA5: ",type:"line"},{key:"ma10",title:"MA10: ",type:"line"},{key:"ma20",title:"MA20: ",type:"line"},{key:"volume",title:"VOLUME: ",type:"bar",baseValue:0,color:function(r,t){var i=r.current.kLineData||{};return i.close>i.open?t.bar.upColor:i.open>i.close?t.bar.downColor:t.bar.noChangeColor}}],regeneratePlots:function(r){var t=r.map(function(i){return{key:"ma".concat(i),title:"MA".concat(i,": "),type:"line"}});return t.push({key:"volume",title:"VOLUME: ",type:"bar",baseValue:0,color:function(i,e){var n=i.current.kLineData||{};return n.close>n.open?e.bar.upColor:n.open>n.close?e.bar.downColor:e.bar.noChangeColor}}),t},calcTechnicalIndicator:function(r,t){var i=t.params,e=t.plots,n=[];return r.map(function(a,o){var c=a.volume||0,s={volume:c};return i.forEach(function(h,l){n[l]=(n[l]||0)+c,h-1>o||(s[e[l].key]=n[l]/h,n[l]-=r[o-(h-1)].volume)}),s})}}]),Wt.addShapeTemplate([{name:"horizontalRayLine",totalStep:3,checkEventCoordinateOnShape:function(r){var t=r.dataSource;return re(t[0],t[1],r.eventCoordinate)},createShapeDataSource:function(r){var t=r.coordinates,i={x:0,y:t[0].y};return t[1]&&t[1].x>t[0].x&&(i.x=r.viewport.width),[{type:"line",isDraw:!0,isCheck:!0,dataSource:[[t[0],i]]}]},performEventPressedMove:function(r){var t=r.points,i=r.pressPoint;t[0].value=i.value,t[1].value=i.value},performEventMoveForDrawing:function(r){r.step===2&&(r.points[0].value=r.movePoint.value)}},{name:"horizontalSegment",totalStep:3,checkEventCoordinateOnShape:function(r){var t=r.dataSource;return be(t[0],t[1],r.eventCoordinate)},createShapeDataSource:function(r){var t=r.coordinates,i=[];return t.length===2&&(i=[t]),[{type:"line",isDraw:!0,isCheck:!0,dataSource:i}]},performEventPressedMove:function(r){var t=r.points,i=r.pressPoint;t[0].value=i.value,t[1].value=i.value},performEventMoveForDrawing:function(r){r.step===2&&(r.points[0].value=r.movePoint.value)}},{name:"horizontalStraightLine",totalStep:2,checkEventCoordinateOnShape:function(r){var t=r.dataSource;return kt(t[0],t[1],r.eventCoordinate)},createShapeDataSource:function(r){var t=r.coordinates;return[{type:"line",isDraw:!0,isCheck:!0,dataSource:[[{x:0,y:t[0].y},{x:r.viewport.width,y:t[0].y}]]}]}},{name:"verticalRayLine",totalStep:3,checkEventCoordinateOnShape:function(r){var t=r.dataSource;return re(t[0],t[1],r.eventCoordinate)},createShapeDataSource:function(r){var t=r.coordinates,i={x:t[0].x,y:0};return t[1]&&t[1].y>t[0].y&&(i.y=r.viewport.height),[{type:"line",isDraw:!0,isCheck:!0,dataSource:[[t[0],i]]}]},performEventPressedMove:function(r){var t=r.points,i=r.pressPoint;t[0].timestamp=i.timestamp,t[0].dataIndex=i.dataIndex,t[1].timestamp=i.timestamp,t[1].dataIndex=i.dataIndex},performEventMoveForDrawing:function(r){var t=r.points,i=r.movePoint;r.step===2&&(t[0].timestamp=i.timestamp,t[0].dataIndex=i.dataIndex)}},{name:"verticalSegment",totalStep:3,checkEventCoordinateOnShape:function(r){var t=r.dataSource;return be(t[0],t[1],r.eventCoordinate)},createShapeDataSource:function(r){var t=r.coordinates,i=[];return t.length===2&&(i=[t]),[{type:"line",isDraw:!0,isCheck:!0,dataSource:i}]},performEventPressedMove:function(r){var t=r.points,i=r.pressPoint;t[0].timestamp=i.timestamp,t[0].dataIndex=i.dataIndex,t[1].timestamp=i.timestamp,t[1].dataIndex=i.dataIndex},performEventMoveForDrawing:function(r){var t=r.points,i=r.movePoint;r.step===2&&(t[0].timestamp=i.timestamp,t[0].dataIndex=i.dataIndex)}},{name:"verticalStraightLine",totalStep:2,checkEventCoordinateOnShape:function(r){var t=r.dataSource;return kt(t[0],t[1],r.eventCoordinate)},createShapeDataSource:function(r){var t=r.coordinates;return[{type:"line",isDraw:!0,isCheck:!0,dataSource:[[{x:t[0].x,y:0},{x:t[0].x,y:r.viewport.height}]]}]}},{name:"rayLine",totalStep:3,checkEventCoordinateOnShape:function(r){var t=r.dataSource;return re(t[0],t[1],r.eventCoordinate)},createShapeDataSource:function(r){var t,i,e,n=r.coordinates,a=r.viewport;return[{type:"line",isDraw:!0,isCheck:!0,dataSource:[(t=n[0],i=n[1],e={x:a.width,y:a.height},t&&i?[t,t.x===i.x&&t.y!==i.y?i.y>t.y?{x:t.x,y:e.y}:{x:t.x,y:0}:t.x>i.x?{x:0,y:ne(t,i,{x:0,y:t.y})}:{x:e.x,y:ne(t,i,{x:e.x,y:t.y})}]:[])]}]}},{name:"segment",totalStep:3,checkEventCoordinateOnShape:function(r){var t=r.dataSource;return be(t[0],t[1],r.eventCoordinate)},createShapeDataSource:function(r){var t=r.coordinates,i=[];return t.length===2&&(i=[t]),[{type:"line",isDraw:!0,isCheck:!0,dataSource:i}]}},{name:"straightLine",totalStep:3,checkEventCoordinateOnShape:function(r){var t=r.dataSource;return kt(t[0],t[1],r.eventCoordinate)},createShapeDataSource:function(r){var t=r.coordinates,i=r.viewport;return 2>t.length||t[0].x===t[1].x?[{type:"line",isDraw:!0,isCheck:!0,dataSource:[[{x:t[0].x,y:0},{x:t[0].x,y:i.height}]]}]:[{type:"line",isDraw:!0,isCheck:!0,dataSource:[[{x:0,y:ne(t[0],t[1],{x:0,y:t[0].y})},{x:i.width,y:ne(t[0],t[1],{x:i.width,y:t[0].y})}]]}]}},{name:"parallelStraightLine",totalStep:4,checkEventCoordinateOnShape:function(r){var t=r.dataSource;return kt(t[0],t[1],r.eventCoordinate)},createShapeDataSource:function(r){var t=r.viewport;return[{type:"line",isDraw:!0,isCheck:!0,dataSource:ni(r.coordinates,{x:t.width,y:t.height})}]}},{name:"priceChannelLine",totalStep:4,checkEventCoordinateOnShape:function(r){var t=r.dataSource;return kt(t[0],t[1],r.eventCoordinate)},createShapeDataSource:function(r){var t=r.viewport;return[{type:"line",isDraw:!0,isCheck:!0,dataSource:ni(r.coordinates,{x:t.width,y:t.height},1)}]}},{name:"priceLine",totalStep:2,checkEventCoordinateOnShape:function(r){var t=r.dataSource;return re(t[0],t[1],r.eventCoordinate)},createShapeDataSource:function(r){var t=r.coordinates,i=r.precision;return[{type:"line",isDraw:!0,isCheck:!0,dataSource:[[t[0],{x:r.viewport.width,y:t[0].y}]]},{type:"text",isDraw:!0,isCheck:!1,dataSource:[{x:t[0].x,y:t[0].y,text:r.yAxis.convertFromPixel(t[0].y).toFixed(i.price)}]}]}},{name:"fibonacciLine",totalStep:3,checkEventCoordinateOnShape:function(r){var t=r.dataSource;return kt(t[0],t[1],r.eventCoordinate)},createShapeDataSource:function(r){var t=r.points,i=r.coordinates,e=r.precision;if(i.length>0){var n=[],a=[],o=r.viewport.width;if(i.length>1){var c=i[0].y-i[1].y,s=t[0].value-t[1].value;[1,.786,.618,.5,.382,.236,0].forEach(function(h){var l=i[1].y+c*h,u=(t[1].value+s*h).toFixed(e.price);n.push([{x:0,y:l},{x:o,y:l}]),a.push({x:0,y:l,text:"".concat(u," (").concat((100*h).toFixed(1),"%)")})})}return[{type:"line",isDraw:!0,isCheck:!0,dataSource:n},{type:"text",isDraw:!0,isCheck:!1,dataSource:a}]}return[]}}]),z.dispose=function(r){if(r){var t;if(Xt(r)){var i=document.getElementById(r);t=i&&i.chartId}else t=r instanceof Hi?r.id:r&&r.chartId;t&&(ce[t].destroy(),delete ce[t])}},z.extension=Wt,z.init=function(r){var t,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};if(!r||!(t=Xt(r)?document.getElementById(r):r))return null;var e=ce[t.chartId||""];if(e)return e;var n="".concat(Ar).concat(Cr++);return(e=new Hi(t,i)).id=n,t.chartId=n,ce[n]=e,e},z.utils=Ir,z.version=function(){return"8.3.6"},Object.defineProperty(z,"__esModule",{value:!0})})})(Re,Re.exports);qi.exports=Re.exports;const Zr=Q=>(Nr("data-v-db4865e8"),Q=Q(),Yr(),Q),Kr=Zr(()=>Xr("div",{id:"ohlc-wrapper"},null,-1)),qr={setup(Q){const K=Wr(),z=Fr({loading:!0});return zr(async()=>{const Et=K.params.symbol,xt=qi.exports.init("ohlc-wrapper"),Yt=await Gr(1649928175),Lt=[],Pt={};Yt.holdings.forEach(tt=>{if(Object.keys(tt[2]).includes(Et)){const yt=tt[0]*1e3;Lt.push(yt),Pt[yt]={point:{timestamp:yt}}}});const he=(await Ur(Et)).map(tt=>{const yt=tt[1]*1e3;return Lt.includes(yt)&&(Pt[yt].point.value=tt[2]),{timestamp:yt,open:tt[2],high:tt[3],low:tt[4],close:tt[5],volume:tt[6]}});xt.createTechnicalIndicator("MACD",!1,{height:120,dragEnabled:!1}),xt.overrideTechnicalIndicator({name:"MACD",calcParams:[16,24,12]});const le=Object.values(Pt).map(tt=>Xi(Wi({},tt),{styles:{position:"point",offset:[0,0],symbol:{size:10,color:"#5470C6"}}}));xt.createAnnotation(le),xt.createShape({name:"verticalStraightLine",lock:!0,points:[{timestamp:1614171282e3,value:0}],styles:{line:{color:"#000",size:2}}}),xt.applyNewData(he),z.loading=!1}),(Et,xt)=>{const Yt=Gi("el-card"),Lt=Gi("el-main"),Pt=Vr("loading");return Ui(),Zi(Lt,null,{default:Ki(()=>[jr((Ui(),Zi(Yt,null,{default:Ki(()=>[Kr]),_:1})),[[Pt,Hr(z).loading]])]),_:1})}}};var ta=Br(qr,[["__scopeId","data-v-db4865e8"]]);export{ta as default};
